<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>devonfw guide devon4ng</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body id="master.asciidoc" class="book toc2 toc-right">
<div id="header">
<h1>devonfw guide devon4ng</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#master-devon4ng.asciidoc">devon4ng</a>
<ul class="sectlevel1">
<li><a href="#architecture.asciidoc">Architecture</a>
<ul class="sectlevel2">
<li><a href="#architecture.asciidoc_overview">Overview</a></li>
</ul>
</li>
<li><a href="#meta-architecture.asciidoc">Meta Architecture</a>
<ul class="sectlevel2">
<li><a href="#meta-architecture.asciidoc_introduction">Introduction</a></li>
<li><a href="#meta-architecture.asciidoc_devonfw-reference-client-architecture">devonfw Reference Client Architecture</a></li>
<li><a href="#meta-architecture.asciidoc_appendix">Appendix</a></li>
<li><a href="#meta-architecture.asciidoc_references">References</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_layers">Layers</a>
<ul class="sectlevel2">
<li><a href="#components-layer.asciidoc">Components Layer</a></li>
<li><a href="#services-layer.asciidoc">Services Layer</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_guides">Guides</a>
<ul class="sectlevel2">
<li><a href="#guide-package-managers.asciidoc">Package Managers</a></li>
<li><a href="#guide-npm-yarn-workflow.asciidoc">Package Managers Workflow</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_angular">1. Angular</a>
<ul class="sectlevel2">
<li><a href="#guide-accessibility.asciidoc">1.1. Accessibility</a></li>
<li><a href="#guide-angular-elements.asciidoc">1.2. Angular Elements</a></li>
<li><a href="#guide-angular-lazy-loading.asciidoc">1.3. Angular Lazy loading</a></li>
<li><a href="#guide-angular-library.asciidoc">1.4. Angular Library</a></li>
<li><a href="#guide-angular-theming.asciidoc">1.5. Angular Material Theming</a></li>
<li><a href="#guide-angular-pwa.asciidoc">1.6. Angular Progressive Web App</a></li>
<li><a href="#guide-app-initializer.asciidoc">1.7. APP_INITIALIZER</a></li>
<li><a href="#guide-component-decomposition.asciidoc">1.8. Component Decomposition</a></li>
<li><a href="#guide-consuming-rest-services.asciidoc">1.9. Consuming REST services</a></li>
<li><a href="#guide-error-handler.asciidoc">1.10. Error Handler in angular</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_ionic">2. Ionic</a>
<ul class="sectlevel2">
<li><a href="#guide-ionic-getting-started.asciidoc">2.1. Ionic 4 Getting started</a></li>
<li><a href="#basic-proyect-set-up">2.2. Basic proyect set up</a></li>
<li><a href="#guide-ionic-from-code-to-android.asciidoc">2.3. Ionic 4 to android</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_layouts">3. Layouts</a>
<ul class="sectlevel2">
<li><a href="#guide-layout-with-angular-material.asciidoc">3.1. Angular Material Layout</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_ngrx">4. NgRx</a>
<ul class="sectlevel2">
<li><a href="#guide-ngrx-getting-started.asciidoc">4.1. Introduction to NgRx</a></li>
<li><a href="#guide-ngrx-simple-store.asciidoc">4.2. State, Selection and Reducers</a></li>
<li><a href="#guide-ngrx-effects.asciidoc">4.3. Side effects with NgRx/Effects</a></li>
</ul>
</li>
<li><a href="#master-devon4ng.asciidoc_cookbook">5. Cookbook</a>
<ul class="sectlevel2">
<li><a href="#cookbook-abstract-class-store.asciidoc">5.1. Abstract Class Store</a></li>
<li><a href="#guide-add-electron.asciidoc">5.2. Angular Electron</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="master-devon4ng.asciidoc" class="sect0">devon4ng</h1>
<div class="openblock partintro">
<div class="content">
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="architecture.asciidoc">Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following principles and guidelines are based on Angular Styleguide - especially Angular modules (see <a href="https://angular.io/guide/ngmodule">Angular Docs</a>).
It extends those where additional guidance is needed to define an architecture which is</p>
</div>
<div class="ulist">
<ul>
<li>
<p>maintainable across applications and teams</p>
</li>
<li>
<p>easy to understand, especially when coming from a classic Java/.Net perspective - so whenever possible the same principles apply both to the server and the client</p>
</li>
<li>
<p>pattern based to solve common problems</p>
</li>
<li>
<p>based on best of breed solutions coming from open source and Capgemini project experiences</p>
</li>
<li>
<p>gives as much guidance as necessary and as little as possible</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="architecture.asciidoc_overview">Overview</h3>
<div class="paragraph">
<p>When using Angular the web client architecture is driven by the framework in a certain way Google and the Angular community think about web client architecture.
Angular gives an opinion on how to look at architecture.
It is component based like devon4j but uses different terms which are common language in web application development.
The important term is <em>module</em> which is used instead of <em>component</em>. The primary reason is the naming collision with the <em>Web Components</em> standard (see <a href="https://www.w3.org/standards/techs/components">Web Components</a>).<br>
To clarify this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>component</em> describes an UI element containing HTML, CSS and JavaScript - structure, design and logic encapsulated inside a reusable container called component.</p>
</li>
<li>
<p>A <em>module</em> describes an applications feature area. The application flight-app may have a module called booking.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An application developed using Angular consists of multiple modules.
There are feature modules and special modules described by the Angular Styleguide - <a href="https://angular.io/guide/ngmodule#the-core-module"><em>core</em></a> and <a href="https://angular.io/guide/ngmodule#shared-module"><em>shared</em></a>.
Angular or Angular Styleguide give no guidance on how to structure a module internally.
This is where this architecture comes in.</p>
</div>
<div class="sect3">
<h4 id="architecture.asciidoc_layers">Layers</h4>
<div class="paragraph">
<p>The architecture describes two layers. The terminology is based on common language in web development.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/architecture-layers.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/architecture-layers.svg" alt="Architecture - Layers" width="450"></a>
</div>
<div class="title">Figure 1. Layers</div>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#components-layer.asciidoc"><strong>Components Layer</strong></a> encapsulates components which present the current application state.
Components are separated into <a href="#components-layer.asciidoc"><em>Smart</em> and <em>Dumb Components</em></a>.
The only logic present is view logic inside <em>Smart Components</em>.</p>
</li>
<li>
<p><a href="#services-layer.asciidoc"><strong>Services Layer</strong></a> is more or less what we call 'business logic layer' on the server side.
The layer defines the applications state, the transitions between state and classic business logic.
Stores contain application state over time to which <em>Smart Components</em> subscribe to.
Adapters are used to perform XHRs, WebSocket connections, etc.
The business model is described inside the module.
Use case services perform business logic needed for use cases.
A use case services interacts with the store and adapters.
Methods of use case services are the API for <em>Smart Components</em>.
Those methods are <em>Actions</em> in reactive terminology.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="architecture.asciidoc_modules">Modules</h4>
<div class="paragraph">
<p>Angular requires a module called <em>app</em> which is the main entrance to an application at runtime - this module gets bootstrapped.
Angular Styleguide defines feature modules and two special modules - <a href="https://angular.io/guide/ngmodule#the-core-module"><em>core</em></a> and <a href="https://angular.io/guide/ngmodule#shared-module"><em>shared</em></a>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/architecture-modules.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/architecture-modules.svg" alt="Architecture - Modules" width="450"></a>
</div>
<div class="title">Figure 2. Modules</div>
</div>
<div class="paragraph">
<p>A feature module is basically a vertical cut through both layers.
The <em>shared</em> module consists of components shared across feature modules.
The <em>core</em> module holds services shared across modules.
So <em>core</em> module is a module only having a services layer
and <em>shared</em> module is a module only having a components layer.</p>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="meta-architecture.asciidoc">Meta Architecture</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="meta-architecture.asciidoc_introduction">Introduction</h3>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_purpose-of-this-document">Purpose of this document</h4>
<div class="paragraph">
<p>In our business applications, the client easily gets underestimated. Sometimes the client is more complex to develop and design than the server. While the server architecture is nowadays easily to agree as common sense, for clients this is not as obvious and stable especially as it typically depends on the client framework used. Finding a concrete architecture applicable for all clients may therefore be difficult to accomplish.</p>
</div>
<div class="paragraph">
<p>This document tries to define on a high abstract level, a reference architecture which is supposed to be a mental image and frame for orientation regarding the evaluation and appliance of different client frameworks. As such it defines terms and concepts required to be provided for in any framework and thus gives a common ground of understanding for those acquainted with the reference architecture. This allows better comparison between the various frameworks out there, each having their own terms for essentially the same concepts. It also means that for each framework we need to explicitly map how it implements the concepts defined in this document.</p>
</div>
<div class="paragraph">
<p>The architecture proposed herein is neither new nor was it developed from scratch. Instead it is the gathered and consolidated knowledge and best practices of various projects (s. References).</p>
</div>
</div>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_goal-of-the-client-architecture">Goal of the Client Architecture</h4>
<div class="paragraph">
<p>The goal of the client architecture is to support the non-functional requirements for the client, i.e. mostly maintainability, scalability, efficiency and portability. As such it provides a component-oriented architecture following the same principles listed already in the devonfw architecture overview. Furthermore it ensures a homogeneity regarding how different concrete UI technologies are being applied in the projects, solving the common requirements in the same way.</p>
</div>
</div>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_architecture-views">Architecture Views</h4>
<div class="paragraph">
<p>As for the server we distinguish between the business and the technical architecture. Where the business architecture is different from project to project and relates to the concrete design of dialog components given concrete requirements, the technical architecture can be applied to multiple projects.</p>
</div>
<div class="paragraph">
<p>The focus of this document is to provide a technical reference architecture on the client on a very abstract level defining required layers and components. How the architecture is implemented has to be defined for each UI technology.</p>
</div>
<div class="paragraph">
<p>The technical infrastructure architecture is out of scope for this document and although it needs to be considered, the concepts of the reference architecture should work across multiple TI architecture, i.e. native or web clients.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="meta-architecture.asciidoc_devonfw-reference-client-architecture">devonfw Reference Client Architecture</h3>
<div class="paragraph">
<p>The following gives a complete overview of the proposed reference architecture. It will be built up incrementally in the following sections.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_CompleteOverview.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/devonfw-methodology/OASP_ClientArchitecture_CompleteOverview.png" alt="Complete Client Architecture Overview" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 1 Overview</em></p>
</div>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_client-architecture">Client Architecture</h4>
<div class="paragraph">
<p>On the highest level of abstraction we see the need to differentiate between dialog components and their container they are managed in, as well as the access to the application server being the backend for the client (e.g. an devon4j instance). This section gives a summary of these components and how they relate to each other. Detailed architectures for each component will be supplied in subsequent sections</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_Overview.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/devonfw-methodology/OASP_ClientArchitecture_Overview.png" alt="Client Architecture Overview" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 2 Overview of Client Architecture</em></p>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_dialog-component">Dialog Component</h5>
<div class="paragraph">
<p>A dialog component is a logical, self-contained part of the user interface. It accepts user input and actions and controls communication with the user. Dialog components use the services provided by the dialog container in order to execute the business logic. They are self-contained, i.e. they possess their own user interface together with the associated logic, data and states.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dialog components can be composed of other dialog components forming a hierarchy</p>
</li>
<li>
<p>Dialog components can interact with each other. This includes communication of a parent to its children, but also between components independent of each other regarding the hierarchy.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_dialog-container">Dialog Container</h5>
<div class="paragraph">
<p>Dialog components need to be managed in their lifecycle and how they can be coupled to each other. The dialog container is responsible for this along with the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bootstrapping the client application and environment</p>
<div class="ulist">
<ul>
<li>
<p>Configuration of the client</p>
</li>
<li>
<p>Initialization of the application server access component</p>
</li>
</ul>
</div>
</li>
<li>
<p>Dialog Component Management</p>
<div class="ulist">
<ul>
<li>
<p>Controlling the lifecycle</p>
</li>
<li>
<p>Controlling the dialog flow</p>
</li>
<li>
<p>Providing means of interaction between the dialogs</p>
</li>
<li>
<p>Providing application server access</p>
</li>
<li>
<p>Providing services to the dialog components<br>
(e.g. printing, caching, data storage)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Shutdown of the application</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_application-server-access">Application Server Access</h5>
<div class="paragraph">
<p>Dialogs will require a backend application server in order to execute their business logic. Typically in an devonfw application the service layer will provide interfaces for the functionality exposed to the client. These business oriented interfaces should also be present on the client backed by a proxy handling the concrete call of the server over the network. This component provides the set of interfaces as well as the proxy.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_dialog-container-architecture">Dialog Container Architecture</h4>
<div class="paragraph">
<p>The dialog container can be further structured into the following components with their respective tasks described in own sections:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_DialogContainer.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/devonfw-methodology/OASP_ClientArchitecture_DialogContainer.png" alt="Dialog Container Architecture Overview" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 3 Dialog Container Architecture</em></p>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_application">Application</h5>
<div class="paragraph">
<p>The application component represents the overall client in our architecture. It is responsible for bootstrapping all other components and connecting them with each other. As such it initializes the components below and provides an environment for them to work in.</p>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_configuration-management">Configuration Management</h5>
<div class="paragraph">
<p>The configuration management manages the configuration of the client, so the client can be deployed in different environments. This includes configuration of the concrete application server to be called or any other environment-specific property.</p>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_dialog-management">Dialog Management</h5>
<div class="paragraph">
<p>The Dialog Management component provides the means to define, create and destroy dialog components. It therefore offers basic lifecycle capabilities for a component. In addition it also allows composition of dialog components in a hierarchy. The lifecycle is then managed along the hierarchy, meaning when creating/destroying a parent dialog, this affects all child components, which are created/destroyed as well.</p>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_service-registry">Service Registry</h5>
<div class="paragraph">
<p>Apart from dialog components, a client application also consists of services offered to these. A service can thereby encompass among others:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the application server</p>
</li>
<li>
<p>Access to the dialog container functions for managing dialogs or accessing the configuration</p>
</li>
<li>
<p>Dialog independent client functionality such as Printing, Caching, Logging, Encapsulated business logic such as tax calculation</p>
</li>
<li>
<p>Dialog component interaction</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The service registry offers the possibility to define, register and lookup these services. Note that these services could be dependent on the dialog hierarchy, meaning different child instances could obtain different instances / implementations of a service via the service registry, depending on which service implementations are registered by the parents.</p>
</div>
<div class="paragraph">
<p>Services should be defined as interfaces allowing for different implementations and thus loose coupling.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_dialog-component-architecture">Dialog Component Architecture</h4>
<div class="paragraph">
<p>A dialog component has to support all or a subset of the following tasks:<br>
(T1)	Displaying the user interface incl. internationalization<br>
(T2)	Displaying business data incl. changes made to the data due to user interactions and localization of the data<br>
(T3)	Accepting user input including possible conversion from e.g. entered Text to an Integer<br>
(T4)	Displaying the dialog state<br>
(T5)	Validation of user input<br>
(T6)	Managing the business data incl. business logic altering it due to user interactions<br>
(T7)	Execution of user interactions<br>
(T8)	Managing the state of the dialog (e.g. Edit vs. View)<br>
(T9)	Calling the application server in the course of user interactions</p>
</div>
<div class="paragraph">
<p>Following the principle of separation of concerns, we further structure a dialog component in an own architecture allowing us the distribute responsibility for these tasks along the defined components:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_DialogComponent.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/devonfw-methodology/OASP_ClientArchitecture_DialogComponent.png" alt="Dialog Component Architecture" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 4 Overview of dialog component architecture</em></p>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_presentation-layer">Presentation Layer</h5>
<div class="paragraph">
<p>The presentation layer generates and displays the user interface, accepts user input and user actions and binds these to the dialog core layer (T1-5). The tasks of the presentation layer fall into two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Provision of the visual representation (View component)</strong><br>
The presentation layer generates and displays the user interface and accepts user input and user actions. The logical processing of the data, actions and states is performed in the dialog core layer. The data and user interface are displayed in localized and internationalized form.</p>
</li>
<li>
<p><strong>Binding of the visual representation to the dialog core layer</strong><br>
The presentation layer itself does not contain any dialog logic. The data or actions entered by the user are then processed in the dialog core layer. There are three aspects to the binding to the dialog core layer. We refer to data binding, state binding and action binding. Syntactical and (to a certain extent) semantic validations are performed during data binding (e.g. cross-field plausibility checks). Furthermore, the formatted, localized data in the presentation layer is converted into the presentation-independent, neutral data in the dialog core layer (parsing) and vice versa (formatting).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_dialog-core-layer">Dialog Core Layer</h5>
<div class="paragraph">
<p>The dialog core layer contains the business logic, the control logic, and the logical state of the dialog. It therefore covers tasks T5-9:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Maintenance of the logical dialog state and the logical data</strong><br>
The dialog core layer maintains the logical dialog state and the logical data in a form which is independent of the presentation. The states of the presentation (e.g. individual widgets) must not be maintained in the dialog core layer, e.g. the view state could lead to multiple presentation states disabling all editable widgets on the view.</p>
</li>
<li>
<p><strong>Implementation of the dialog and dialog control logic</strong><br>
The component parts in the dialog core layer implement the client specific business logic and the dialog control logic. This includes, for example, the manipulation of dialog data and dialog states as well as the opening and closing of dialogs.</p>
</li>
<li>
<p><strong>Communication with the application server</strong><br>
The dialog core layer calls the interfaces of the application server via the application server access component services.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The dialog core layer should not depend on the presentation layer enforcing a strict layering and thus minimizing dependencies.</p>
</div>
</div>
<div class="sect4">
<h5 id="meta-architecture.asciidoc_interactions-between-dialog-components">Interactions between dialog components</h5>
<div class="paragraph">
<p>Dialog components can interact in the following ways:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_DialogInteractions.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/devonfw-methodology/OASP_ClientArchitecture_DialogInteractions.png" alt="Dialog Interactions" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Embedding of dialog components</strong><br>
As already said dialog components can be hierarchically composed. This composition works by embedding on dialog component within the other. Apart from the lifecycle managed by the dialog container, the embedding needs to cope for the visual embedding of the presentation and core layer.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Embedding dialog presentation</strong><br>
The parent dialog needs to either integrate the embedded dialog in its layout or open it in an own model window.</p>
</li>
<li>
<p><strong>Embedding dialog core</strong><br>
The parent dialog needs to be able to access the embedded instance of its children. This allows initializing and changing their data and states. On the other hand the children might require context information offered by the parent dialog by registering services in the hierarchical service registry.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Dialog flow</strong><br>
Apart from the embedding of dialog components representing a tight coupling, dialogs can interact with each other by passing the control of the UI, i.e. switching from one dialog to another.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When interacting, dialog components should interact only between the same or lower layers, i.e. the dialog core should not access the presentation layer of another dialog component.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="meta-architecture.asciidoc_appendix">Appendix</h3>
<div class="sect3">
<h4 id="meta-architecture.asciidoc_notes-about-quasar-client">Notes about Quasar Client</h4>
<div class="paragraph">
<p>The Quasar client architecture as the consolidated knowledge of our CSD projects is the major source for the above drafted architecture. However, the above is a much simplified and more agile version thereof:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Quasar Client tried to abstract from the concrete UI library being used, so it could decouple the business from the technical logic of a dialog. The presentation layer should be the only one knowing the concrete UI framework used. This level of abstraction was dropped in this reference architecture, although it might of course still make sense in some projects. For fast-moving agile projects in the web however introducing such a level of abstraction takes effort with little gained benefits. With frameworks like Angular 2 we would even introduce one additional seemingly artificial and redundant layer, since it already separates the dialog core from its presentation.</p>
</li>
<li>
<p>In the past and in the days of Struts, JSF, etc. the concept of session handling was important for the client since part of the client was sitting on a server with a session relating it to its remote counterpart on the users PC. Quasar Client catered for this need, by very prominently differentiating between session and application in the root of the dialog component hierarchy. However, in the current days of SPA applications and the lowered importance of servers-side web clients, this prominent differentiation was dropped. When still needed the referenced documents will provide in more detail how to tailor the respective architecture to this end.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="meta-architecture.asciidoc_references">References</h3>
<div class="ulist">
<ul>
<li>
<p>Architecture Guidelines for Application Design:
<a href="https://troom.capgemini.com/sites/vcc/engineering/Cross%20Cutting/ArchitectureGuide/Architecture_Guidelines_for_Application_Design_v2.0.docx" class="bare">https://troom.capgemini.com/sites/vcc/engineering/Cross%20Cutting/ArchitectureGuide/Architecture_Guidelines_for_Application_Design_v2.0.docx</a></p>
</li>
<li>
<p>Quasar Client Architekturen:
<a href="https://troom.capgemini.com/sites/vcc/Shared%20Documents/CrossCuttingContent/TopicOrientedCCC/QuasarOverview/NCE%20Quasar%20Review%20Workshop%202009-11-17/Quasar%20Development/Quasar-Client-Architectures.doc" class="bare">https://troom.capgemini.com/sites/vcc/Shared%20Documents/CrossCuttingContent/TopicOrientedCCC/QuasarOverview/NCE%20Quasar%20Review%20Workshop%202009-11-17/Quasar%20Development/Quasar-Client-Architectures.doc</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_layers">Layers</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="components-layer.asciidoc">Components Layer</h3>
<div class="paragraph">
<p>The components layer encapsulates all components presenting the current application view state, which means data to be shown to the user.
The term component refers to a component described by the standard <a href="https://www.w3.org/standards/techs/components">Web Components</a>.
So this layer has all Angular components, directives and pipes defined for an application.
The main challenges are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>how to structure the components layer (see <a href="#guide-file-structure.asciidoc">File Structure Guide</a>)</p>
</li>
<li>
<p>decompose components into maintainable chunks (see <a href="#guide-component-decomposition.asciidoc">Component Decomposition Guide</a>)</p>
</li>
<li>
<p>handle component interaction</p>
</li>
<li>
<p>manage calls to the services layer</p>
</li>
<li>
<p>apply a maintainable data and eventflow throughout the component tree</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="components-layer.asciidoc_smart-and-dumb-components">Smart and Dumb Components</h4>
<div class="paragraph">
<p>The architecture applies the concept of <em>Smart</em> and <em>Dumb Components</em> (syn. <em>Containers</em> and <em>Presenters</em>).
The concept means that components are devided into <em>Smart</em> and <em>Dumb Components</em>.</p>
</div>
<div class="paragraph">
<p>A <em>Smart Component</em> typically is a toplevel dialog inside the component tree.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a component, that can be routed to</p>
</li>
<li>
<p>a modal dialog</p>
</li>
<li>
<p>a component, which is placed inside <code>AppComponent</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <em>Dumb Component</em> can be used by one to many <em>Smart Components</em>.
Inside the component tree a <em>Dumb Component</em> is a child of a <em>Smart Component</em>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/component-tree.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/component-tree.svg" alt="Component Tree" width="450"></a>
</div>
<div class="title">Figure 3. Component tree example</div>
</div>
<div class="paragraph">
<p>As shown the topmost component is always the <code>AppComponent</code> in Angular applications.
The component tree describes the hierarchy of components starting from <code>AppComponent</code>.
The figure shows <em>Smart Components</em> in blue and <em>Dumb Components</em> in green.
<code>AppComponent</code> is a <em>Smart Component</em> by definition.
Inside the template of <code>AppComponent</code> placed components are static components inside the component tree.
So they are always displayed.
In the example <code>OverviewComponent</code> and <code>DetailsComponent</code> are rendered by Angular compiler depending on current URL the application displays.
So <code>OverviewComponents</code> subtree is displayed if the URL is <code>/overview</code> and <code>DetailsComponents</code> subtree is displayed if the URL is <code>/details</code>.
To clarify this distinction further the following table shows the main differences.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Smart vs Dumb Components</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><em>Smart Components</em></th>
<th class="tableblock halign-left valign-top"><em>Dumb Components</em></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contain the current view state</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show data via binding (<code>@Input</code>) and contain no view state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">handle events emited by <em>Dumb Components</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pass events up the component tree to be handled by <em>Smart Components</em> (<code>@Output</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">call the services layer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">never call the services layer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">use services</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">do not use services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">consists of n <em>Dumb Components</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is independent of <em>Smart Components</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="components-layer.asciidoc_interaction-of-smart-and-dumb-components">Interaction of Smart and Dumb Components</h4>
<div class="paragraph">
<p>With the usage of the <em>Smart</em> and <em>Dumb Components</em> pattern one of the most important part is component interaction.
Angular comes with built in support for component interaction with <code>@Input()</code> and <code>@Output()</code> Decorators.
The following figure illustrates an unidirectional data flow.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data always goes down the component tree - from a <em>Smart Component</em> down its children.</p>
</li>
<li>
<p>Events bubble up, to be handled by a <em>Smart Component</em>.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/smart-dumb-components-interaction.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/smart-dumb-components-interaction.svg" alt="Smart and Dumb Components Interaction" width="450"></a>
</div>
<div class="title">Figure 4. Smart and Dumb Component Interaction</div>
</div>
<div class="paragraph">
<p>As shown a <em>Dumb Components</em> role is to define a signature by declaring Input and Output Bindings.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Input()</code> defines what data is necessary for that component to work</p>
</li>
<li>
<p><code>@Output()</code> defines which events can be listened on by the parent component</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 1. Dumb Components define a signature</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ValuePickerComponent {

  @Input() columns: string[];
  @Input() items: {}[];
  @Input() selected: {};
  @Input() filter: string;
  @Input() isChunked = false;
  @Input() showInput = true;
  @Input() showDropdownHeader = true;

  @Output() elementSelected = new EventEmitter&lt;{}&gt;();
  @Output() filterChanged = new EventEmitter&lt;string&gt;();
  @Output() loadNextChunk = new EventEmitter();
  @Output() escapeKeyPressed = new EventEmitter();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example shows the <em>Dumb Component</em> <code>ValuePickerComponent</code>.
It describes seven input bindings with <code>isChunked</code>, <code>showHeader</code> and <code>showDropdownHeader</code> being non mandatory as they have a default value.
Four output bindings are present. Typically, a <em>Dumb Component</em> has very little code to no code inside the TypeScript class.</p>
</div>
<div class="listingblock">
<div class="title">Listing 2. Smart Components use the Dumb Components signature inside the template</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;div&gt;

  &lt;value-input
    ...&gt;
  &lt;/value-input&gt;

  &lt;value-picker
    *ngIf="isValuePickerOpen"
    [columns]="columns"
    [items]="filteredItems"
    [isChunked]="isChunked"
    [filter]="filter"
    [selected]="selectedItem"
    [showDropdownHeader]="showDropdownHeader"
    (loadNextChunk)="onLoadNextChunk()"
    (elementSelected)="onElementSelected($event)"
    (filterChanged)="onFilterChanged($event)"
    (escapeKeyPressed)="onEscapePressedInsideChildTable()"&gt;
  &lt;/value-picker&gt;

&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside the <em>Smart Components</em> template the events emitted by <em>Dumb Components</em> are handled.
It is a good practice to name the handlers with the prefix <code>on*</code> (e.g. <code>onInputChanged()</code>).</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="services-layer.asciidoc">Services Layer</h3>
<div class="paragraph">
<p>The services layer is more or less what we call 'business logic layer' on the server side.
It is the layer where the business logic is placed.
The main challenges are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define application state and an API for the components layer to use it</p>
</li>
<li>
<p>Handle application state transitions</p>
</li>
<li>
<p>Perform backend interaction (XHR, WebSocket, etc.)</p>
</li>
<li>
<p>Handle business logic in a maintainable way</p>
</li>
<li>
<p>Configuration management</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All parts of the services layer are described in this chapter.
An example which puts the concepts together can be found at the end <a href="#services-layer.asciidoc_interaction-of-smart-components-through-the-services-layer">Interaction of Smart Components through the services layer</a>.</p>
</div>
<div class="sect3">
<h4 id="services-layer.asciidoc_boundaries">Boundaries</h4>
<div class="paragraph">
<p>There are two APIs for the components layer to interact with the services layer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A store can be subscribed to for receiving state updates over time</p>
</li>
<li>
<p>A use case service can be called to trigger an action</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To illustrate the fact the follwing figure shows an abstract overview.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/components-layer-service-layer-boundaries.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/components-layer-service-layer-boundaries.svg" alt="Smart and Dumb Components Interaction" width="450"></a>
</div>
<div class="title">Figure 5. Boundaries to components layer</div>
</div>
</div>
<div class="sect3">
<h4 id="services-layer.asciidoc_store">Store</h4>
<div class="paragraph">
<p>A store is a class which defines and handles application state with its transitions over time.
Interaction with a store is always synchronous.
A basic implementation using <code>rxjs</code> can look like this.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A more profound implementation taken from a real-life project can be found here (<a href="#cookbook-abstract-class-store.asciidoc">Abstract Class Store</a>).
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Listing 3. Store defined using rxjs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@Injectable()
export class ProductSearchStore {

  private stateSource = new BehaviorSubject&lt;ProductSearchState&gt;(defaultProductSearchState);
  state$ = this.stateSource.asObservable();

  setLoading(isLoading: boolean) {
    const currentState = this.stateSource.getValue();
    this.stateSource.next({
      isLoading: isLoading,
      products: currentState.products,
      searchCriteria: currentState.searchCriteria
    });
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example <code>ProductSearchStore</code> handles state of type <code>ProductSearchState</code>.
The public API is the property <code>state$</code> which is an observable of type <code>ProductSearchState</code>.
The state can be changed with method calls.
So every desired change to the state needs to be modeled with an method.
In reactive terminology this would be an <em>Action</em>.
The store does not use any services.
Subscribing to the <code>state$</code> observable leads to the subscribers receiving every new state.</p>
</div>
<div class="paragraph">
<p>This is basically the <em>Observer Pattern</em>:<br>
The store consumer registeres itself to the observable via <code>state$.subscribe()</code> method call.
The first parameter of <code>subscribe()</code> is a callback function to be called when the subject changes.
This way the consumer - the observer - is registered.
When next() is called with a new state inside the store, all callback functions are called with the new value.
So every observer is notified of the state change.
This equals the <em>Observer Pattern</em> push type.</p>
</div>
<div class="paragraph">
<p>A store is the API for <em>Smart Components</em> to receive state from the service layer.
State transitions are handled automatically with <em>Smart Components</em> registering to the <code>state$</code> observable.</p>
</div>
</div>
<div class="sect3">
<h4 id="services-layer.asciidoc_use-case-service">Use Case Service</h4>
<div class="paragraph">
<p>A use case service is a service which has methods to perform asynchronous state transitions.
In reactive terminology this would be an <em>Action of Actions</em> - a thunk (<code>redux</code>) or an effect (<code>@ngrx</code>).</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/use-case-service.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/use-case-service.svg" alt="Use Case Service" width="450"></a>
</div>
<div class="title">Figure 6. Use case services are the main API to trigger state transitions</div>
</div>
<div class="paragraph">
<p>A use case services method - an action - interacts with adapters, business services and stores.
So use case services orchestrate whole use cases.
For an example see <a href="#usecaseservice-example">use case service example</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="services-layer.asciidoc_adapter">Adapter</h4>
<div class="paragraph">
<p>An adapter is used to communicate with the backend.
This could be a simple XHR request, a WebSocket connection, etc.
An adapter is simple in the way that it does not add anything other than the pure network call.
So there is no caching or logging performed here.
The following listing shows an example.</p>
</div>
<div class="paragraph">
<p>For further information on backend interaction see <a href="#guide-consuming-rest-services.asciidoc">Consuming REST Services</a></p>
</div>
<div class="listingblock">
<div class="title">Listing 4. Calling the backend via an adapter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@Injectable()
export class ProducsAdapter {

  private baseUrl = environment.baseUrl;

  constructor(private http: HttpClient) { }

  getAll(): Observable&lt;Product[]&gt; {
    return this.http.get&lt;Product[]&gt;(this.baseUrl + '/products');
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="services-layer.asciidoc_interaction-of-smart-components-through-the-services-layer">Interaction of Smart Components through the services layer</h4>
<div class="paragraph">
<p>The interaction of smart components is a classic problem which has to be solved in every UI technology.
It is basically how one dialog tells the other something has changed.</p>
</div>
<div class="paragraph">
<p>An example is <em>adding an item to the shopping basket</em>.
With this action there need to be multiple state updates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The small logo showing how many items are currently inside the basket needs to be updated from 0 to 1</p>
</li>
<li>
<p>The price needs to be recalculated</p>
</li>
<li>
<p>Shipping costs need to be checked</p>
</li>
<li>
<p>Discounts need to be updated</p>
</li>
<li>
<p>Ads need to be updated with related products</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="services-layer.asciidoc_pattern">Pattern</h5>
<div class="paragraph">
<p>To handle this interaction in a scalable way we apply the following pattern.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/smart-component-interaction-via-services-layer.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/smart-component-interaction-via-services-layer.svg" alt="Interaction of Smart Components via services layer" width="450"></a>
</div>
<div class="title">Figure 7. Smart Component interaction</div>
</div>
<div class="paragraph">
<p>The state of interest is encapsualted inside a store. All <em>Smart Components</em> interested in the state have to subscibe to the store&#8217;s API served by the public observable. Thus, with every update to the store the subscribed components receive the new value. The components basically react to state changes. Altering a store can be done directly if the desired change is synchronous. Most actions are of asynchronous nature so the <code>UseCaseService</code> comes into play. Its actions are <code>void</code> methods, which implement a use case, i.e., adding a new item to the basket. It calls asynchronous actions and can perform multiple store updates over time.</p>
</div>
<div class="paragraph">
<p>To put this pattern into perspective the <code>UseCaseService</code> is a programmatic alternative to <code>redux-thunk</code> or <code>@ngrx/effects</code>. The main motivation here is to use the full power of TypeScript&#8217;s <code>--strictNullChecks</code> and to let the learning curve not to become as steep as it would be when learning a new state management framework. This way actions are just <code>void</code> method calls.</p>
</div>
</div>
<div class="sect4">
<h5 id="services-layer.asciidoc_example">Example</h5>
<div class="imageblock">
<div class="content">
<a class="image" href="images/smart-smart-components-example.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/smart-smart-components-example.svg" alt="Smart component interaction example" width="450"></a>
</div>
<div class="title">Figure 8. Smart Components interaction example</div>
</div>
<div class="paragraph">
<p>The example shows two <em>Smart Components</em> sharing the <code>FlightSearchState</code> by using the <code>FlightSearchStore</code>.
The use case shown is started by an event in the <em>Smart Component</em> <code>FlightSearchComponent</code>. The action <code>loadFlight()</code> is called. This could be submitting a search form.
The UseCaseService is <code>FlightSearchService</code>, which handles the use case <em>Load Flights</em>.</p>
</div>
<div class="paragraph">
<div class="title">UseCaseService example</div>
<p><a id="usecaseservice-example"></a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class FlightSearchService {

  constructor(
    private flightSearchAdapter: FlightSearchAdapter,
    private store: FlightSearchStore
  ) { }

  loadFlights(criteria: FlightSearchCriteria): void {
    this.store.setLoadingFlights(true);
    this.store.clearFlights();

    this.flightSearchAdapter.getFlights(criteria.departureDate,
        {
          from: criteria.departureAirport,
          to: criteria.destinationAirport
        })
      .finally(() =&gt; this.store.setLoadingFlights(false))
      .subscribe((result: FlightTo[]) =&gt; this.store.setFlights(result, criteria));
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>First the loading flag is set to <code>true</code> and the current flights are cleared. This leads the <em>Smart Component</em> showing a spinner indicating the loading action. Then the asynchronous XHR is triggert by calling the adapter. After completion the loading flag is set to <code>false</code> causing the loading indication no longer to be shown. If the XHR was successful, the data would be put into the store. If the XHR was not successful, this would be the place to handle a custom error. All general network issues should be handled in a dedicated class, i.e., an interceptor. So for example the basic handling of 404 errors is not done here.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_guides">Guides</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="guide-package-managers.asciidoc">Package Managers</h3>
<div class="paragraph">
<p>There are two major package managers currently used for JavaScript / TypeScript projects which leverage node.js as a build platform.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://www.npmjs.com/">npm</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com">yarn</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Our recommendation is to use yarn but both package managers are fine.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When using npm it is important to use a version greater 5.0 as npm 3 has major drawbacks compared to yarn.
The following guide assumes that you are using npm &gt;= 5 or yarn.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before you start reading further, please take a look at the docs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/getting-started">yarn getting started</a></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/getting-started/what-is-npm">npm getting started</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following guide will describe best practices for working with yarn / npm.</p>
</div>
<div class="sect3">
<h4 id="guide-package-managers.asciidoc_semantic-versioning">Semantic Versioning</h4>
<div class="paragraph">
<p>When working with package managers it is very important to understand the concept of <a href="https://semver.org/">semantic versioning</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Version example 1.2.3</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Version</th>
<th class="tableblock halign-center valign-top">1.</th>
<th class="tableblock halign-center valign-top">2.</th>
<th class="tableblock halign-center valign-top">3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Version name when incrementing</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Major (2.0.0)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Minor (1.3.0)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Patch (1.2.4)</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Has breaking changes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Has features</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Has bugfixes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The table gives an overview of the most important parts of semantic versioning.
In the header version 1.2.3 is displayed.
The first row shows the name and the resulting version when incrementing a part of the version.
The next rows show specifics of the resulting version - e.g. a major version can have breaking changes, features and bugfixes.</p>
</div>
<div class="paragraph">
<p>Packages from npm and yarn leverage semantic versioning and instead of selecting a fixed version one can specify a selector.
The most common selectors are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>^1.2.3</strong>
At least 1.2.3 - 1.2.4 or 1.3.0 can be used, 2.0.0 can not be used</p>
</li>
<li>
<p><strong>~1.2.3</strong>
At lease 1.2.3 - 1.2.4 can be used, 2.0.0 and 1.3.0 can not be used</p>
</li>
<li>
<p><strong>&gt;=1.2.3</strong>
At least 1.2.3 - every version greater can also be used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This achieves a lower number of duplicates.
To give an example:</p>
</div>
<div class="paragraph">
<p>If package A needs version 1.3.0 of package C and package B needs version 1.4.0 of package C one would end up with 4 packages.</p>
</div>
<div class="paragraph">
<p>If package A needs version ^1.3.0 of package C and package B needs version 1.4.0 of package C one would end up with 3 packages.
A would use the same version of C as B - 1.4.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-package-managers.asciidoc_do-not-modify-package.json-and-lock-files-by-hand">Do not modify package.json and lock files by hand</h4>
<div class="paragraph">
<p>Dependencies are always added using a yarn or npm command.
Altering the package.json, package-json.lock or yarn.lock file by hand is not recommended.</p>
</div>
<div class="paragraph">
<p>Always use a yarn or npm command to add a new dependency.</p>
</div>
<div class="paragraph">
<p>Adding the package <code>express</code> with yarn to dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn add express</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding the package <code>express</code> with npm to dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install express</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-package-managers.asciidoc_what-does-the-lock-file-do">What does the lock file do</h4>
<div class="paragraph">
<p>The purpose of files <code>yarn.lock</code> and <code>package-json.lock</code> is to freeze versions for a short time.</p>
</div>
<div class="paragraph">
<p>The following problem is solved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Developer A upgrades the dependency <code>express</code> to fixed version <code>4.16.3</code>.</p>
</li>
<li>
<p><code>express</code> has sub-dependency <code>accepts</code> with version selector <code>~1.3.5</code></p>
</li>
<li>
<p>His local <code>node_modules</code> folder receives <code>accepts</code> in version <code>1.3.5</code></p>
</li>
<li>
<p>On his machine everything is working fine</p>
</li>
<li>
<p>Afterward version <code>1.3.6</code> of <code>accepts</code> is published - it contains a major bug</p>
</li>
<li>
<p>Developer B now clones the repo and loads the dependencies.</p>
</li>
<li>
<p>He receives version <code>1.3.6</code> of <code>accepts</code> and blames developer A for upgrading to a broken version.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both <code>yarn.lock</code> and <code>package-json.lock</code> freeze all the dependencies.
For example in yarn lock you will find.</p>
</div>
<div class="listingblock">
<div class="title">Listing 5. yarn.lock example (excerp)</div>
<div class="content">
<pre class="highlightjs highlight"><code>accepts@~1.3.5:
  version "1.3.5"
  resolved "[...URL to registry]"
  dependencies:
    mime-types "~2.1.18"
    negotiator "0.6.1"

mime-db@~1.33.0:
  version "1.33.0"
  resolved "[...URL to registry]"

mime-types@~2.1.18:
  version "2.1.18"
  resolved "[...URL to registry]"
  dependencies:
    mime-db "~1.33.0"

negotiator@0.6.1:
  version "0.6.1"
  resolved "[...URL to registry]"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The described problem is solved by the example yarn.lock file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>accepts</code> is frozen at version <code>~1.3.5</code></p>
</li>
<li>
<p>All of its sub-dependencies are also frozen.
It needs <code>mime-types</code> at version <code>~2.1.18</code> which is frozen at <code>2.1.18</code>.
<code>mime-types</code> needs <code>mime-db</code> at <code>~1.33.0</code> which is frozen at <code>1.33.0</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every developer will receive the same versions of every dependency.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You have to make sure all your developers are using the same npm/yarn version - this includes the CI build.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="guide-npm-yarn-workflow.asciidoc">Package Managers Workflow</h3>
<div class="sect3">
<h4 id="guide-npm-yarn-workflow.asciidoc_introduction">Introduction</h4>
<div class="paragraph">
<p>This document aims to provide you the necessary documentation and sources in order to help you understand the importance of dependencies between packages.</p>
</div>
<div class="paragraph">
<p>Projects in node.js make use of modules, chunks of reusable code made by other people or teams. These small chunks of reusable code are called packages <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>. Packages are used to solve specific problems or tasks. These relations between your project and the external packages are called dependencies.</p>
</div>
<div class="paragraph">
<p>For example, imagine we are doing a small program that takes your birthday as an input and tells you how many days are left until your birthday. We search in the repository if someone has published a package to retrieve the actual date and manage date types, and maybe we could search for another package to show a calendar, because we want to optimize our time, and we wish the user to click a calendar button and choose the day in the calendar instead of typing it.</p>
</div>
<div class="paragraph">
<p>As you can see, packages are convenient. In some cases, they may be even needed, as they can manage aspects of your program you may not be proficient in, or provide an easier use of them.</p>
</div>
<div class="paragraph">
<p>For more comprehensive information visit <a href="https://docs.npmjs.com/getting-started/what-is-npm">npm definition</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
<div class="sect4">
<h5 id="guide-npm-yarn-workflow.asciidoc_package.json">Package.json</h5>
<div class="paragraph">
<p>Dependencies in your project are stored in a file called package.json. Every package.json must contain, at least, the name and version of your project.</p>
</div>
<div class="paragraph">
<p>Package.json is located in the root of your project.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If package.json is not on your root directory refer to <a href="#guide-npm-yarn-workflow.asciidoc_problems-you-may-encounter">Problems you may encounter</a> section
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you wish to learn more information about package.json, click on the following links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/package-json">Yarn Package.json</a></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/getting-started/using-a-package.json">npm Package.json</a></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_content-of-package.json">Content of package.json</h6>
<div class="paragraph">
<p>As you noticed, package.json is a really important file in your project. It contains essential information about our project, therefore you need to understand what&#8217;s inside.</p>
</div>
<div class="paragraph">
<p>The structure of package.json is divided in blocks, inside the first one you can find essential information of your project such as the name, version, license and optionally some <a href="#guide-npm-yarn-workflow.asciidoc_scripts">Scripts</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "exampleproject",
  "version": "0.0.0",
  "license": "MIT",
  "scripts": {
    "ng": "ng",
    "start": "ng serve",
    "build": "ng build",
    "test": "ng test",
    "lint": "ng lint",
    "e2e": "ng e2e"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next block is called <em>dependencies</em> and contains the packages that project needs in order to be developed, compiled and executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"private": true,
  "dependencies": {
    "@angular/animations": "^4.2.4",
    "@angular/common": "^4.2.4",
    "@angular/forms": "^4.2.4",
    ...
    "zone.js": "^0.8.14"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>After <em>dependencies</em> we find <strong><em>devDependencies</em></strong>, another kind of dependencies present in the development of the application but unnecessary for its execution. One example is typescript. Code is written in typescript, and then, <em>transpiled</em> to javascript. This means the application is not using typescript in execution and consequently not included in the deployment of our application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"devDependencies": {
    "@angular/cli": "1.4.9",
    "@angular/compiler-cli": "^4.2.4",
    ...
    "@types/node": "~6.0.60",
    "typescript": "~2.3.3"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having a peer dependency means that your package needs a dependency that is the same exact dependency as the person installing your package</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"peerDependencies": {
    "package-123": "^2.7.18"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optional dependencies are just that: optional. If they fail to install, Yarn will still say the install process was successful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"optionalDependencies": {
    "package-321": "^2.7.18"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally you can have bundled dependencies which are packages bundled together when publishing your package in a repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "bundledDependencies": [
    "package-4"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the link to an in-depth explanation of <a href="https://yarnpkg.com/en/docs/dependency-types">dependency types</a>&#8203;.</p>
</div>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_scripts">Scripts</h6>
<div class="paragraph">
<p>Scripts are a great way of automating tasks related to your package, such as simple build processes or development tools.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "exampleproject",
  "version": "0.0.0",
  "license": "MIT",
  "scripts": {
    "build-project": "node hello-world.js",
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can run that script by running the command <code>yarn (run) script</code> or <code>npm run script</code>, check the example below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn (run) build-project    # run is optional
$ npm run build-project</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are special reserved words for scripts, like preinstall, which will execute the script automatically
before the package you install are installed.</p>
</div>
<div class="paragraph">
<p>Chech different uses for scripts in the following links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/package-json#toc-scripts">Yarn scripts documentation</a></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/misc/scripts">npm scripts documentation</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Or you can go back to
<a href="#guide-npm-yarn-workflow.asciidoc_content-of-package.json">Content of package.json</a>&#8203;.<br></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-npm-yarn-workflow.asciidoc_managing-dependencies">Managing dependencies</h5>
<div class="paragraph">
<p>In order to manage dependencies we recommend using package managers in your projects.</p>
</div>
<div class="paragraph">
<p>A big reason is their usability. Adding or removing a package is really easy, and by doing so, packet manager update the package.json and copies (or removes) the package in the needed location, with a single comand.</p>
</div>
<div class="paragraph">
<p>Another reason, closely related to the first one, is reducing human error by automating the package management process.</p>
</div>
<div class="paragraph">
<p>Two of the package managers you can use in node.js projects are "yarn" and "npm". While you can use both, we encourage you to use only one of them while working on projects. Using both may lead to different dependencies between members of the team.</p>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_npm">npm</h6>
<div class="paragraph">
<p>We&#8217;ll start by installing npm following this small guide <a href="https://docs.npmjs.com/getting-started/installing-node">here</a>.</p>
</div>
<div class="paragraph">
<p>As stated on the web, npm comes inside of node.js, and must be updated after installing node.js, in the same guide you used earlier are written the instructions to update npm.</p>
</div>
<div class="paragraph">
<p><strong>How npm works</strong></p>
</div>
<div class="paragraph">
<p>In order to explain how npms works, let&#8217;s take a command as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install @angular/material @angular/cdk</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command tells npm to look for the packages @angular/material and @angular/cdk in the npm registry, download and decompress them in the folder node_modules along with their own dependencies. Additionally, npm will update package.json and create a new file called package-lock.json.</p>
</div>
<div class="paragraph">
<p>After initializating and installing the first package there will be a new folder called node_modules in your project. This folder is where your packages are unzipped and stored, following a tree scheme.</p>
</div>
<div class="paragraph">
<p>Take in consideration both npm and yarn need a package.json in the root of your project in order to work properly. If after creating your project don&#8217;t have it, download again the package.json from the repository or you&#8217;ll have to start again.</p>
</div>
<div class="paragraph">
<p><strong>Brief overview of commands</strong></p>
</div>
<div class="paragraph">
<p>If we need to create a package.json from scratch, we can use the comand <strong>init</strong>. This command asks the user for basic information about the project and creates a brand new package.json.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install (or i) installs all modules listed as dependencies in package.json <strong>locally</strong>. You can also specify a package, and install that package. Install can also be used with the parameter <code>-g</code>, which tells npm to install the <a href="#guide-npm-yarn-workflow.asciidoc_global-package">Global package</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install
$ npm i
$ npm install Package</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Earlier versions of npm did <strong>not</strong> add dependencies to package.json unless it was used with the flag <code>--save</code>, so npm install package would be npm install <code>--save</code> package, you have one example below.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install --save Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Npm needs flags in order to know what kind of dependency you want in your project, in npm you need to put the flag <code>-D</code> or <code>--save-dev</code> to install devdependencies, for more information consult the links at the end of this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install -D package
$ npm install --save-dev package</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8203;</p>
</div>
<div class="paragraph">
<p>The next command uninstalls the module you specified in the command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm uninstall Package</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ls</code> command shows us the dependencies like a nested tree, useful if you have few packages, not so useful when you need a lot of packages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm ls</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>npm@@VERSION@ /path/to/npm
 init-package-json@0.0.4
   promzard@0.1.5</pre>
</div>
</div>
<div class="paragraph">
<div class="title">example tree</div>
<p>We recommend you to learn more about npm commands in the following <a href="https://docs.npmjs.com/">link</a>, navigating to the section cli commands.</p>
</div>
<div class="paragraph">
<p><strong>About Package-lock.json</strong></p>
</div>
<div class="paragraph">
<p>Package-lock.json describes the dependency tree resulting of using package.json and npm.
Whenever you update, add or remove a package, package-lock.json is deleted and redone with
the new dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> "@angular/animations": {
      "version": "4.4.6",
      "resolved": "https://registry.npmjs.org/@angular/animations/-/animations-4.4.6.tgz",
      "integrity": "sha1-+mYYmaik44y3xYPHpcl85l1ZKjU=",
      "requires": {
        "tslib": "1.8.0"
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This lock file is checked everytime the command npm i (or npm install) is used without specifying a package,
in the case it exists and it&#8217;s valid, npm will install the exact tree that was generated, such that subsequent
installs are able to generate identical dependency trees.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is <strong>not</strong> recommended to modify this file yourself. It&#8217;s better to leave its management to npm.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>More information is provided by the npm team at <a href="https://docs.npmjs.com/files/package-lock.json">package-lock.json</a></p>
</div>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_yarn">Yarn</h6>
<div class="paragraph">
<p>Yarn is an alternative to npm, if you wish to install yarn follow the guide <a href="https://yarnpkg.com/en/docs/install">getting started with yarn</a> and download the correct version for your operative system. Node.js is also needed you can find it <a href="https://nodejs.org/en/">here</a>.</p>
</div>
<div class="paragraph">
<p><strong>Working with yarn</strong></p>
</div>
<div class="paragraph">
<p>Yarn is used like npm, with small differences in syntax, for example <em>npm install module</em> is changed to <em>yarn add module</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add @covalent</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command is going to download the required packages, modify package.json, put the package in the folder node_modules and makes a new yarn.lock with the new dependency.</p>
</div>
<div class="paragraph">
<p>However, unlike npm, yarn maintains a cache with packages you download inside. You don&#8217;t need to download every file every time you do a general installation. This means installations faster than npm.</p>
</div>
<div class="paragraph">
<p>Similarly to npm, yarn creates and maintains his own lock file, called yarn.lock. Yarn.lock gives enough information about the project for dependency tree to be reproduced.</p>
</div>
<div class="paragraph">
<p><strong>yarn commands</strong></p>
</div>
<div class="paragraph">
<p>Here we have a brief description of yarn&#8217;s most used commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add Package
$ yarn add --dev Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adds a package <strong>locally</strong> to use in your package. Adding the flags <code>--dev</code> or <code>-D</code> will add them to devDependencies instead of the default dependencies, if you need more information check the links at the end of the section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Initializes the development of a package.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>Installs all the dependencies defined in a package.json file, you can also write "yarn" to achieve the same effect.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn remove Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>You use it when you wish to remove a package from your project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn global add Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Installs the <a href="#guide-npm-yarn-workflow.asciidoc_global-package">Global package</a>.</p>
</div>
<div class="paragraph">
<p>Please, refer to the documentation to learn more about yarn commands and their attributes: <a href="https://yarnpkg.com/en/docs/cli/">yarn commands</a></p>
</div>
<div class="paragraph">
<p><strong>yarn.lock</strong></p>
</div>
<div class="paragraph">
<p>This file has the same purpose as Package-lock.json, to guide the packet manager, in this case yarn,
to install the dependency tree specified in yarn.lock.</p>
</div>
<div class="paragraph">
<p>Yarn.lock and package.json are
essential files when collaborating in a project more co-workers and may be a
source of errors if programmers do not use the same manager.</p>
</div>
<div class="paragraph">
<p>Yarn.lock follows the same structure as package-lock.json, you can find an example of dependency below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations@^4.2.4":
  version "4.4.6"
  resolved "https://registry.yarnpkg.com/@angular/animations/-/animations-4.4.6.tgz#fa661899a8a4e38cb7c583c7a5c97ce65d592a35"
  dependencies:
    tslib "^1.7.1"</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As with package-lock.json, it&#8217;s strongly <strong>not</strong> adviced to modify this file. Leave its management to yarn
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can learn more about yarn.lock here: <a href="https://yarnpkg.com/en/docs/yarn-lock">yarn.lock</a></p>
</div>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_global-package">Global package</h6>
<div class="paragraph">
<p>Global packages are packages installed in your operative system instead of your local project,
global packages useful for developer tooling that is not part of any individual project but instead is used for local commands.</p>
</div>
<div class="paragraph">
<p>A good example of global package is angular/cli, a command line interface for angular used in our projects. You can install
a global package in npm with "npm install -g package" and "yarn global add package" with yarn, you have a npm example below:</p>
</div>
<div class="listingblock">
<div class="title">Listing 6. npm global package</div>
<div class="content">
<pre>npm install g @angular/cli</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.npmjs.com/getting-started/installing-npm-packages-globally">Global npm</a><br>
<a href="https://yarnpkg.com/lang/en/docs/cli/global/">Global yarn</a></p>
</div>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_package-version">Package version</h6>
<div class="paragraph">
<p>Dependencies are critical to the success of a package. You must be extra careful about
which version packages are using, one package in a different version may break your code.</p>
</div>
<div class="paragraph">
<p>Versioning in npm and yarn, follows a semantic called semver, following the logic
MAJOR.MINOR.PATCH, like for example, @angular/animations: 4.4.6.</p>
</div>
<div class="paragraph">
<p><strong>Different versions</strong></p>
</div>
<div class="paragraph">
<p>Sometimes, packages are installed with a different version from the one initially installed.
This happens because package.json also contains the range of versions we allow yarn or npm to
install or update to, example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "^4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>And here the installed one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> "@angular/animations": {
      "version": "4.4.6",
      "resolved": "https://registry.npmjs.org/@angular/animations/-/animations-4.4.6.tgz",
      "integrity": "sha1-+mYYmaik44y3xYPHpcl85l1ZKjU=",
      "requires": {
        "tslib": "1.8.0"
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the version we initially added is 4.2.4, and the version finally installed after
a global installation of all packages, 4.4.6.</p>
</div>
<div class="paragraph">
<p>Installing packages without package-lock.json or yarn.lock using their respective packet managers, will always
end with npm or yarn installing the latest version allowed by package.json.</p>
</div>
<div class="paragraph">
<p>"@angular/animations": "^4.2.4" contains not only the version we added, but also the range we allow npm and yarn
to update. Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "&lt;4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version installed must be lower than 4.2.4 .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "&gt;=4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version installed must be greater than or equal to 4.2.4 .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "=4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>the version installed must be equal to 4.2.4 .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "^4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version installed cannot modify the first non zero digit, for example in this case
it cannot surpass 5.0.0 or be lower than 4.2.4 .</p>
</div>
<div class="paragraph">
<p>You can learn more about this in <a href="https://yarnpkg.com/en/docs/dependency-versions">Versions</a></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-npm-yarn-workflow.asciidoc_problems-you-may-encounter">Problems you may encounter</h5>
<div class="paragraph">
<p>If you can&#8217;t find package.json, you may have deleted the one you had previously,
which means you have to download the package.json from the repository.
In the case you are creating a new project you can create a new package.json. More information
in the links below. Click on <a href="#guide-npm-yarn-workflow.asciidoc_package.json">Package.json</a> if you come from that section. <br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/cli/init">Creating new package.json in yarn</a><br></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/cli/init">Creating new package.json in npm</a><br></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Using npm install or yarn without package.json in your projects will
result in compilation errors. As we mentioned earlier,
Package.json contains essential information about your project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have package.json, but you don&#8217;t have package-lock.json or yarn.lock the use of
command "npm install" or "yarn"  may result in a different dependency tree.</p>
</div>
<div class="paragraph">
<p>If you are trying to import a module and visual code studio is not able to find it,
is usually caused by error adding the package to the project, try to add the module again with yarn or npm,
and restart Visual Studio Code.</p>
</div>
<div class="paragraph">
<p>Be careful with the semantic versioning inside your package.json of the packages,
or you may find a new update on one of your dependencies breaking your code.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In the following <a href="https://yarnpkg.com/en/docs/selective-version-resolutions">link</a>
there is a solution to a problematic update to one package.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A list of common errors of npm can be found in: <a href="https://docs.npmjs.com/troubleshooting/common-errors">npm errors</a></p>
</div>
<div class="sect5">
<h6 id="guide-npm-yarn-workflow.asciidoc_recomendations">Recomendations</h6>
<div class="paragraph">
<p>Use yarn <strong>or</strong> npm in your project, reach an agreement with your team in order to choose one, this will avoid
undesired situations like forgetting to upload an updated yarn.lock or package-lock.json.
Be sure to have the latest version of your project when possible.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Pull your project every time it&#8217;s updated. Erase your node_modules folder and reinstall all
dependencies. This assures you to be working with the same dependencies your team has.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>AD Center recommends the use of yarn.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_angular">1. Angular</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="guide-accessibility.asciidoc">1.1. Accessibility</h3>
<div class="paragraph">
<p>Multiple studies suggest that around 15-20% of the population are living with a disability of some kind. In comparison, that number is higher than any single browser demographic currently, other than Chrome2. Not considering those users when developing an application means excluding a large number of people from being able to use it comfortable or at all.</p>
</div>
<div class="paragraph">
<p>Some people are unable to use the mouse, view a screen, see low contrast text, Hear dialogue or music and some people having difficulty to understanding the complex language.This kind of people needed the support like Keyboard support, screen reader support, high contrast text, captions and transcripts and Plain language support. This disability may change the from permanent to the situation.</p>
</div>
<div class="sect3">
<h4 id="guide-accessibility.asciidoc_key-concerns-of-accessible-web-applications">1.1.1. Key Concerns of Accessible Web Applications</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Semantic Markup</strong> - Allows the application to be understood on a more general level rather than just details of whats being rendered</p>
</li>
<li>
<p><strong>Keyboard Accessibility</strong> - Applications must still be usable when using only a keyboard</p>
</li>
<li>
<p><strong>Visual Assistance</strong> - color contrast, focus of elements and text representations of audio and events</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_semantic-markup">Semantic Markup</h5>
<div class="paragraph">
<p>If you&#8217;re creating custom element directives, Web Components or HTML in general, use native elements wherever possible to utilize built-in events and properties. Alternatively, use ARIA to communicate semantic meaning.</p>
</div>
<div class="paragraph">
<p>HTML tags have attributes that providers extra context on what&#8217;s being displayed on the browser. For example, the  img  tag&#8217;s  alt  attribute lets the reader know what is being shown using a short description.However, native tags don&#8217;t cover all cases. This is where ARIA fits in. ARIA attributes can provide context on what roles specific elements have in the application or on how elements within the document relate to each other.</p>
</div>
<div class="paragraph">
<p>A modal component can be given the  role  of dialog or alertdialog to let the browser know that that component is acting as a modal. The modal component template can use the ARIA attributes  aria-labelledby  and  aria-described  to describe to readers what the title and purpose of the modal is.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">@Component({
    selector: 'ngc2-app',
    template: `
      &lt;ngc2-notification-button
        message="Hello!"
        label="Greeting"
        role="button"&gt;
      &lt;/ngc2-notification-button&gt;
      &lt;ngc2-modal
        [title]="modal.title"
        [description]="modal.description"
        [visible]="modal.visible"
        (close)="modal.close()"&gt;
      &lt;/ngc2-modal&gt;
    `
})
export class AppComponent {
  constructor(private modal: ModalService) { }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>notification-button.component.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">@Component({
  selector: 'ngc2-modal',
  template: `
    &lt;div
      role="dialog"
      aria-labelledby="modal-title"
      aria-describedby="modal-description"&gt;
      &lt;div id="modal-title"&gt;{{title}}&lt;/div&gt;
      &lt;p id="modal-description"&gt;{{description}}&lt;/p&gt;
      &lt;button (click)="close.emit()"&gt;OK&lt;/button&gt;
    &lt;/div&gt;
  `
})
export class ModalComponent {
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_keyboard-accessibility">Keyboard Accessibility</h5>
<div class="paragraph">
<p>Keyboard accessibility is the ability of your application to be interacted with using just a keyboard. The more streamlined the site can be used this way, the more keyboard accessible it is. Keyboard accessibility is one of the largest aspects of web accessibility since it targets:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>those with motor disabilities who can&#8217;t use a mouse</p>
</li>
<li>
<p>users who rely on screen readers and other assistive technology, which require keyboard navigation</p>
</li>
<li>
<p>those who prefer not to use a mouse</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="guide-accessibility.asciidoc_focus">Focus</h6>
<div class="paragraph">
<p>Keyboard interaction is driven by something called focus. In web applications, only one element on a document has focus at a time, and keypresses will activate whatever function is bound to that element.
Focus element border can be styled with CSS using the  outline  property, but it should not be removed. Elements can also be styled using the  :focus  psuedo-selector.</p>
</div>
</div>
<div class="sect5">
<h6 id="guide-accessibility.asciidoc_tabbing">Tabbing</h6>
<div class="paragraph">
<p>The most common way of moving focus along the page is through the  tab  key. Elements will be traversed in the order they appear in the document outline - so that order must be carefully considered during development.
There is way change the default behaviour or tab order. This can be done through the  tabindex  attribute. The  tabindex  can be given the values:
* less than zero - to let readers know that an element should be focusable but not keyboard accessible
* 0 - to let readers know that that element should be accessible by keyboard
* greater than zero - to let readers know the order in which the focusable element should be reached using the keyboard. Order is calculated from lowest to highest.</p>
</div>
</div>
<div class="sect5">
<h6 id="guide-accessibility.asciidoc_transitions">Transitions</h6>
<div class="paragraph">
<p>The majority of transitions that happen in an Angular application will not involve a page reload. This means that developers will need to carefully manage what happens to focus in these cases.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">@Component({
  selector: 'ngc2-modal',
  template: `
    &lt;div
      role="dialog"
      aria-labelledby="modal-title"
      aria-describedby="modal-description"&gt;
      &lt;div id="modal-title"&gt;{{title}}&lt;/div&gt;
      &lt;p id="modal-description"&gt;{{description}}&lt;/p&gt;
      &lt;button (click)="close.emit()"&gt;OK&lt;/button&gt;
    &lt;/div&gt;
  `,
})
export class ModalComponent {
  constructor(private modal: ModalService, private element: ElementRef) { }

  ngOnInit() {
    this.modal.visible$.subscribe(visible =&gt; {
      if(visible) {
        setTimeout(() =&gt; {
          this.element.nativeElement.querySelector('button').focus();
        }, 0);
      }
    })
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-accessibility.asciidoc_visual-assistance">1.1.2. Visual Assistance</h4>
<div class="paragraph">
<p>One large category of disability is visual impairment. This includes not just the blind, but those who are color blind or partially sighted, and require some additional consideration.</p>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_color-contrast">Color Contrast</h5>
<div class="paragraph">
<p>When choosing colors for text or elements on a website, the contrast between them needs to be considered. For WCAG 2.0 AA, this means that the contrast ratio for text or visual representations of text needs to be at least 4.5:1. There are tools online to measure the contrast ratio such as this color contrast checker from WebAIM or be checked with using automation tests.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_visual-information">Visual Information</h5>
<div class="paragraph">
<p>Color can help a user&#8217;s understanding of information, but it should never be the only way to convey information to a user. For example, a user with red/green color-blindness may have trouble discerning at a glance if an alert is informing them of success or failure.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_audiovisual-media">Audiovisual Media</h5>
<div class="paragraph">
<p>Audiovisual elements in the application such as video, sound effects or audio (ie. podcasts) need related textual representations such as transcripts, captions or descriptions. They also should never auto-play and playback controls should be provided to the user.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-accessibility.asciidoc_accessibility-with-angular-material">1.1.3. Accessibility with Angular Material</h4>
<div class="paragraph">
<p>The <code>a11y</code> package provides a number of tools to improve accessibility. Import</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { A11yModule } from '@angular/cdk/a11y';</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_listkeymanager">ListKeyManager</h5>
<div class="paragraph">
<p><code>ListKeyManager</code> manages the active option in a list of items based on keyboard interaction. Intended to be used with components that correspond to a <code>role="menu"</code> or <code>role="listbox"</code> pattern . Any component that uses a ListKeyManager will generally do three things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a <code>@ViewChildren</code> query for the options being managed.</p>
</li>
<li>
<p>Initialize the <code>ListKeyManager</code>, passing in the options.</p>
</li>
<li>
<p>Forward keyboard events from the managed component to the <code>ListKeyManager</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each option should implement the <code>ListKeyManagerOption</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">interface ListKeyManagerOption {
  disabled?: boolean;
  getLabel?(): string;
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="guide-accessibility.asciidoc_types-of-listkeymanager">Types of ListKeyManager</h6>
<div class="paragraph">
<p>There are two varieties of <code>ListKeyManager</code>, <code>FocusKeyManager</code> and <code>ActiveDescendantKeyManager</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_focuskeymanager">FocusKeyManager</h5>
<div class="paragraph">
<p>Used when options will directly receive browser focus. Each item managed must implement the FocusableOption interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">interface FocusableOption extends ListKeyManagerOption {
  focus(): void;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_activedescendantkeymanager">ActiveDescendantKeyManager</h5>
<div class="paragraph">
<p>Used when options will be marked as active via aria-activedescendant. Each item managed must implement the Highlightable interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">interface Highlightable extends ListKeyManagerOption {
  setActiveStyles(): void;
  setInactiveStyles(): void;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item must also have an ID bound to the listbox&#8217;s or menu&#8217;s aria-activedescendant.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_focustrap">FocusTrap</h5>
<div class="paragraph">
<p>The <code>cdkTrapFocus</code> directive traps Tab key focus within an element. This is intended to be used to create accessible experience for components like modal dialogs, where focus must be constrained. This directive is declared in <code>A11yModule</code>.</p>
</div>
<div class="paragraph">
<p>This directive will not prevent focus from moving out of the trapped region due to mouse interaction.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;div class="my-inner-dialog-content" cdkTrapFocus&gt;
  &lt;!-- Tab and Shift + Tab will not leave this element. --&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_regions">Regions</h5>
<div class="paragraph">
<p>Regions can be declared explicitly with an initial focus element by using the <code>cdkFocusRegionStart</code>, <code>cdkFocusRegionEnd</code> and <code>cdkFocusInitial</code> DOM attributes. When using the tab key, focus will move through this region and wrap around on either end.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;a mat-list-item routerLink cdkFocusRegionStart&gt;Focus region start&lt;/a&gt;
&lt;a mat-list-item routerLink&gt;Link&lt;/a&gt;
&lt;a mat-list-item routerLink cdkFocusInitial&gt;Initially focused&lt;/a&gt;
&lt;a mat-list-item routerLink cdkFocusRegionEnd&gt;Focus region end&lt;/a&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_interactivitychecker">InteractivityChecker</h5>
<div class="paragraph">
<p><code>InteractivityChecker</code> is used to check the interactivity of an element, capturing disabled, visible, tabbable, and focusable states for accessibility purposes.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_liveannouncer">LiveAnnouncer</h5>
<div class="paragraph">
<p><code>LiveAnnouncer</code> is used to announce messages for screen-reader users using an aria-live region.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">@Component({...})
export class MyComponent {

 constructor(liveAnnouncer: LiveAnnouncer) {
   liveAnnouncer.announce("Hey Google");
 }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-accessibility.asciidoc_api-reference-for-angular-cdk-a11y">API reference for Angular CDK a11y</h5>
<div class="paragraph">
<p><a href="https://material.angular.io/cdk/a11y/api">API reference for Angular CDK a11y</a></p>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-angular-elements.asciidoc">1.2. Angular Elements</h3>
<div class="sect3">
<h4 id="guide-angular-elements.asciidoc_what-are-angular-elements">1.2.1. What are Angular Elements?</h4>
<div class="paragraph">
<p><a href="https://angular.io/guide/elements">Angular elements</a> are Angular components packaged as custom elements, a web standard for defining new HTML elements in a framework-agnostic way.</p>
</div>
<div class="paragraph">
<p>Custom elements are a Web Platform feature currently supported by Chrome, Firefox, Opera, and Safari, and available in other browsers through <a href="https://angular.io/guide/elements#browser-support">Polyfills</a>. A custom element extends HTML by allowing you to define a tag whose content is created and controlled by JavaScript code. The browser maintains a CustomElementRegistry of defined custom elements (also called Web Components), which maps an instantiable JavaScript class to an HTML tag.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-elements.asciidoc_why-use-angular-elements">1.2.2. Why use Angular Elements?</h4>
<div class="paragraph">
<p>Angular Elements allows Angular to work with different frameworks by using input and output elements. This allows Angular to work with many different frameworks if needed. This is an ideal situation if a slow transformation of an application to <code>Angular</code> is needed or some Angular needs to be added in other web applications(For example. <code>ASP.net</code>, <code>JSP</code> etc )</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-elements.asciidoc_negative-points-about-elements">1.2.3. Negative points about Elements</h4>
<div class="paragraph">
<p>Angular Elements is really powerful but since, the transition between views between views is going to be handled by another framework or html/javascript, using Angular <code>Router</code> is not possible. the view transitions have to be handled manually. This fact also eliminates the possibility of just porting an application completely.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-elements.asciidoc_how-to-use-angular-elements">1.2.4. How to use Angular Elements?</h4>
<div class="paragraph">
<p>In a generalized way, a simple <code>Angular component</code> could be transformed to an <code>Angular Element</code> with this steps:</p>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_installing-angular-elements">Installing Angular Elements</h5>
<div class="paragraph">
<p>The first step is going to be install the library using our prefered packet manager:</p>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_npm">NPM</h7>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install @angular/elements</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_yarn">YARN</h7>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>yarn add @angular/elements</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_preparing-the-components-in-the-modules">Preparing the components in the modules</h5>
<div class="paragraph">
<p>Inside the <code>app.module.ts</code>, in addition to the normal declaration of the components inside <code>declarations</code>, the modules inside <code>imports</code> and the services inside <code>providers</code>, the components need to added in <code>entryComponents</code>. If there are components that have their own module, the same logic is going to be applied for them, only adding in the <code>app.module.ts</code> the components that dont have their own module. Here is an example of this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
@NgModule({
  declarations: [
    DishFormComponent,
    DishviewComponent
  ],
  imports: [
    CoreModule,  // Module containing Angular Materials
    FormsModule
  ],
  entryComponents: [
    DishFormComponent,
    DishviewComponent
  ],
  providers: [DishShareService]
})
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that is done, the constructor of the module is going to be modified to use injector and boostrap the application defining the components. This is going to allow the <code>Angular Element</code> to get the injections and to define a component tag that will be used later:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
})
export class AppModule {
  constructor(private injector: Injector) {

  }

  ngDoBootstrap() {
    const el = createCustomElement(DishFormComponent, {injector: this.injector});
    customElements.define('dish-form', el);

    const elView = createCustomElement(DishviewComponent, {injector: this.injector});
    customElements.define('dish-view', elView);
  }
}
....</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_a-component-example">A component example</h5>
<div class="paragraph">
<p>In order to be able to use a component, <code>@Input()</code> and <code>@Output()</code> variables are used. These variables are going to be the ones that will allow the Angular Element to communicate with the framework/javascript:</p>
</div>
<div class="paragraph">
<p>Component html</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;mat-card&gt;
    &lt;mat-grid-list cols="1" rowHeight="100px" rowWidth="50%"&gt;
				&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
					&lt;span&gt;{{ platename }}&lt;/span&gt;
				&lt;/mat-grid-tile&gt;
				&lt;form (ngSubmit)="onSubmit(dishForm)" #dishForm="ngForm"&gt;
					&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
						&lt;mat-form-field&gt;
							&lt;input matInput placeholder="Name" name="name" [(ngModel)]="dish.name"&gt;
						&lt;/mat-form-field&gt;
					&lt;/mat-grid-tile&gt;
					&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
						&lt;mat-form-field&gt;
							&lt;textarea matInput placeholder="Description" name="description" [(ngModel)]="dish.description"&gt;&lt;/textarea&gt;
						&lt;/mat-form-field&gt;
					&lt;/mat-grid-tile&gt;
					&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
						&lt;button mat-raised-button color="primary" type="submit"&gt;Submit&lt;/button&gt;
					&lt;/mat-grid-tile&gt;
				&lt;/form&gt;
		&lt;/mat-grid-list&gt;
&lt;/mat-card&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Component ts</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Component({
  templateUrl: './dish-form.component.html',
  styleUrls: ['./dish-form.component.scss']
})
export class DishFormComponent implements OnInit {

  @Input() platename;

  @Input() platedescription;

  @Output()
  submitDishEvent = new EventEmitter();

  submitted = false;
  dish = {name: '', description: ''};

  constructor(public dishShareService: DishShareService) { }

  ngOnInit() {
    this.dish.name = this.platename;
    this.dish.description = this.platedescription;
  }

  onSubmit(dishForm: NgForm): void {
    console.log('SUBMIT');
    console.log(dishForm.value);
    this.dishShareService.createDish(dishForm.value.name, dishForm.value.description);
    this.submitDishEvent.emit('dishSubmited');
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this file there are definitions of multiple variables that will be used as input and output. Since the input variables are going to be used directly by html, only lowercase and underscore strategies can be used for them. On the <code>onSubmit(dishForm: NgForm)</code> a service is used to pass this variables to another component. Finally, as a last thing, the selector inside <code>@Component</code> has been removed since a tag that will be used dynamically was already defined in the last step.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_solving-the-error">Solving the error</h5>
<div class="paragraph">
<p>In order to be able to use this <code>Angular Element</code> a <code>Polyfills</code>/<code>Browser support</code> related error needs to solved. This error can be solved in two ways:</p>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_changing-the-target">Changing the target</h7>
<div class="paragraph">
<p>One solution is to change the target in <code>tsconfig.json</code> to <code>es2015</code>. This might not be doable for every application since maybe a specific target is required.</p>
</div>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_installing-polyfaces">Installing Polyfaces</h7>
<div class="paragraph">
<p>Another solution is to use AutoPollyfill. In order to do so, the library is going to be installed with a packet manager:</p>
</div>
<div class="paragraph">
<p>Yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>yarn add @webcomponents/webcomponentsjs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install @webcomponents/webcomponentsjs</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the packet manager has finished, inside the src folder a new file <code>polyfills.ts</code> is found. To solve the error, importing the corresponding adapter (<code>custom-elements-es5-adapter.js</code>) is necessary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
/***************************************************************************************************
 * APPLICATION IMPORTS
 */

import '@webcomponents/webcomponentsjs/custom-elements-es5-adapter.js';
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to learn more about polyfills in angular you can do it <a href="https://angular.io/guide/browser-support">here</a></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_building-the-angular-element">Building the Angular Element</h5>
<div class="paragraph">
<p>First, before building the <code>Angular Element</code>, every element inside that app component except the module need to be removed. After that, a bash script is created in the root folder,. This script will allow to put every necessary file into a js.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng build "projectName" --prod --output-hashing=none &amp;&amp; cat dist/"projectName"/runtime.js dist/"projectName"/polyfills.js dist/"projectName"/scripts.js dist/"projectName"/main.js &gt; ./dist/"projectName"/"nameWantedAngularElement".js</code></pre>
</div>
</div>
<div class="paragraph">
<p>After executing the bash script, it will generate inside the path <code>dist/"projectName"</code> a js file named <code>"nameWantedAngularElement".js</code> and a css file.</p>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_building-with-ngx-build-plus-recommended">Building with ngx-build-plus (Recommended)</h7>
<div class="paragraph">
<p>The library <a href="https://github.com/manfredsteyer/ngx-build-plus">ngx-build-plus</a> allows to add different options when building. In addition, it solves some errors that will occur when trying to use multiple angular elements in an application. In order to use it, yarn or npm can be used:</p>
</div>
<div class="paragraph">
<p>Yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>yarn add ngx-build-plus</code></pre>
</div>
</div>
<div class="paragraph">
<p>Npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install ngx-build-plus</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to add it to a specific sub project in your projects folder, use the --project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>.... ngx-build-plus --project "project-name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this library and the following command, an isolated <code>Angular Element</code> which won&#8217;t have conflict with others can be generated. This <code>Angular Element</code> will not have a polyfill so, the project where we use them will need to include a <code>poliyfill</code> with the <code>Angular Element</code> requirements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng build "projectName" --output-hashing none --single-bundle true --prod --bundle-styles false</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will generate three things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The main js bundle</p>
</li>
<li>
<p>The script js</p>
</li>
<li>
<p>The css</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These files will be used later instead of the single js generated in the last step.</p>
</div>
<div class="sect7">
<h8 id="guide-angular-elements.asciidoc_extra-parameters">Extra parameters</h8>
<div class="paragraph">
<p>Here are some extra useful parameters that <code>ngx-build-plus</code> provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--keep-polyfills</code>: This paremeter is going to allow us to keep the polyfills. This needs to be used with caution, avoiding using multiple different polyfills that could cause an error is necessary.</p>
</li>
<li>
<p><code>--extraWebpackConfig webpack.extra.js</code>: This parameter allows us to create a javascript file inside our <code>Angular Elements</code> project with the name of different libraries. Using <code>webpack</code> these libraries will not be included in the <code>Angular Element</code>. This is useful to lower the size of our <code>Angular Element</code> by removing libraries shared. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const webpack = require('webpack');

module.exports = {
    "externals": {
        "rxjs": "rxjs",
        "@angular/core": "ng.core",
        "@angular/common": "ng.common",
        "@angular/common/http": "ng.common.http",
        "@angular/platform-browser": "ng.platformBrowser",
        "@angular/platform-browser-dynamic": "ng.platformBrowserDynamic",
        "@angular/compiler": "ng.compiler",
        "@angular/elements": "ng.elements",
        "@angular/router": "ng.router",
        "@angular/forms": "ng.forms"
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="literalblock">
<div class="content">
<pre>If some libraries are excluded from the `Angular Element` you will need to add the bundled umd files of those libraries manually.</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_using-the-angular-element">Using the Angular Element</h5>
<div class="paragraph">
<p>The <code>Angular Element</code> that got generated in the last step can be used in almost every framework. In this case, the <code>Angular Element</code> is going to be used in html:</p>
</div>
<div class="listingblock">
<div class="title">Listing 7. Sample index.html version without ngx-build-plus</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" href="styles.css"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container"&gt;

        &lt;/div&gt;
        &lt;!--Use of the element non dynamically--&gt;
        &lt;!--&lt;plate-form platename="test" platedescription="test"&gt;&lt;/plate-form&gt;--&gt;
        &lt;script src="./devon4ngAngularElements.js"&gt; &lt;/script&gt;
        &lt;script&gt;
                var elContainer = document.getElementById('container');
                var el= document.createElement('dish-form');
                el.setAttribute('platename','test');
                el.setAttribute('platedescription','test');
                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });
                elContainer.appendChild(el);
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 8. Sample index.html version with ngx-build-plus</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" href="styles.css"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container"&gt;

        &lt;/div&gt;
        &lt;!--Use of the element non dynamically--&gt;
        &lt;!--&lt;plate-form platename="test" platedescription="test"&gt;&lt;/plate-form&gt;--&gt;
         &lt;script src="./polyfills.js"&gt; &lt;/script&gt; &lt;!-- Created using --keep-polyfills options --&gt;
        &lt;script src="./scripts.js"&gt; &lt;/script&gt;
         &lt;script src="./main.js"&gt; &lt;/script&gt;
        &lt;script&gt;
                var elContainer = document.getElementById('container');
                var el= document.createElement('dish-form');
                el.setAttribute('platename','test');
                el.setAttribute('platedescription','test');
                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });
                elContainer.appendChild(el);
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this html, the css generated in the last step is going to be imported inside the <code>&lt;head&gt;</code> and then, the javascript element is going to be imported at the end of the body. After that is done, There is two uses of <code>Angular Elements</code> in the html, one directly whith use of the <code>@input()</code> variables as parameters commented in the html:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
        &lt;!--Use of the element non dynamically--&gt;
        &lt;!--&lt;plate-form platename="test" platedescription="test"&gt;&lt;/plate-form&gt;--&gt;
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>and one dynamically inside the script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
        &lt;script&gt;
                var elContainer = document.getElementById('container');
                var el= document.createElement('dish-form');
                el.setAttribute('platename','test');
                el.setAttribute('platedescription','test');
                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });
                elContainer.appendChild(el);
        &lt;/script&gt;
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>This javascript is an example of how to create dynamically an <code>Angular Element</code> inserting attributed to fill our <code>@Input()</code> variables and listen to the <code>@Output()</code> that was defined earlier. This is done with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows javascript to hook with the <code>@Output()</code> event emitter that was defined. When this event gets called, another component that was defined gets inserted dynamically.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-elements.asciidoc_angular-element-within-another-angular-project">1.2.5. Angular Element within another Angular project</h4>
<div class="paragraph">
<p>In order to use an <code>Angular Element</code> within another <code>Angular</code> project the following steps need to be followed:</p>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_copy-bundled-script-and-css-to-resources">Copy bundled script and css to resources</h5>
<div class="paragraph">
<p>First copy the generated <code>.js</code> and <code>.css</code> inside assets in the corresponding folder.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_add-bundled-script-to-angular.json">Add bundled script to angular.json</h5>
<div class="paragraph">
<p>Inside <code>angular.json</code> both of the files that were copied in the last step are going to be included. This will be done both, in <code>test</code> and in <code>build</code>. Including it on the test, will allow to perform unitary tests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
....
  "architect": {
    ....
    "build": {
      ....
      "styles": [
        ....
          "src/assets/css/devon4ngAngularElements.css"
        ....
      ]
      ....
      "scripts": [
        "src/assets/js/devon4ngAngularElements.js"
      ]
      ....
    }
    ....
    "test": {
      ....
      "styles": [
        ....
          "src/assets/css/devon4ngAngularElements.css"
        ....
      ]
      ....
      "scripts": [
        "src/assets/js/devon4ngAngularElements.js"
      ]
      ....
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By declaring the files in the <code>angular.json</code> angular will take care of including them in a proper way.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-elements.asciidoc_using-angular-element">Using Angular Element</h5>
<div class="paragraph">
<p>There are two ways that <code>Angular Element</code> can be used:</p>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_create-component-dynamicly">Create component dynamicly</h7>
<div class="paragraph">
<p>In order to add the component in a dynamic way, first adding a container is necessary:</p>
</div>
<div class="paragraph">
<p><code>app.component.html</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
&lt;div id="container"&gt;
&lt;/div&gt;
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this container created, inside the <code>app.component.ts</code> a method is going to be created. This method is going to find the container, create the dynamic element and append it into the container.</p>
</div>
<div class="paragraph">
<p><code>app.component.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class AppComponent implements OnInit {
  ....
  ngOnInit(): void {
    this.createComponent();
  }
  ....
  createComponent(): void {
    const container = document.getElementById('container');
    const component = document.createElement('dish-form');
    container.appendChild(component);
  }
  ....</code></pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="guide-angular-elements.asciidoc_using-it-directly">Using it directly</h7>
<div class="paragraph">
<p>In order to use it directly on the templates, in the <code>app.module.ts</code> the <code>CUSTOM_ELEMENTS_SCHEMA</code> needs to be added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
....
@NgModule({
  ....
  schemas: [ CUSTOM_ELEMENTS_SCHEMA ],</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is going to allow the use of the <code>Angular Element</code> in the templates directly:</p>
</div>
<div class="paragraph">
<p><code>app.component.html</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
&lt;div id="container"&gt;
  &lt;dish-form&gt;&lt;/dish-form&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-angular-lazy-loading.asciidoc">1.3. Angular Lazy loading</h3>
<div class="paragraph">
<p>When the development of an application starts, it just contains a small set of features so the app usually loads fast. However, as new features are added, the overall application size grows up  and its loading speed decreases, is in this context where Lazy loading finds its place.
Lazy loading is a dessign pattern that defers initialization of objects until it is needed so, for example, Users that just access to a website&#8217;s home page do not need to have other areas loaded.
Angular handles lazy loading through the routing module which redirect to requested pages. Those pages can be loaded at start or on demand.</p>
</div>
<div class="sect3">
<h4 id="guide-angular-lazy-loading.asciidoc_an-example-with-angular">1.3.1. An example with Angular</h4>
<div class="paragraph">
<p>To explain how lazy loading is implemented using angular, a basic sample app is going to be developed. This app will consist in a window named "level 1" that contains two buttons that redirects to other windows in a "second level". It is a simple example, but useful to understand the relation between angular modules and lazy loading.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/levels-app.png" alt="Levels app structure" width="500 link="images/angular/angular-lazy/levels-app.png"">
</div>
<div class="title">Figure 9. Levels app structure.</div>
</div>
<div class="paragraph">
<p>This graphic shows that modules acts as gates to access components "inside" them.</p>
</div>
<div class="paragraph">
<p>Because the objective of this guide is related mainly with logic, the html structure and scss styles are less relevant, but the complete code can be found as a sample <a href="https://github.com/devonfw/devon4ng/tree/master/samples/AngularLazyLoading">here</a>.</p>
</div>
<div class="sect4">
<h5 id="guide-angular-lazy-loading.asciidoc_implementation">Implementation</h5>
<div class="paragraph">
<p>First write in a console <code>ng new level-app --routing</code>, to generate a new project called level-app including an app-routing.module.ts file (<strong>--routing</strong> flag).</p>
</div>
<div class="paragraph">
<p>In the file app.component.html delete all the content except the router-outlet tag.</p>
</div>
<div class="listingblock">
<div class="title">Listing 9. File app.component.html</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next steps consists on creating features modules.</p>
</div>
<div class="paragraph">
<p>run <code>ng generate module first --routing</code>  to generate a module named <em>first</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>ng generate module first/second-left --routing</code> to generate a module named <em>second-left</em> under <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate module first/second-right --routing</code> to generate a module <em>second-right</em> under <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/first</code> to generate a component named <em>first</em> inside the module <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/second-left/content</code> to generate a component <em>content</em> inside the module <em>second-left</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/second-right/content</code> to generate a component <em>content</em> inside the module <em>second-right</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To move between components we have to configure the routes used:</p>
</div>
<div class="paragraph">
<p>In <strong>app-routing.module.ts</strong> add a path <strong>'first'</strong> to FirstComponent and a redirection from <strong>''</strong> to <strong>'first'</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 10. File app-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { FirstComponent } from './first/first/first.component';

const routes: Routes = [
  {
    path: 'first',
    component: FirstComponent
  },
  {
    path: '',
    redirectTo: 'first',
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>app.module.ts</strong> import the module which includes FirstComponent.</p>
</div>
<div class="listingblock">
<div class="title">Listing 11. File app.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">....
import { FirstModule } from './first/first.module';

@NgModule({
  ...
  imports: [
    ....
    FirstModule
  ],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>first-routing.module.ts</strong> add routes that direct to the content of SecondRightModule and SecondLeftModule. The content of both modules have the same name so, in order to avoid conflicts the name of the components are going to be changed using <strong>as</strong> ( original-name as new-name).</p>
</div>
<div class="listingblock">
<div class="title">Listing 12. File first-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { ContentComponent as ContentLeft} from './second-left/content/content.component';
import { ContentComponent as ContentRight} from './second-right/content/content.component';
import { FirstComponent } from './first/first.component';

const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'first/second-left',
    component: ContentLeft
  },
  {
    path: 'first/second-right',
    component: ContentRight
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class FirstRoutingModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In first.module.ts import SecondLeftModule and SecondRightModule.</p>
</div>
<div class="listingblock">
<div class="title">Listing 13. File first.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { SecondLeftModule } from './second-left/second-left.module';
import { SecondRightModule } from './second-right/second-right.module';

@NgModule({
  ...
  imports: [
    ...
    SecondLeftModule,
    SecondRightModule,
  ]
})
export class FirstModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the current configuration, we have a project that loads all the modules in a eager way. Run <code>ng serve</code> to see what happens.</p>
</div>
<div class="paragraph">
<p>First, during the compilation we can see that just a main file is built.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/compile-eager.png" alt="Compile eager" width="800 link="images/angular/angular-lazy/compile-eager.png"">
</div>
<div class="title">Figure 10. Compile eager.</div>
</div>
<div class="paragraph">
<p>If we go to http//localhost:4200/first and open developer options (F12 on Chrome), it is found that a document named "first" is loaded.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/first-lvl-eager.png" alt="First level eager" width="800 link="images/angular/angular-lazy/first-lvl-eager.png"">
</div>
<div class="title">Figure 11. First level eager.</div>
</div>
<div class="paragraph">
<p>If we click on <strong>[Go to right module]</strong> a second level module opens, but there is no 'second-right' document.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/second-lvl-right-eager.png" alt="Second level right eager" width="800 link="images/angular/angular-lazy/second-lvl-right-eager.png"">
</div>
<div class="title">Figure 12. Second level right eager.</div>
</div>
<div class="paragraph">
<p>But, typing the url directly will load 'second-right' but no 'first', even if we click on <strong>[Go back]</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/second-lvl-right-eager-d.png" alt="Second level right eager" width="800 link="images/angular/angular-lazy/second-lvl-right-eager-d.png"">
</div>
<div class="title">Figure 13. Second level right eager direct url.</div>
</div>
<div class="paragraph">
<p>Modifying an angular application to load its modules lazily is easy, you have to change the routing configuration of the desired module (for example FirstModule).</p>
</div>
<div class="listingblock">
<div class="title">Listing 14. File app-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: 'first',
    loadChildren: () =&gt; import('./first/first.module').then(m =&gt; m.FirstModule),
  },
  {
    path: '',
    redirectTo: 'first',
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that instead of loading a component, you dynamically import it in a <em>loadChildren</em> attribute because modules acts as gates to access components "inside" them. Updating the app to load lazily has four consecuences:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No component attribute.</p>
</li>
<li>
<p>No import of FirstComponent.</p>
</li>
<li>
<p>FirstModule import has to be removed from the imports array at app.module.ts.</p>
</li>
<li>
<p>Change of context.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If we check <strong>first-routing.module.ts</strong> again, the can see that the path for ContentLeft and ContentRight is set to 'first/second-left' and 'first/second-right' respectively, so writing 'http//localhost:4200/first/second-left' will redirect us to ContentLeft. However, after loading a module with loadChildren setting the path to '<em>second-left</em>' and '<em>second-right</em>' is enough because it adquires the context set by AppRoutingModule.</p>
</div>
<div class="listingblock">
<div class="title">Listing 15. File first-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'second-left',
    component: ContentLeft
  },
  {
    path: 'second-right',
    component: ContentRight
  }
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we go to '<em>first</em>' then FirstModule is situated in '<em>/first</em>' but also its children ContentLeft and ContentRight, so it is not necessary to write in their path '<em>first/second-left</em>' and '<em>first/second-right</em>', because that will situate the components on '<em>first/first/second-left</em>' and  '<em>first/first/second-right</em>'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/first-lvl-wrong-path.png" alt="First level wrong path" width="800 link="images/angular/angular-lazy/first-lvl-wrong-path.png"">
</div>
<div class="title">Figure 14. First level lazy wrong path.</div>
</div>
<div class="paragraph">
<p>When we compile an app with lazy loaded modules, files containing them will be generated</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/compile-first-lazy.png" alt="First level lazy compilation" width="800 link="images/angular/angular-lazy/compile-first-lazy.png"">
</div>
<div class="title">Figure 15. First level lazy compilation.</div>
</div>
<div class="paragraph">
<p>And if we go to <em>developer tools &#8594; network</em>, we can find those modules loaded (if they are needed).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/first-lvl-lazy.png" alt="First level lazy" width="800 link="images/angular/angular-lazy/first-lvl-lazy.png"">
</div>
<div class="title">Figure 16. First level lazy.</div>
</div>
<div class="paragraph">
<p>To load the component ContentComponent of SecondLeftModule lazily, we have to load SecondLeftModule as a children of FirstModule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change <strong>component</strong> to <strong>loadChildren</strong> and reference SecondLeftModule.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 16. File first-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'second-left',
    loadChildren: () =&gt; import('./second-left/second-left.module').then(m =&gt; m.SecondLeftModule),
  },
  {
    path: 'second-right',
    component: ContentRight
  }
];</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove SecondLeftModule at first.component.ts</p>
</li>
<li>
<p>Route the components inside SecondLeftModule. Without this step nothing would be displayed.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 17. File second-left-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { ContentComponent } from './content/content.component';

const routes: Routes = [
  {
    path: '',
    component: ContentComponent
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class SecondLeftRoutingModule { }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>ng serve</code> to generate files containing the lazy modules.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/second-lvl-lazy.png" alt="Second level lazy" width="800 link="images/angular/angular-lazy/second-lvl-lazy.png"">
</div>
<div class="title">Figure 17. Second level lazy loading compilation.</div>
</div>
<div class="paragraph">
<p>Clicking on <strong>[Go to left module]</strong> triggers the load of SecondLeftModule.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-lazy/second-lvl-left-lazy.png" alt="Second level lazy network" width="800 link="images/angular/angular-lazy/second-lvl-left-lazy.png"">
</div>
<div class="title">Figure 18. Second level lazy loading network.</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-lazy-loading.asciidoc_conclusion">1.3.2. Conclusion</h4>
<div class="paragraph">
<p>Lazy loading is a pattern useful when new features are added, these features are usually identified as modules which can be loaded only if needed as shown in this document, reducing the time spent loading an application.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="guide-angular-library.asciidoc">1.4. Angular Library</h3>
<div class="paragraph">
<p><code>Angular CLI</code> provides us with methods that allow the creation of a library. After that, using either packet manager (<code>npm</code> or <code>yarn</code>) the library can be build and packed which will allow later to install/publish it.</p>
</div>
<div class="sect3">
<h4 id="guide-angular-library.asciidoc_whats-a-library">1.4.1. Whats a library?</h4>
<div class="paragraph">
<p>From <a href="https://en.wikipedia.org/wiki/Library_(computing)">wikipedia</a>: a library is a collection of non-volatile resources used by computer programs, often for software development. These may include configuration data, documentation, help data, message templates, pre-written code and subroutines, classes, values or type specifications.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-library.asciidoc_how-to-build-a-library">1.4.2. How to build a library</h4>
<div class="paragraph">
<p>In this section, a library is going to be build step by step.</p>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_creating-an-empty-application">Creating an empty application</h5>
<div class="paragraph">
<p>First, using <code>Angular CLI</code> we are going to generate a empty application which will be later filled with the generated library. In order to do so, <code>Angular CLI</code> allows us to add to <code>ng new "application-name"</code> an option (<code>--create-application</code>). This option is going to tell <code>Angular CLI</code> not to create the initial <code>app</code> project. This is convenient since a library is going to be generated in later steps. Using this command <code>ng new "application-name" --create-application=false</code> an empty project with the name wanted is created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng new "application-name" --create-application=false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_generating-a-library">Generating a library</h5>
<div class="paragraph">
<p>After generating an empty application, a library is going to be generated. Inside the folder of the project, the <code>Angular CLI</code> command <code>ng generate library "library-name"</code> is going to generate the library as a project (<code>projects/"library-name"</code>). As an addition, the option <code>--prefix="library-prefix-wanted"</code> allows us to switch the default prefix that Angular generated with (<code>lib</code>). Using the option to change the prefix the command will look like this <code>ng generate library "library-name" --prefix="library-prefix-wanted"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng generate library "library-name" --prefix="library-prefix-wanted"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_generatingmodifying-in-our-library">Generating/Modifying in our library</h5>
<div class="paragraph">
<p>In the last step we generated a library. This generates automaticly a <code>module</code>,<code>service</code> and <code>component</code> inside (<code>projects/"library-name"</code>) that we can modify adding new methods, components etc that we want to use in other projects. We can generate other elements, using the usual <code>Angular CLI</code> generate commands adding the option <code>--project="library-name"</code> is going to allow to generate elements within our project . An example of this is: <code>ng generate service "name" --project="library-name"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng generate "element" "name" --project="library-name"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_exporting-the-generated-things">Exporting the generated things</h5>
<div class="paragraph">
<p>Inside the library (<code>projects/"library-name</code>) theres a <code>public_api.ts</code> which is the file that exports the elements inside the library. In case we generated other things, that file needs to be modified adding the extra exports with the generated elements. In addition, changing the library version is possible in the file <code>package.json</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_building-our-library">Building our library</h5>
<div class="paragraph">
<p>Once we added the necessary exports, in order to use the library in other applications, we need to build the library. The command <code>ng build "library-name"</code> is going to build the library, generating in <code>"project-name"/dist/"library-name"</code> the necessary files.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng build "library-name"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_packing-the-library">Packing the library</h5>
<div class="paragraph">
<p>In this step we are going to pack the build library. In order to do so, we need to go inside <code>dist/"library-name"</code> and then run either <code>npm pack</code> or <code>yarn pack</code> to generate a <code>"library-name-version.tgz"</code> file.</p>
</div>
<div class="listingblock">
<div class="title">Listing 18. Packing using npm</div>
<div class="content">
<pre class="highlightjs highlight"><code>npm pack</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 19. Packing using yarn</div>
<div class="content">
<pre class="highlightjs highlight"><code>yarn pack</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_publishing-to-npm-repository-optional">Publishing to npm repository (optional)</h5>
<div class="ulist">
<ul>
<li>
<p>Add a <em>README.md</em> and <em>LICENSE</em> file. The text inside <em>README.md</em> will be used in you npm package web page as documentation.</p>
</li>
<li>
<p>run <code>npm adduser</code> if you do not have a npm account to create it, otherwise run <code>npm login</code> and introduce your credentials.</p>
</li>
<li>
<p>run <code>npm publish</code> inside <code>dist/"library-name"</code> folder.</p>
</li>
<li>
<p>Check that the library is published: <a href="https://npmjs.com/package/library-name" class="bare">https://npmjs.com/package/library-name</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_installing-our-library-in-other-projects">Installing our library in other projects</h5>
<div class="paragraph">
<p>In this step we are going to install/add the library on other projects.</p>
</div>
<div class="sect5">
<h6 id="guide-angular-library.asciidoc_npm">npm</h6>
<div class="paragraph">
<p>In order to add the library in other applications, there are two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Option 1</strong>: From inside the application where the library is going to get used, using the command <code>npm install "path-to-tgz"/"library-name-version.tgz"</code> allows us to install the <code>.tgz</code> generated in <a href="#guide-angular-library.asciidoc_id-packing-library">Packing the library</a>.</p>
</li>
<li>
<p><strong>Option 2</strong>: run <code>npm install "library-name"</code> to install it from npm repository.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="guide-angular-library.asciidoc_yarn">yarn</h6>
<div class="paragraph">
<p>To add the package using yarn:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Option 1</strong>: From inside the application where the library is going to get used, using the command <code>yarn add "path-to-tgz"/"library-name-version.tgz"</code> allows us to install the <code>.tgz</code>  generated in <a href="#guide-angular-library.asciidoc_id-packing-library">Packing the library</a>.</p>
</li>
<li>
<p><strong>Option 2</strong>: run <code>yarn add "library-name"</code> to install it from npm repository.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_using-the-library">Using the library</h5>
<div class="paragraph">
<p>Finally, once the library was installed with either packet manager, you can start using the elements from inside like they would be used in a normal element inside the application. Example <code>app.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Component, OnInit } from '@angular/core';
import { MyLibraryService } from 'my-library';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.scss']
})
export class AppComponent implements OnInit {

  toUpper: string;

  constructor(private myLibraryService: MyLibraryService) {}
  title = 'devon4ng library test';
  ngOnInit(): void {
    this.toUpper = this.myLibraryService.firstLetterToUpper('test');
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example <code>app.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">&lt;!--The content below is only a placeholder and can be replaced.--&gt;
&lt;div style="text-align:center"&gt;
  &lt;h1&gt;
    Welcome to {{ title }}!
  &lt;/h1&gt;
  &lt;img width="300" alt="Angular Logo" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTAgMjUwIj4KICAgIDxwYXRoIGZpbGw9IiNERDAwMzEiIGQ9Ik0xMjUgMzBMMzEuOSA2My4ybDE0LjIgMTIzLjFMMTI1IDIzMGw3OC45LTQzLjcgMTQuMi0xMjMuMXoiIC8+CiAgICA8cGF0aCBmaWxsPSIjQzMwMDJGIiBkPSJNMTI1IDMwdjIyLjItLjFWMjMwbDc4LjktNDMuNyAxNC4yLTEyMy4xTDEyNSAzMHoiIC8+CiAgICA8cGF0aCAgZmlsbD0iI0ZGRkZGRiIgZD0iTTEyNSA1Mi4xTDY2LjggMTgyLjZoMjEuN2wxMS43LTI5LjJoNDkuNGwxMS43IDI5LjJIMTgzTDEyNSA1Mi4xem0xNyA4My4zaC0zNGwxNy00MC45IDE3IDQwLjl6IiAvPgogIDwvc3ZnPg=="&gt;
&lt;/div&gt;
&lt;h2&gt;Here is my library service being used: {{toUpper}}&lt;/h2&gt;
&lt;lib-my-library&gt;&lt;/lib-my-library&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example <code>app.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';

import { MyLibraryModule } from 'my-library';
@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    MyLibraryModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result from using the library:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/angular-library/result.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular-library/result.png" alt="result"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-library.asciidoc_devon4ng-libraries">devon4ng libraries</h5>
<div class="paragraph">
<p>In <a href="https://github.com/devonfw/devon4ng-library">devonfw/devon4ng-library</a> you can find some useful libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Authorization module</strong>: This devon4ng Angular module adds rights-based authorization to your Angular app.</p>
</li>
<li>
<p><strong>Cache module</strong>: Use this devon4ng Angular module when you want to cache requests to server. You may configure it to store in cache only the requests you need and to set the duration you want.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-angular-theming.asciidoc">1.5. Angular Material Theming</h3>
<div class="paragraph">
<p>Angular Material library offers UI components for developers, those components follows Google Material desing baselines but characteristics like colors can be modified in order to adapt them to the needs of the client: corporative colors, corporative identity, dark themes, &#8230;&#8203;</p>
</div>
<div class="sect3">
<h4 id="guide-angular-theming.asciidoc_theming-basics">1.5.1. Theming basics</h4>
<div class="paragraph">
<p>In Angular Material, a theme is created mixing multiple colors. Colors and its light and dark variants conform a <strong>palette</strong>. In general, a theme consists of the following palettes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>primary</strong>: Most used across screens and componets.</p>
</li>
<li>
<p><strong>accent</strong>: Floating action button and interactive elements.</p>
</li>
<li>
<p><strong>warn</strong>: Error state.</p>
</li>
<li>
<p><strong>foreground</strong>: Text and icons.</p>
</li>
<li>
<p><strong>background</strong>: Element backgrounds.</p>
</li>
</ul>
</div>
<div id="guide-angular-theming.asciidoc_id_palette_variants" class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/palette.PNG" alt="Theme palette" width="600 link="images/angular/angular-theming/palette.PNG"">
</div>
<div class="title">Figure 19. Palettes and variants.</div>
</div>
<div class="paragraph">
<p>In angular material, a palette is represented as a scss map.</p>
</div>
<div id="guide-angular-theming.asciidoc_id_scss_map" class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/scss-map.png" alt="Scss map" width="600 link="images/angular/angular-theming/scss-map.png"">
</div>
<div class="title">Figure 20. Scss map and palettes.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Some components can be forced to use primary, accent or warn palettes using the attribute <strong>color</strong>, for example: &lt;mat-toolbar color="primary"&gt;.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-theming.asciidoc_prebuilt-themes">1.5.2. Prebuilt themes</h4>
<div class="paragraph">
<p>Available prebuilt themes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>deeppurple-amber.css</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/deeppurple-amber.png" alt="deeppurple-amber theme" width="600 link="images/angular/angular-theming/deeppurple-amber.png"">
</div>
<div class="title">Figure 21. deeppurple-amber theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p>indigo-pink.css</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/indigo-pink.png" alt="indigo-pink theme" width="600 link="images/angular/angular-theming/indigo-pink.png"">
</div>
<div class="title">Figure 22. indigo-pink theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p>pink-bluegrey.css</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/pink-bluegrey.png" alt="pink-bluegrey theme" width="600 link="images/angular/angular-theming/pink-bluegrey.png"">
</div>
<div class="title">Figure 23. ink-bluegrey theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p>purple-green.css</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/purple-green.png" alt="purple-green theme" width="600 link="images/angular/angular-theming/purple-green.png"">
</div>
<div class="title">Figure 24. purple-green theme.</div>
</div>
<div class="paragraph">
<p>The prebuilt themes can be added using <strong>@import</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">@import '@angular/material/prebuilt-themes/deeppurple-amber.css';</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-theming.asciidoc_custom-themes">1.5.3. Custom themes</h4>
<div class="paragraph">
<p>Somethimes prebuild themes do not meet the needs of a project, because color schemas are too specific or do not incorporate branding colors, in those situations custom themes can be built to offer a better solution to the client.</p>
</div>
<div class="paragraph">
<p>For this topic, we are going to use a basic layout project that can be found in <a href="https://github.com/devonfw/devon4ng/tree/master/samples/AngularMaterialBasicLayout">devon4ng repository</a>.</p>
</div>
<div class="sect4">
<h5 id="guide-angular-theming.asciidoc_basics">Basics</h5>
<div class="paragraph">
<p>Before starting writing custom themes, there are some necessary things that have to be mentioned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a default theme: The project mentioned before has just one global scss stylesheet <strong>styles.scss</strong> that includes indigo-pink.scss which will be the default theme.</p>
</li>
<li>
<p>Add <em>@import '~@angular/material/theming';</em> at the begining of the every stylesheet to be able to use angular material prebuilt color palettes and functions.</p>
</li>
<li>
<p>Add <em>@include mat-core();</em> <strong>once</strong> per project, so if you are writing multiple themes in multiple files you could import those files from a 'central' one (for example styles.scss). This includes all common styles that are used by multiple components.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/theme-files-structure.png" alt="Theme files structure" width="600 link="images/angular/angular-theming/theme-files-structure.png"">
</div>
<div class="title">Figure 25. Theme files structure.</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-theming.asciidoc_basic-custom-theme">Basic custom theme</h5>
<div class="paragraph">
<p>To create a new custom theme, the .scss file containing it has to have imported the angular _theming.scss file (angular/material/theming) file and mat-core included. _theming.scss includes multiple color palettes and some functions that we are going to see below. The file for this basic theme is going to be named <strong>styles-custom-dark.scss</strong>.</p>
</div>
<div class="paragraph">
<p>First, declare new variables for primary, accent and warn palettes. Those variables are going to store the result of the function <strong>mat-palette</strong>.</p>
</div>
<div class="paragraph">
<p><strong>mat-palette</strong> accepts four arguments: base color palette, main, lighter and darker variants (See <a href="#id_palette_variants">[id_palette_variants]</a>) and returns a new palette including some additional map values: default, lighter and darker (<a href="#id_scss_map">[id_scss_map]</a>). Only the first argument is mandatory.</p>
</div>
<div class="listingblock">
<div class="title">Listing 20. File styles-custom-dark.scss.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">$custom-dark-theme-primary: mat-palette($mat-pink);
$custom-dark-theme-accent: mat-palette($mat-blue);
$custom-dark-theme-warn: mat-palette($mat-red);
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example we are using colors available in _theming.scss: mat-pink, mat-blue, mat-red. If you want to use a custom color you need to define a new map, for instance:</p>
</div>
<div class="listingblock">
<div class="title">Listing 21. File styles-custom-dark.scss custom pink.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">$my-pink: (
    50 : #fcf3f3,
    100 : #f9e0e0,
    200 : #f5cccc,
    300 : #f0b8b8,
    500 : #ea9999,
    900 : #db6b6b,
    A100 : #ffffff,
    A200 : #ffffff,
    A400 : #ffeaea,
    A700 : #ffd0d0,
    contrast: (
        50 : #000000,
        100 : #000000,
        200 : #000000,
        300 : #000000,
        900 : #000000,
        A100 : #000000,
        A200 : #000000,
        A400 : #000000,
        A700 : #000000,
    )
);

$custom-dark-theme-primary: mat-palette($my-pink);
...</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Some pages allows to create these palettes easily, for instance: <a href="http://mcg.mbitson.com" class="bare">http://mcg.mbitson.com</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Until now, we just have defined primary, accent and warn palettes but what about foreground and background? Angular material has two functions to change both:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mat-light-theme</strong>: Receives as arguments primary, accent and warn palettes and return a theme whose foreground is basically black (texts, icons, &#8230;&#8203;), the background is white and the other palettes are the received ones.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/custom-light.png" alt="deeppurple-amber theme" width="600 link="images/angular/angular-theming/custom-light.png"">
</div>
<div class="title">Figure 26. Custom light theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mat-dark-theme</strong>: Similar to mat-light-theme but returns a theme whose foreground is basically white and background black.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-theming/custom-dark.png" alt="deeppurple-amber theme" width="600 link="images/angular/angular-theming/custom-dark.png"">
</div>
<div class="title">Figure 27. Custom dark theme.</div>
</div>
<div class="paragraph">
<p>For this example we are going to use mat-dark-theme and save its result in $custom-dark-theme.</p>
</div>
<div class="listingblock">
<div class="title">Listing 22. File styles-custom-dark.scss updated with mat-dark-theme.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...

$custom-dark-theme: mat-dark-theme(
  $custom-dark-theme-primary,
  $custom-dark-theme-accent,
  $custom-dark-theme-warn
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To apply the saved theme, we have to go to <strong>styles.scss</strong> and import our <strong>styles-custom-dark.scss</strong> and include a function called <strong>angular-material-theme</strong> using the theme variable as argument.</p>
</div>
<div class="listingblock">
<div class="title">Listing 23. File styles.scss.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...
@import 'styles-custom-dark.scss';
@include angular-material-theme($custom-dark-theme);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we have multiple themes it is necessary to add the include statement inside a css class and use it in <strong>src/index.html &#8594; app-root component</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 24. File styles.scss updated with custom-dark-theme class.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...
@import 'styles-custom-dark.scss';

.custom-dark-theme {
  @include angular-material-theme($custom-dark-theme);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 25. File src/index.html.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
&lt;app-root class="custom-dark-theme"&gt;&lt;/app-root&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will apply <strong>$custom-dark-theme</strong> theme for the entire application.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-theming.asciidoc_full-custom-theme">Full custom theme</h5>
<div class="paragraph">
<p>Sometimes it is needed to custom different elementsw from background and foreground, in those situations we have to create a new function similar to <em>mat-light-theme</em> and <em>mat-dark-theme</em>. Let&#8217;s focus con mat-light-theme:</p>
</div>
<div id="guide-angular-theming.asciidoc_source-mat-light" class="listingblock">
<div class="title">Listing 26. Source code of mat-light-theme</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">@function mat-light-theme($primary, $accent, $warn: mat-palette($mat-red)) {
  @return (
    primary: $primary,
    accent: $accent,
    warn: $warn,
    is-dark: false,
    foreground: $mat-light-theme-foreground,
    background: $mat-light-theme-background,
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As we can se, <em>mat-light-theme</em> takes three arguments and returs a map including them as primary, accent and warn color; but there are three more keys in that map: is-dark, foreground and background.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>is-dark</strong>: Boolean true if it is a dark theme, false otherwise.</p>
</li>
<li>
<p><strong>background</strong>: Map that stores the color for multiple background elements.</p>
</li>
<li>
<p><strong>foreground</strong>: Map that stores the color for multiple foreground elements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To show which elements can be colored lets create a new theme in a file <strong>styles-custom-cap.scss</strong>:</p>
</div>
<div class="listingblock">
<div class="title">Listing 27. File styles-custom-cap.scss: Background and foreground variables.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">@import '~@angular/material/theming';

// custom background and foreground palettes
$my-cap-theme-background: (
  status-bar: #0070ad,
  app-bar: map_get($mat-blue, 900),
  background: #12abdb,
  hover: rgba(white, 0.04),
  card: map_get($mat-red, 800),
  dialog: map_get($mat-grey, 800),
  disabled-button: $white-12-opacity,
  raised-button: map-get($mat-grey, 800),
  focused-button: $white-6-opacity,
  selected-button: map_get($mat-grey, 900),
  selected-disabled-button: map_get($mat-grey, 800),
  disabled-button-toggle: black,
  unselected-chip: map_get($mat-grey, 700),
  disabled-list-option: black,
);

$my-cap-theme-foreground: (
  base: yellow,
  divider: $white-12-opacity,
  dividers: $white-12-opacity,
  disabled: rgba(white, 0.3),
  disabled-button: rgba(white, 0.3),
  disabled-text: rgba(white, 0.3),
  hint-text: rgba(white, 0.3),
  secondary-text: rgba(white, 0.7),
  icon: white,
  icons: white,
  text: white,
  slider-min: white,
  slider-off: rgba(white, 0.3),
  slider-off-active: rgba(white, 0.3),
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Function which uses the variables defined before to create a new theme:</p>
</div>
<div class="listingblock">
<div class="title">Listing 28. File styles-custom-cap.scss: Creating a new theme function.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">// instead of creating a theme with mat-light-theme or mat-dark-theme,
// we will create our own theme-creating function that lets us apply our own foreground and background palettes.
@function create-my-cap-theme($primary, $accent, $warn: mat-palette($mat-red)) {
  @return (
    primary: $primary,
    accent: $accent,
    warn: $warn,
    is-dark: false,
    foreground: $my-cap-theme-foreground,
    background: $my-cap-theme-background
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calling the new function and storing its value in <strong>$custom-cap-theme</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 29. File styles-custom-cap.scss: Storing the new theme.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">// We use create-my-cap-theme instead of mat-light-theme or mat-dark-theme
$custom-cap-theme-primary: mat-palette($mat-green);
$custom-cap-theme-accent: mat-palette($mat-blue);
$custom-cap-theme-warn: mat-palette($mat-red);

$custom-cap-theme: create-my-cap-theme(
  $custom-cap-theme-primary,
  $custom-cap-theme-accent,
  $custom-cap-theme-warn
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>After defining our new theme, we can import it from styles.scss.</p>
</div>
<div class="listingblock">
<div class="title">Listing 30. File styles.scss updated with custom-cap-theme class.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...
@import 'styles-custom-cap.scss';
.custom-cap-theme {
  @include angular-material-theme($custom-cap-theme);
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-theming.asciidoc_multiple-themes-and-overlay-based-components">Multiple themes and overlay-based components</h5>
<div class="paragraph">
<p>Certain components (e.g. menu, select, dialog, etc.) that are inside of a global overlay container,require an additional step to be affected by the theme&#8217;s css class selector.</p>
</div>
<div class="listingblock">
<div class="title">Listing 31. File app.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import {OverlayContainer} from '@angular/cdk/overlay';

@NgModule({
  // ...
})
export class AppModule {
  constructor(overlayContainer: OverlayContainer) {
    overlayContainer.getContainerElement().classList.add('custom-cap-theme');
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-theming.asciidoc_useful-resources">1.5.4. Useful resources</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://material.angular.io/guide/theming">Angular Material&#8217;s oficial theming guide</a></p>
</li>
<li>
<p><a href="https://material.io/design/color/#color-theme-creation">Material Desing: Color theme creation</a></p>
</li>
<li>
<p><a href="http://mcg.mbitson.com">Palette generator</a></p>
</li>
<li>
<p><a href="https://sass-lang.com/guide">SCSS tutorial</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="guide-angular-pwa.asciidoc">1.6. Angular Progressive Web App</h3>
<div class="paragraph">
<p>Progresive web applications (PWAs) are web application that offer better user experience than the traditional ones. In general, they solve problems related with reliability and speed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Reliability</em>:  PWAs are stable. In this context stability means than even with slow connections or even with no network at all, the application still works. To achieve this, some basic resources like styles, fonts, requests, &#8230;&#8203; are stored; due to this caching, it is not possible to assure that the content is always up-to-date.</p>
</li>
<li>
<p><em>Speed</em>: When an users opens an application, he or she will expect it to load almost inmediately (almost 53% of users abandon sites that take longer that 3 seconds, source: <a href="https://developers.google.com/web/progressive-web-apps/#fast" class="bare">https://developers.google.com/web/progressive-web-apps/#fast</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>PWAs uses a script called <a href="https://developers.google.com/web/fundamentals/primers/service-workers/">service worker</a>, which runs in background and essentially act as proxy between web app and network, intercepting requests and acting depending on the network conditions.</p>
</div>
<div class="sect3">
<h4 id="guide-angular-pwa.asciidoc_assumptions">1.6.1. Assumptions</h4>
<div class="paragraph">
<p>This guide assumes that you already have installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Node.js</p>
</li>
<li>
<p>npm package manager</p>
</li>
<li>
<p>Angular CLI</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="guide-angular-pwa.asciidoc_sample-application">1.6.2. Sample Application</h4>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-pwa/mts-pwa-rec.png" alt="My thai star recommendation" width="800 link="images/angular/angular-pwa/mts-pwa-rec.png"">
</div>
<div class="title">Figure 28. Basic angular PWA.</div>
</div>
<div class="paragraph">
<p>To explain how to build PWAs using angular, a basic application is going to be built. This app will be able to ask for resources and save in the cache in order to work even offline.</p>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-1-create-a-new-project">Step 1: Create a new project</h5>
<div class="paragraph">
<p>This step can be completed with one simple command: <code>ng new &lt;name&gt;</code>, where &lt;names&gt; is the name for the app. In this case, the app is going to be named <strong>basic-ng-pwa</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-2-create-a-service">Step 2: Create a service</h5>
<div class="paragraph">
<p>Web applications usually uses external resources, making necessary the addition of services which can get those resources. This application gets a dish from My Thai Star&#8217;s back-end and shows it. To do so, a new service is going to be created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>go to project folder: <code>cd basic-ng-pwa</code></p>
</li>
<li>
<p>run <code>ng generate service data</code></p>
</li>
<li>
<p>Modify <strong>data.service.ts</strong>, <strong>environment.ts</strong>, <strong>environment.prod.ts</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To retrieve data with this service, you have to import the module HttpClient and add it to the service&#8217;s contructor. Once added, use it to create a function <strong>getDishes()</strong> that sends http request to My Thai Start&#8217;s back-end. The URL of the back-end can be stored as an environment variable <strong>MY_THAI_STAR_DISH</strong>.</p>
</div>
<div class="paragraph">
<p><strong>data.service.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  import { HttpClient } from '@angular/common/http';
  import { MY_THAI_STAR_DISH } from '../environments/environment';
  ...

  export class DataService {
    constructor(private http: HttpClient) {}

    /* Get data from Back-end */
    getDishes() {
      return this.http.get(MY_THAI_STAR_DISH);
    }
    ...
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>environments.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  export const MY_THAI_STAR_DISH =
  'http://de-mucdevondepl01:8090/api/services/rest/dishmanagement/v1/dish/1';
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>environments.prod.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  export const MY_THAI_STAR_DISH =
  'http://de-mucdevondepl01:8090/api/services/rest/dishmanagement/v1/dish/1';
  ...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-3-use-the-service">Step 3: Use the service</h5>
<div class="paragraph">
<p>The component AppComponent implements the interface OnInit and inside its method ngOnInit() the suscription to the services is done. When a dish arrives, it is saved and shown (app.component.html).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  import { DataService } from './data.service';
  export class AppComponent implements OnInit {
  dish: { name: string; description: string } = { name: '', description: ''};

  ...
  ngOnInit() {
    this.data
      .getDishes()
      .subscribe(
        (dishToday: { dish: { name: string; description: string } }) =&gt; {
          this.dish = {
            name: dishToday.dish.name,
            description: dishToday.dish.description,
          };
        },
      );
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-4-structures">Step 4: Structures, styles and updates</h5>
<div class="paragraph">
<p>This step shows code interesting inside the sample app. The complete content can be found in <a href="https://github.com/devonfw/devon4ng/tree/master/samples/AngularBasicPWA">devon4ng samples</a>.</p>
</div>
<div class="paragraph">
<p><strong>index.html</strong></p>
</div>
<div class="paragraph">
<p>To use the Montserrat font add the following link inside the tag header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">  &lt;link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>styles.scss</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">  body {
    ...
    font-family: 'Montserrat', sans-serif;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>app.component.ts</strong></p>
</div>
<div class="paragraph">
<p>This file is also used to reload the app if there are any changes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>SwUpdate</em>: This object comes inside the @angular/pwa package and it is used to detect changes and reload the page if needed.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  import { SwUpdate } from '@angular/service-worker';

  export class AppComponent implements OnInit {

  ...
    constructor(updates: SwUpdate, private data: DataService) {
      updates.available.subscribe((event) =&gt; {
        updates.activateUpdate().then(() =&gt; document.location.reload());
      });
    }
    ...
  }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-5-make-it-progressive.">Step 5: Make it Progressive.</h5>
<div class="paragraph">
<p>Turining an angular app into a PWA is pretty easy, just one module has to be added. To do so, run: <code>ng add @angular/pwa</code>. This command also adds two important files, explained below.</p>
</div>
<div class="paragraph">
<p>&#160;<br>
&#160;<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>manifest.json</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>manifest.json is a file that allows to control how the app is displayed in places where native apps are displayed.</p>
</div>
<div class="paragraph">
<p><strong>Fields</strong></p>
</div>
<div class="paragraph">
<p><em>name</em>: Name of the web application.</p>
</div>
<div class="paragraph">
<p><em>short_name</em>: Short version of name.</p>
</div>
<div class="paragraph">
<p><em>theme_color</em>: Default theme color for an application context.</p>
</div>
<div class="paragraph">
<p><em>background_color</em>: Expected background color of the web application.</p>
</div>
<div class="paragraph">
<p><em>display</em>: Preferred display mode.</p>
</div>
<div class="paragraph">
<p><em>scope</em>: Navigation scope of tghis web application&#8217;s application context.</p>
</div>
<div class="paragraph">
<p><em>start_url</em>: URL loaded when the user launches the web application.</p>
</div>
<div class="paragraph">
<p><em>icons</em>: Array of icons that serve as representations of the web app.</p>
</div>
<div class="paragraph">
<p>Additional information can be found <a href="https://developers.google.com/web/fundamentals/web-app-manifest/">here</a>.</p>
</div>
<div class="paragraph">
<p>&#160;<br>
&#160;<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ngsw-config.json</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>nsgw-config.json specifies which files and data URLs have to be cached and updated by the Angular service worker.</p>
</div>
<div class="paragraph">
<p><strong>Fields</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>index</em>: File that serves as index page to satisfy navigation requests.</p>
</li>
<li>
<p><em>assetGroups</em>: Resources that are part of the app version that update along with the app.</p>
<div class="ulist">
<ul>
<li>
<p><em>name</em>: Identifies the group.</p>
</li>
<li>
<p><em>installMode</em>: How the resources are cached (prefetch or lazy).</p>
</li>
<li>
<p><em>updateMode</em>: Caching behaviour when a new version of the app is found (prefetch or lazy).</p>
</li>
<li>
<p><em>resources</em>: Resources to cache. There are three groups.</p>
<div class="ulist">
<ul>
<li>
<p><em>files</em>: Lists patterns that match files in the distribution directory.</p>
</li>
<li>
<p><em>urls</em>:  URL patterns matched at runtime.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>dataGroups</em>: UsefulIdentifies the group. for API requests.</p>
<div class="ulist">
<ul>
<li>
<p><em>name</em>: Identifies the group.</p>
</li>
<li>
<p><em>urls</em>: URL patterns matched at runtime.</p>
</li>
<li>
<p><em>version</em>:  Indicates that the resources being cached have been updated in a backwards-incompatible way.</p>
</li>
<li>
<p><em>cacheConfig</em>: Policy by which matching requests will be cached</p>
<div class="ulist">
<ul>
<li>
<p><em>maxSize</em>: The maximum number of entries, or responses, in the cache.</p>
</li>
<li>
<p><em>maxAge</em>: How long responses are allowed to remain in the cache.</p>
<div class="ulist">
<ul>
<li>
<p>d: days. (5d = 5 days).</p>
</li>
<li>
<p>h: hours</p>
</li>
<li>
<p>m: minutes</p>
</li>
<li>
<p>s: seconds. (5m20s = 5 minutes and 20 seconds).</p>
</li>
<li>
<p>u: milliseconds</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>timeout</em>: How long the Angular service worker will wait for the network to respond before using a cached response. Same dataformat as maxAge.</p>
</li>
<li>
<p><em>strategy</em>: Caching strategies (performance or freshness).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>navigationUrls</em>: List of URLs that will be redirected to the index file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional information can be found <a href="https://angular.io/guide/service-worker-config">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-6-configure-the-app">Step 6: Configure the app</h5>
<div class="paragraph">
<p><strong>manifest.json</strong></p>
</div>
<div class="paragraph">
<p>Default configuration.</p>
</div>
<div class="paragraph">
<p>&#160;<br>
&#160;<br>
<strong>ngsw-config.json</strong></p>
</div>
<div class="paragraph">
<p>At <em>assetGroups &#8594; resources &#8594; urls</em>: In this field the google fonts api is added in order to use Montserrat font even without network.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  "urls": [
          "https://fonts.googleapis.com/**"
        ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>At the root of the json: A data group to cache API calls.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  {
    ...
    "dataGroups": [{
      "name": "mythaistar-dishes",
      "urls": [
        "http://de-mucdevondepl01:8090/api/services/rest/dishmanagement/v1/dish/1"
      ],
      "cacheConfig": {
        "maxSize": 100,
        "maxAge": "1h",
        "timeout": "10s",
        "strategy": "freshness"
      }
    }]
  }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-angular-pwa.asciidoc_step-7-check-that-your-app-is-a-pwa">Step 7: Check that your app is a PWA</h5>
<div class="paragraph">
<p>To check if an app is a PWA lets compare its normal behaviour against itself but built for production. Run in the project&#8217;s root folder the commands below:</p>
</div>
<div class="paragraph">
<p><code>ng build --prod</code> to build the app using production settings.</p>
</div>
<div class="paragraph">
<p><code>npm install http-server</code> to install an npm module that can serve your built application. Documentation <a href="https://www.npmjs.com/package/http-server">here</a>.</p>
</div>
<div class="paragraph">
<p>Go to the dist/basic-ng-pwa/ folder running <code>cd dist/basic-ng-pwa</code>.</p>
</div>
<div class="paragraph">
<p><code>http-server -o</code> to serve your built app.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-pwa/http-serve.png" alt="Http server running" width="600 link="images/angular/angular-pwa/http-serve.png"">
</div>
<div class="title">Figure 29. Http server running on localhost:8081.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>In another console instance run <code>ng serve</code> to open the common app (not built).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-pwa/ng-serve.png" alt=".Angular server running" width="600 link="images/angular/angular-pwa/ng-serve.png"">
</div>
<div class="title">Figure 30. Angular server running on localhost:4200.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>The first difference can be found on <em>Developer tools &#8594; application</em>, here it is seen that the PWA application (left) has a service worker and the common (right) one does not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-pwa/pwa-nopwa-app-ng.png" alt="Application comparison" width="800 link="images/angular/angular-pwa/pwa-nopwa-app-ng.png"">
</div>
<div class="title">Figure 31. Application service worker comparison.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>If the "offline" box is checked, it will force a disconnection from network. In situations where users do not have connectivity or have a slow, one the PWA can still be accesed and used.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-pwa/online-offline-ng.png" alt="Online offline apps" width="800 link="images/angular/angular-pwa/online-offline-ng.png"">
</div>
<div class="title">Figure 32. Offline application.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>Finally, browser extensions like <a href="https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk">Lighthouse</a> can be used to test whether an application is progressive or not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/angular/angular-pwa/lighthouse-ng.png" alt="Lighthouse report" width="800 link="images/angular/angular-pwa/lighthouse-ng.png"">
</div>
<div class="title">Figure 33. Lighthouse report.</div>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-app-initializer.asciidoc">1.7. APP_INITIALIZER</h3>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_what-is-the-app_initializer-pattern">1.7.1. What is the APP_INITIALIZER pattern</h4>
<div class="paragraph">
<p>The APP_INITIALIZER pattern allows an aplication to choose which configuration is going to be used in the start of the application, this is useful because it allows to setup different configurations, for example, for docker or a remote configuration. This provides benefits since this is done on <code>runtime</code>, so theres no need to recompile the whole application to switch from configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_what-is-app_initializer">1.7.2. What is APP_INITIALIZER</h4>
<div class="paragraph">
<p>APP_INITIALIZER allows to provide a service in the initialization of the application in a <code>@NgModule</code>. It also allows to use a factory, allowing to create a singleton in the same service. An example can be found in MyThaiStar <code>/core/config/config.module.ts</code>:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The provider expects the return of a <code>Promise</code>, if it is using Observables, a change with the method <code>toPromise()</code> will allow a switch from <code>Observable</code> to <code>Promise</code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { NgModule, APP_INITIALIZER } from '@angular/core';
import { HttpClientModule } from '@angular/common/http';

import { ConfigService } from './config.service';

@NgModule({
  imports: [HttpClientModule],
  providers: [
    ConfigService,
    {
      provide: APP_INITIALIZER,
      useFactory: ConfigService.factory,
      deps: [ConfigService],
      multi: true,
    },
  ],
})
export class ConfigModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is going to allow the creation of a <code>ConfigService</code> where, using a singleton, the service is going to load an external config depending on a route. This dependence with a route, allows to setup diferent configuration for docker etc. This is seen in the <code>ConfigService</code> of MyThaiStar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Config, config } from './config';

@Injectable()
export class ConfigService {
  constructor(private httpClient: HttpClient) {}

  static factory(appLoadService: ConfigService) {
    return () =&gt; appLoadService.loadExternalConfig();
  }

  // this method gets external configuration calling /config endpoint
  //and merges into config object
  loadExternalConfig(): Promise&lt;any&gt; {
    if (!environment.loadExternalConfig) {
      return Promise.resolve({});
    }

    const promise = this.httpClient
      .get('/config')
      .toPromise()
      .then((settings) =&gt; {
        Object.keys(settings || {}).forEach((k) =&gt; {
          config[k] = settings[k];
        });
        return settings;
      })
      .catch((error) =&gt; {
        return 'ok, no external configuration';
      });

    return promise;
  }

  getValues(): Config {
    return config;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As it is mentioned earlier, you can see the use of a factory to create a singleton at the start. After that, <code>loadExternalConfig</code> is going to look for a boolean inside the corresponding environment file inside the path <code>src/environments/</code>, this boolean <code>loadExternalConfig</code> is going to easily allow to switch to a external config. If it is true, it generates a promise that overwrites the parameters of the local config, allowing to load the external config. Finally, the last method <code>getValues()</code> is going to allow to return the file config with the values (overwritten or not). The local <code>config</code> file from MyThaiStar can be seen here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">export enum BackendType {
  IN_MEMORY,
  REST,
  GRAPHQL,
}

interface Role {
  name: string;
  permission: number;
}

interface Lang {
  label: string;
  value: string;
}

export interface Config {
  version: string;
  backendType: BackendType;
  restPathRoot: string;
  restServiceRoot: string;
  pageSizes: number[];
  pageSizesDialog: number[];
  roles: Role[];
  langs: Lang[];
}

export const config: Config = {
  version: 'dev',
  backendType: BackendType.REST,
  restPathRoot: 'http://localhost:8081/mythaistar/',
  restServiceRoot: 'http://localhost:8081/mythaistar/services/rest/',
  pageSizes: [8, 16, 24],
  pageSizesDialog: [4, 8, 12],
  roles: [
    { name: 'CUSTOMER', permission: 0 },
    { name: 'WAITER', permission: 1 },
  ],
  langs: [
    { label: 'English', value: 'en' },
    { label: 'Deutsch', value: 'de' },
    { label: 'Espaol', value: 'es' },
    { label: 'Catal', value: 'ca' },
    { label: 'Franais', value: 'fr' },
    { label: 'Nederlands', value: 'nl' },
    { label: '', value: 'hi' },
    { label: 'Polski', value: 'pl' },
    { label: '', value: 'ru' },
    { label: '', value: 'bg' },
  ],
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, inside a environment file <code>src/environments/environment.ts</code> the use of the boolean <code>loadExternalConfig</code> is seen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">// The file contents for the current environment will overwrite these during build.
// The build system defaults to the dev environment which uses `environment.ts`, but if you do
// `ng build --env=prod` then `environment.prod.ts` will be used instead.
// The list of which env maps to which file can be found in `.angular-cli.json`.

export const environment: {
  production: boolean;
  loadExternalConfig: boolean;
} = { production: false, loadExternalConfig: false };</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_creating-a-app_initializer-configuration">1.7.3. Creating a APP_INITIALIZER configuration</h4>
<div class="paragraph">
<p>This section is going to be used to create a new <code>APP_INITIALIZER</code> basic example. For this, a basic app with angular is going to be generated using <code>ng new "appname"</code> substituting <code>appname</code> for the name of the app choosed.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_setting-up-the-config-files">1.7.4. Setting up the config files</h4>
<div class="sect4">
<h5 id="guide-app-initializer.asciidoc_docker-external-configuration-optional">Docker external configuration (Optional)</h5>
<div class="paragraph">
<p>This section is only done if theres a docker configuration in the app you are setting up this type of configuration.</p>
</div>
<div class="paragraph">
<p>1.- Create in the root folder <code>/docker-external-config.json</code>. This external config is going to be used when the application is loaded with docker (if the boolean to load the external configuration is set to true). Here you need to add all the config parameter you want to load with docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "version": "docker-version"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>2.- In the root, in the file <code>/Dockerfile</code> angular is going to copy the <code>docker-external-config.json</code> that was created before into the nginx html route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>....
COPY docker-external-config.json /usr/share/nginx/html/docker-external-config.json
....</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-app-initializer.asciidoc_external-json-configuration">External json configuration</h5>
<div class="paragraph">
<p>1.- Create a json file in the route <code>/src/external-config.json</code>. This external config is going to be used when the application is loaded with the start script (if the boolean to load the external configuration is set to true). Here you need to add all the config parameter you want to load:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "version": "external-config"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>2.- The file named <code>/angular.json</code> located at the root is going to be modified to add the file <code>external-config.json</code> that was just created to both <code>"assets"</code> inside <code>Build</code> and <code>Test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">	....
	"build": {
          ....
            "assets": [
              "src/assets",
              "src/data",
              "src/favicon.ico",
              "src/manifest.json",
              "src/external-config.json"
            ]
	        ....
        "test": {
	  ....
	   "assets": [
              "src/assets",
              "src/data",
              "src/favicon.ico",
              "src/manifest.json",
              "src/external-config.json"
            ]
	  ....</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_setting-up-the-proxies">1.7.5. Setting up the proxies</h4>
<div class="paragraph">
<p>This step is going to setup two proxies. This is going to allow to load the config desired by the context, in case that it is using docker to load the app or in case it loads the app with angular. Loading diferent files is made posible by the fact that the <code>ConfigService</code> method <code>loadExternalConfig()</code> looks for the path <code>/config</code>.</p>
</div>
<div class="sect4">
<h5 id="guide-app-initializer.asciidoc_docker-optional">Docker (Optional)</h5>
<div class="paragraph">
<p>1.- This step is going to be for docker. Add <code>docker-external-config.json</code> to nginx configuration (<code>/nginx.conf</code>) that is in the root of the application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>....
  location  ~ ^/config {
        alias /usr/share/nginx/html/docker-external-config.json;
  }
....</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-app-initializer.asciidoc_external-configuration">External Configuration</h5>
<div class="paragraph">
<p>1.- Now the file <code>/proxy.conf.json</code>, needs to be created/modified this file can be found in the root of the application. In this file you can add the route of the external configuration in <code>target</code> and the name of the file in <code>^/config:</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">....
  "/config": {
    "target": "http://localhost:4200",
    "secure": false,
    "pathRewrite": {
      "^/config": "/external-config.json"
    }
  }
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>2.- The file <code>package.json</code> found in the root of the application is gonna use the start script to load the proxy config that was just created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "scripts": {
....
    "start": "ng serve --proxy-config proxy.conf.json -o",
....</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_adding-the-loadexternalconfig-boolean-to-the-environments">1.7.6. Adding the loadExternalConfig boolean to the environments</h4>
<div class="paragraph">
<p>In order to load an external config we need to add the loadExternalConfig boolean to the environments. To do so, inside the folder <code>environments/</code> the files are going to get modified adding this boolean to each environment that is going to be used. In this case, only two environments are going to be modified (<code>environment.ts</code> and <code>environment.prod.ts</code>). Down below theres an example of the modification being done in the <code>environment.prod.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">export const environment: {
  production: boolean;
  loadExternalConfig: boolean;
} = { production: false, loadExternalConfig: false };</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the file in first instance theres the declaration of the types of the variables. After that, theres the definition of those variables. This variable <code>loadExternalConfig</code> is going to be used by the service, allowing to setup a external config just by switching the <code>loadExternalConfig</code> to true.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-app-initializer.asciidoc_creating-core-configuration-service">1.7.7. Creating core configuration service</h4>
<div class="paragraph">
<p>In order to create the whole configuration module three are going to be created:</p>
</div>
<div class="paragraph">
<p>1.- Create in the core <code>app/core/config/</code> a <code>config.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">  export interface Config {
    version: string;
  }

  export const config: Config = {
    version: 'dev'
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Taking a look to this file, it creates a interface (<code>Config</code>) that is going to be used by the variable that exports (<code>export const config: Config</code>). This variable <code>config</code> is going to be used by the service that is going to be created.</p>
</div>
<div class="paragraph">
<p>2.- Create in the core <code>app/core/config/</code> a <code>config.service.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Config, config } from './config';

@Injectable()
export class ConfigService {
  constructor(private httpClient: HttpClient) {}

  static factory(appLoadService: ConfigService) {
    return () =&gt; appLoadService.loadExternalConfig();
  }

  // this method gets external configuration calling /config endpoint
  // and merges into config object
  loadExternalConfig(): Promise&lt;any&gt; {
    if (!environment.loadExternalConfig) {
      return Promise.resolve({});
    }

    const promise = this.httpClient
      .get('/config')
      .toPromise()
      .then((settings) =&gt; {
        Object.keys(settings || {}).forEach((k) =&gt; {
          config[k] = settings[k];
        });
        return settings;
      })
      .catch((error) =&gt; {
        return 'ok, no external configuration';
      });

    return promise;
  }

  getValues(): Config {
    return config;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As it was explained in previous steps, at first, there is a factory that uses the method <code>loadExternalConfig()</code>, this factory is going to be used in later steps in the module. After that, the <code>loadExternalConfig()</code> method checks if the boolean in the environment is false. If it is false it will return the promise resolved with the normal config. Else, it is going to load the external config in the path (<code>/config</code>), and overwrite the values from the external config to the config thats going to be used by the app, this is all returned in a promise.</p>
</div>
<div class="paragraph">
<p>3.- Create in the core a module for the config <code>app/core/config/</code> a <code>config.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { NgModule, APP_INITIALIZER } from '@angular/core';
import { HttpClientModule } from '@angular/common/http';

import { ConfigService } from './config.service';

@NgModule({
  imports: [HttpClientModule],
  providers: [
    ConfigService,
    {
      provide: APP_INITIALIZER,
      useFactory: ConfigService.factory,
      deps: [ConfigService],
      multi: true,
    },
  ],
})
export class ConfigModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As seen earlier, the <code>ConfigService</code> is added to the module. In this addition, the app is initialized(<code>provide</code>) and it uses the factory that was created in the <code>ConfigService</code> loading the config with or without the external values depending on the boolean in the <code>config</code>.</p>
</div>
<div class="sect4">
<h5 id="guide-app-initializer.asciidoc_using-the-config-service">Using the Config Service</h5>
<div class="paragraph">
<p>As a first step, in the file <code>/app/app.module.ts</code> the <code>ConfigModule</code> created earlier in the other step is going to be imported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">  imports: [
    ....
    ConfigModule,
    ....
  ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that, the <code>ConfigService</code> is going to be injected into the <code>app.component.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">....
import { ConfigService } from './core/config/config.service';
....
export class AppComponent {
....
  constructor(public configService: ConfigService) { }
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, for this demonstration app, the component <code>app/app.component.html</code> is going to show the version of the config it is using at that moment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;div style="text-align:center"&gt;
  &lt;h1&gt;
    Welcome to {{ title }}!
  &lt;/h1&gt;
&lt;/div&gt;
&lt;h2&gt;Here is the configuration version that is using angular right now: {{configService.getValues().version}}&lt;/h2&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-app-initializer.asciidoc_final-steps">Final steps</h5>
<div class="paragraph">
<p>The script <code>start</code> that was created earlier in the <code>package.json</code> (<code>npm start</code>) is going to be used to start the application. After that, modifying the boolean <code>loadExternalConfig</code> inside the corresponding environment file inside <code>/app/environments/</code> should show the different config versions.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/loadExternalConfigFalse.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/app-initializer/loadExternalConfigFalse.png" alt="loadExternalConfigFalse"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/loadExternalConfigTrue.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/app-initializer/loadExternalConfigTrue.png" alt="loadExternalConfigTrue"></a>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-component-decomposition.asciidoc">1.8. Component Decomposition</h3>
<div class="paragraph">
<p>When implementing a new requirement there are a few design decisions, which need to be considered.
A decomposition in <em>Smart</em> and <em>Dumb Components</em> should be done first.
This includes the definition of state and responsibilities.
Implementing a new dialog will most likely be done by defining a new <em>Smart Component</em> with multiple <em>Dumb Component</em> children.</p>
</div>
<div class="paragraph">
<p>In the component tree this would translate to the definition of a new subtree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-tree-highlighted-subtree.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/component-tree-highlighted-subtree.svg" alt="Component Tree With Highlighted Sub Tree" width="450"></a>
</div>
<div class="title">Figure 34. Component Tree with highlighted subtree</div>
</div>
<div class="sect3">
<h4 id="guide-component-decomposition.asciidoc_defining-components">1.8.1. Defining Components</h4>
<div class="paragraph">
<p>The following gives an example for component decomposition.
Shown is a screenshot from a styleguide to be implemented.
It is a widget called <code>Listpicker</code>.</p>
</div>
<div class="paragraph">
<p>The basic function is an <code>input</code> field accepting direct input.
So typing <code>otto</code> puts <code>otto</code> inside the <code>FormControl</code>.
With arrow down key or by clicking the icon displayed in the inputs right edge a dropdown is opened.
Inside possible values can be selected and filtered beforehand.
After pressing arrow down key the focus should move into the filter input field.
Up and down arrow keys can be used to select an element from the list.
Typing into the filter input field filters the list from which the elements can be selected.
The current selected element is highlighted with green background color.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-1.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/component-decomposition-example-1.svg" alt="Component Decomposition Example 1v2" width="450"></a>
</div>
<div class="title">Figure 35. Component decomposition example before</div>
</div>
<div class="paragraph">
<p>What should be done, is to define small reusable <em>Dumb Components</em>.
This way the complexity becomes manageable.
In the example every colored box describes a component with the purple box being a <em>Smart Component</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-2.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/component-decomposition-example-2.svg" alt="Component Decomposition Example 2v2" width="450"></a>
</div>
<div class="title">Figure 36. Component decomposition example after</div>
</div>
<div class="paragraph">
<p>This leads to the following component tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-component-tree.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/component-decomposition-example-component-tree.svg" alt="Component Decomposition Example component tree" width="450"></a>
</div>
<div class="title">Figure 37. Component decomposition example component tree</div>
</div>
<div class="paragraph">
<p>Note the uppermost component is a <em>Dumb Component</em>.
It is a wrapper for the label and the component to be displayed inside a form.
The <em>Smart Component</em> is <code>Listpicker</code>.
This way the widget can be reused without a form needed.</p>
</div>
<div class="paragraph">
<p>A widgets is a typical <em>Smart Component</em> to be shared across feature modules.
So the <code>SharedModule</code> is the place for it to be defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-component-decomposition.asciidoc_defining-state">1.8.2. Defining state</h4>
<div class="paragraph">
<p>Every UI has state.
There are different kinds of state, for example</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View State: e.g. is a panel open, a css transition pending, etc.</p>
</li>
<li>
<p>Application State: e.g. is a payment pending, current URL, user info, etc.</p>
</li>
<li>
<p>Business Data: e.g. products loaded from backend</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is good practice to base the component decomposition on the state handled by a component and to define a simplified state model beforehand.
Starting with the parent - the <em>Smart Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What overall state does the dialog have: e.g. loading, error, valid data loaded, valid input, invalid input, etc.
Every defined value should correspond to an overall appearance of the whole dialog.</p>
</li>
<li>
<p>What events can occur to the dialog: e.g. submitting a form, changing a filter, pressing buttons, pressing keys, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For every <em>Dumb Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What data does a component display: e.g. a header text, user information to be displayed, a loading flag, etc.<br>
This will be a slice of the overall state of the parent <em>Smart Component</em>.
In general a <em>Dumb Component</em> presents a slice of its parent <em>Smart Components</em> state to the user.</p>
</li>
<li>
<p>What events can occur: keyboard events, mouse events, etc.<br>
These events are all handled by its parent <em>Smart Component</em> - every event is passed up the tree to be handled by a <em>Smart Component</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These information should be reflected inside the modeled state.
The implementation is a TypeScript type - an interface or a class describing the model.</p>
</div>
<div class="paragraph">
<p>So there should be a type describing all state relevant for a <em>Smart Component</em>.
An instance of that type is send down the component tree at runtime.
Not every <em>Dumb Component</em> will need the whole state.
For instance a single <em>Dumb Component</em> could only need a single string.</p>
</div>
<div class="paragraph">
<p>The state model for the previous <code>Listpicker</code> example is shown in the following listing.</p>
</div>
<div class="listingblock">
<div class="title">Listing 32. Listpicker state model</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ListpickerState {

  items: {}[]|undefined;
  columns = ['key', 'value'];
  keyColumn = 'key';
  displayValueColumn = 'value';
  filteredItems: {}[]|undefined;
  filter = '';
  placeholder = '';
  caseSensitive = true;
  isDisabled = false;
  isDropdownOpen = false;
  selectedItem: {}|undefined;
  displayValue = '';

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Listpicker</code> holds an instance of <code>ListpickerState</code> which is passed down the component tree via <code>@Input()</code> bindings in the <em>Dumb Components</em>.
Events emitted by children - <em>Dumb Components</em> - create a new instance of <code>ListpickerState</code> based on the current instance and the event and its data.
So a state transition is just setting a new instance of <code>ListpickerState</code>.
Angular Bindings propagate the value down the tree after exchanging the state.</p>
</div>
<div class="listingblock">
<div class="title">Listing 33. Listpicker State transition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ListpickerComponent {

  // initial default values are set
  state = new ListpickerState();

  /** User changes filter */
  onFilterChange(filter: string): void {
    // apply filter ...
    const filteredList = this.filterService.filter(...);

    // important: A new instance is created, instead of altering the existing one.
    //            This makes change detection easier and prevents hard to find bugs.
    this.state = Object.assing({}, this.state, {
      filteredItems: filteredList,
      filter: filter
    });
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Note:</div>
<p>It is not always necessary to define the model as independent type.
So there would be no state property and just properties for every state defined directly in the component class.
When complexity grows and state becomes larger this is usually a good idea.
If the state should be shared between <em>Smart Components</em> a store is to be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-component-decomposition.asciidoc_when-are-dumb-components-needed">1.8.3. When are Dumb Components needed</h4>
<div class="paragraph">
<p>Sometimes it is not necessary to perform a full decomposition. The architecture does not enforce it generally. What you should keep in mind is, that there is always a point when it becomes recommendable.</p>
</div>
<div class="paragraph">
<p>For example a template with 800 loc is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>not understandable</p>
</li>
<li>
<p>not maintanable</p>
</li>
<li>
<p>not testable</p>
</li>
<li>
<p>not reusable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So when implementing a template with more than 50 loc you should think about decomposition.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="guide-consuming-rest-services.asciidoc">1.9. Consuming REST services</h3>
<div class="paragraph">
<p>A good introduction to working with Angular HttpClient can be found in <a href="https://angular.io/guide/http">Angular Docs</a></p>
</div>
<div class="paragraph">
<p>This guide will cover, how to embed Angular HttpClient in the application architecture.
For backend request a special service with the suffix <code>Adapter</code> needs to be defined.</p>
</div>
<div class="sect3">
<h4 id="guide-consuming-rest-services.asciidoc_defining-adapters">1.9.1. Defining Adapters</h4>
<div class="paragraph">
<p>It is a good practice to have a Angular service whose single responsibility is to call the backend and parse the received value to a transfer data model (e.g. Swagger generated TOs).
Those services need to have the suffix <code>Adapter</code> to make them easy to recognize.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/rest-adapter.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/rest-adapter.svg" alt="Adapters handle backend communication" width="450"></a>
</div>
<div class="title">Figure 38. Adapters handle backend communication</div>
</div>
<div class="paragraph">
<p>As illustrated in the figure a Use Case service does not use Angular HttpClient directly but uses an adapter.
A basic adapter could look like this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 34. Example adapter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs/Observable';

import { FlightTo } from './flight-to';

@Injectable()
export class FlightsAdapter {

  constructor(
    private httpClient: HttpClient
  ) {}

  getFlights(): Observable&lt;FlightTo&gt; {
    return this.httpClient.get&lt;FlightTo&gt;('/relative/url/to/flights');
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adapters should use a well-defined transfer data model.
This could be generated from server endpoints with CobiGen, Swagger, typescript-maven-plugin, etc.
If inside the application there is a business model defined, the adapter has to parse to the transfer model.
This is illustrated in the following listing.</p>
</div>
<div class="listingblock">
<div class="title">Listing 35. Example adapter mapping from business model to transfer model</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs/Observable';
import { map } from 'rxjs/operators';

import { FlightTo } from './flight-to';
import { Flight } from '../../../model/flight';

@Injectable()
export class FlightsAdapter {

  constructor(
    private httpClient: HttpClient
  ) {}

  updateFlight(flight: Flight): Observable&lt;Flight&gt; {
    const to = this.mapFlight(flight);

    return this.httpClient.post&lt;FlightTo&gt;('/relative/url/to/flights', to).pipe(
      map(to =&gt; this.mapFlightTo(to))
    );
  }

  private mapFlight(flight: Flight): FlightTo {
    // mapping logic
  }

  private mapFlightTo(flightTo: FlightTo): Flight {
    // mapping logic
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-consuming-rest-services.asciidoc_token-management">1.9.2. Token management</h4>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="guide-error-handler.asciidoc">1.10. Error Handler in angular</h3>
<div class="paragraph">
<p>Angular allows us to set up a custom error handler that can be used to control the different errors and them in a correct way. Using a global error handler will avoid mistakes and provide a use friendly interface allowing us to indicate the user what problem is happening.</p>
</div>
<div class="sect3">
<h4 id="guide-error-handler.asciidoc_what-is-errorhandler">1.10.1. What is ErrorHandler</h4>
<div class="paragraph">
<p><code>ErrorHandler</code> is the class that <code>Angular</code> uses by default to control the errors. This means that, even if the application doesnt have a <code>ErrorHandler</code> it is going to use the one setup by default in <code>Angular</code>. This can be tested by trying to find a page not existing in any app, instantly <code>Angular</code> will print the error in the console.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-error-handler.asciidoc_creating-your-custom-errorhandler-step-by-step">1.10.2. Creating your custom ErrorHandler step by step</h4>
<div class="paragraph">
<p>In order to create a custom <code>ErrorHandler</code> three steps are going to be needed:</p>
</div>
<div class="sect4">
<h5 id="guide-error-handler.asciidoc_creating-the-custom-errorhandler-class">Creating the custom ErrorHandler class</h5>
<div class="paragraph">
<p>In this first step the custom <code>ErrorHandler</code> class is going to be created inside the folder <code>/app/core/errors/errors-handler.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { ErrorHandler, Injectable, Injector } from '@angular/core';
import { HttpErrorResponse } from '@angular/common/http';

@Injectable()
export class ErrorsHandler implements ErrorHandler {

    constructor(private injector: Injector) {}

    handleError(error: Error | HttpErrorResponse) {
      //  To do: Use injector to get the necessary services to redirect or
      // show a message to the user
      const classname  = error.constructor.name;
      switch ( classname )  {
        case 'HttpErrorResponse':
          console.error('HttpError:' + error.message);
          if (!navigator.onLine) {
            console.error('Theres no internet connection');
            // To do: control here in internet what you wanna do if user has no internet
          } else {
            console.error('Server Error:' + error.message);
            // To do: control here if the server gave an error
          }
          break;
        default:
          console.error('Error:' + error.message);
          // To do: control here if the client/other things gave an error
      }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class can be used to control the different type of errors. If wanted, the <code>classname</code> variable could be used to add more switch cases. This would allow control of more specific situations.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-error-handler.asciidoc_creating-a-errorinterceptor">Creating a ErrorInterceptor</h5>
<div class="paragraph">
<p>Inside the same folder created in the last step we are going to create the <code>ErrorInterceptor</code>(<code>errors-handler-interceptor.ts</code>). This <code>ErrorInterceptor</code> is going to retry any failed calls to the server to make sure it is not being found before showing the error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';
import { retry } from 'rxjs/operators';

@Injectable()
export class ErrorsHandlerInterceptor implements HttpInterceptor {

    constructor() {}
    intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; {
        return next.handle(req).pipe(
            retryWhen((errors: Observable&lt;any&gt;) =&gt; errors.pipe(
                delay(500),
                take(5),
                concatMap((error: any, retryIndex: number) =&gt; {
                    if (++retryIndex === 5) {
                        throw error;
                    }
                    return of(error);
                })
            ))
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This custom made interceptor is implementing the <code>HttpInterceptor</code> and inside the method <code>intercept</code> using the method <code>pipe</code>,<code>retryWhen</code>,<code>delay</code>,<code>take</code> and <code>concatMap</code> from <a href="https://rxjs-dev.firebaseapp.com/api">RxJs</a> it is going to do the next things if there is errors:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>With <code>delay(500)</code> do a delay to allow some time in between requests</p>
</li>
<li>
<p>With <code>take(5)</code> retry five times.</p>
</li>
<li>
<p>With <code>concatMap</code> if the index that <code>take()</code> gives is not 5 it returns the error, else, it throws the error.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="guide-error-handler.asciidoc_creating-a-error-module">Creating a Error Module</h5>
<div class="paragraph">
<p>Finally, creating a module(<code>errors-handler.module.ts</code>) is necessary to include the <code>interceptor</code> and the custom error handler. In this case, the module is going to be created in the same folder as the last two:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { NgModule, ErrorHandler } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ErrorsHandler } from './errors-handler';
import { HTTP_INTERCEPTORS } from '@angular/common/http';
import { ErrorsHandlerInterceptor } from './errors-handler-interceptor';

@NgModule({
  declarations: [], // Declare here component if you want to use routing to error component
  imports: [
    CommonModule
  ],
  providers: [
    {
      provide: ErrorHandler,
      useClass: ErrorsHandler,
    },
    {
      provide: HTTP_INTERCEPTORS,
      useClass: ErrorsHandlerInterceptor,
      multi: true,
    }
  ]
})
export class ErrorsHandlerModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This module simply is providing the services that are implemented by our custom classes and then telling angular to use our custom made classes instead of the default ones. After doing this, the module has to be included in the app module <code>app.module.ts</code> in order to be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">....
  imports: [
    ErrorsHandlerModule,
    ....</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-error-handler.asciidoc_handling-errors">1.10.3. Handling Errors</h4>
<div class="paragraph">
<p>As a final step, handling these errors is necessary. Theres different ways that can be used to control the errors, here are a few:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating a custom page and using with <code>Router</code> to redirect to a page showing an error.</p>
</li>
<li>
<p>Creating a service in the server side or <code>Backend</code> to create a log with the error and calling it with <code>HttpClient</code>.</p>
</li>
<li>
<p>Showing a custom made <code>SnackBar</code> with the error message.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="guide-error-handler.asciidoc_using-snackbarservice-and-ngzone">Using <code>SnackBarService</code> and <code>NgZone</code></h6>
<div class="paragraph">
<p>If the <a href="https://material.angular.io/components/snack-bar/overview">SnackBar</a> is used directly, some errors can ocurr, this is due to <code>SnackBar</code> being out of the <code>Angular</code> zone. In order to use this service properly, <a href="https://angular.io/api/core/NgZone">NgZone</a> is necessary. The method <code>run()</code> from <code>NgZone</code> will allow the service to be inside the <code>Angular Zone</code>. An example on how to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { ErrorHandler, Injectable, Injector, NgZone } from '@angular/core';
import { HttpErrorResponse } from '@angular/common/http';
import { MatSnackBar } from '@angular/material';

@Injectable()
export class ErrorsHandler implements ErrorHandler {

    constructor(private injector: Injector, private zone: NgZone) {}

    handleError(error: Error | HttpErrorResponse) {
      // Use injector to get the necessary services to redirect or
      const snackBar: MatSnackBar = this.injector.get(MatSnackBar);
      const classname  = error.constructor.name;
      let message: string;
      switch ( classname )  {
        case 'HttpErrorResponse':
          message = !(navigator.onLine) ? 'There is no internet connection' : error.message;
          break;
        default:
          message = error.message;
      }
      this.zone.run(
        () =&gt; snackBar.open(message, 'danger', { duration : 4000})
      );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>Injector</code> the <code>MatSnackBar</code> is obtained, then the correct message is obtained inside the switch. Finally, using <code>NgZone</code> and <code>run()</code>, we open the <code>SnackBar</code> passing the message, and the paremeters wanted.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_ionic">2. Ionic</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="guide-ionic-getting-started.asciidoc">2.1. Ionic 4 Getting started</h3>
<div class="paragraph">
<p>Ionic is a front-end focused framework which offers different tools for developing hybrid mobile applications. The web technologies used for this purpose are CSS, Sass, HTML5 and Typescript.</p>
</div>
<div class="sect3">
<h4 id="guide-ionic-getting-started.asciidoc_why-ionic">2.1.1. Why Ionic?</h4>
<div class="paragraph">
<p>Ionic is used for developing hybrid applications, which means not having to rely on a specifyc IDE such as Android Studio or Xcode. Furthermore, development of native apps require learning different languages (Java/Kotlin for Android and Objective-C/Swift for Apple), with Ionic, a developer does not have to code the same functionality for multiple platforms, just use the adecuate libraries and components.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-ionic-getting-started.asciidoc_basic-environment-set-up">2.1.2. Basic environment set up</h4>
<div class="sect4">
<h5 id="guide-ionic-getting-started.asciidoc_install-ionic-cli">Install Ionic CLI</h5>
<div class="paragraph">
<p>Although the devonfw distribution comes with and already installed Ionic CLI, here are the steps to install it. The instalation of Ionic is easy, just one command has to be written:</p>
</div>
<div class="paragraph">
<p><code>npm install -g ionic</code></p>
</div>
</div>
<div class="sect4">
<h5 id="guide-ionic-getting-started.asciidoc_update-ionic-cli">Update Ionic CLI</h5>
<div class="paragraph">
<p>To update the installed version of the CLI run:</p>
</div>
<div class="paragraph">
<p><code>npm install -g ionic@latest</code></p>
</div>
<div class="paragraph">
<p>If the devonfw&#8217;s ionic CLI has to be updated, the steps are a little bit different:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>open the devonfw bundled console.</p>
</li>
<li>
<p><code>cd [devonfw_dist_folder]</code></p>
</li>
<li>
<p><code>cd software/nodejs</code></p>
</li>
<li>
<p><code>npm uninstall ionic --no-save</code></p>
</li>
<li>
<p><code>npm install ionic@latest --no-save</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-getting-started/update-ionic-cli.PNG"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-getting-started/update-ionic-cli.PNG" alt="devonfw&#8217;s Ionic CLI uptaded"></a>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="basic-proyect-set-up">2.2. Basic proyect set up</h3>
<div class="paragraph">
<p>The set up of an ionic application is pretty inmediate and can be done in one line:</p>
</div>
<div class="paragraph">
<p><code>ionic start &lt;name&gt; &lt;template&gt; --type=angular</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ionic start: Command to create an app.</p>
</li>
<li>
<p>&lt;name&gt;: Name of the application.</p>
</li>
<li>
<p>&lt;template&gt;: Model of the application.</p>
</li>
<li>
<p>--type=angular: With this flag, the app produced will be based on angular.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create an empty project, the following command can be used:</p>
</div>
<div class="paragraph">
<p><code>ionic start MyApp blank --type=angular</code></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-getting-started/ionic-blank-project.PNG"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-getting-started/ionic-blank-project.PNG" alt="Ionic blank project"></a>
</div>
</div>
<div class="paragraph">
<p>The image above shows the directory structure generated.</p>
</div>
<div class="paragraph">
<p>There are more templates available that can be seen with the command
<code>ionic start --list</code></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-getting-started/ionic-start-list.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-getting-started/ionic-start-list.png" alt="List of ionic templates"></a>
</div>
</div>
<div class="paragraph">
<p>The templates surrounded by red line are based on angular and comes with Ionic v4, while the others belong to earlier versions (before v4).</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="guide-ionic-from-code-to-android.asciidoc">2.3. Ionic 4 to android</h3>
<div class="paragraph">
<p>This page is written to help developers to go from the source code of an ionic application to an android one, with this in mind, topics such as: environment, commands, modifications,&#8230;&#8203;  are covered.</p>
</div>
<div class="sect3">
<h4 id="guide-ionic-from-code-to-android.asciidoc_assumptions">2.3.1. Assumptions</h4>
<div class="paragraph">
<p>This document assumes that the reader has already:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Source code of an ionic 4 application and wants to build it on an android device,</p>
</li>
<li>
<p>A working installation of Node.js</p>
</li>
<li>
<p>An Ionic CLI installed and up-to-date.</p>
</li>
<li>
<p>Android Studio and Android SDK.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="guide-ionic-from-code-to-android.asciidoc_from-ionic-4-to-android-project">2.3.2. From ionic 4 to Android project</h4>
<div class="paragraph">
<p>When a native application is being dessigned, sometimes, functionalities that uses camera, geolocation, push notification, &#8230;&#8203; are requested. To resolve these requests, Capacitor can be used.</p>
</div>
<div class="paragraph">
<p>In general terms, Capacitor wraps apps made with Ionic (HTML, SCSS, Typescript) into WebViews that can be displayed in native applications (Android, IOS) and allows the developer to access native functionalities like the ones said before.</p>
</div>
<div class="paragraph">
<p>Installing capacitor is as easy as installing any node module, just a few commands have to be run in a console:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cd name-of-ionic-4-app</code></p>
</li>
<li>
<p><code>npm install --save @capacitor/core @capacitor/cli</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then, it is necessary to initialize capacitor with some information: app id, name of the app and the directory where your app is stored. To fill this information, run:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap init</code></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="guide-ionic-from-code-to-android.asciidoc_modifications">Modifications</h5>
<div class="paragraph">
<p>Throughout the development process, usually back-end and front-end are on a local computer, so it&#8217;s a common practice to have diferent configuration files for each environment (commonly production and development). Ionic 4 uses an angular.json file to store those configurations and some rules to be applied.</p>
</div>
<div class="paragraph">
<p>If a back-end is hosted on <a href="http://localhost:8081" class="bare">http://localhost:8081</a>, and that direction is used in every environment, the application built for android will not work because computer and device do not have the same localhost. Fortunately, different configurations can be defined.</p>
</div>
<div class="paragraph">
<p>Android Studio uses 10.0.0.2 as alias for 127.0.0.1 (computer&#8217;s localhost) so adding http//10.0.0.2:8081 in a new environment file and modifying angular.json accordingly, will make possible connect front-end and back-end.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/environments.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/environments.png" alt="Android environment and angular.json"></a>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>"build": {
...
    "configurations": {
        ...
        "android": {
            "fileReplacements": [
                {
                    "replace": "src/environments/environment.ts",
                    "with": "src/environments/environment.android.ts"
                }
            ]
        },
    }
}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-ionic-from-code-to-android.asciidoc_build">Build</h5>
<div class="paragraph">
<p>Once configured, it is necessary to build the Ionic 4 app using this new configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ionic build --configuration=android</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next commands copy the build application on a folder named android and open android studio.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap add android</code></p>
</li>
<li>
<p><code>npx cap copy</code></p>
</li>
<li>
<p><code>npx cap open android</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-ionic-from-code-to-android.asciidoc_from-android-project-to-emulated-device">2.3.3. From Android project to emulated device</h4>
<div class="paragraph">
<p>Once Android Studio is opened, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on "Build" &#8594; Make project.</p>
</li>
<li>
<p>Click on "Build" &#8594; Make Module 'app' (default name).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/and-vsc-make.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/and-vsc-make.png" alt="Click on make project" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/and-vsc-make-app.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/and-vsc-make-app.png" alt="click on make app" width="400"></a></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click on" Build" &#8594; Build Bundle(s) / APK(s) &#8594; Build APK(s).</p>
</li>
<li>
<p>Click on run and choose a device.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/and-vsc-build-apk.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/and-vsc-build-apk.png" alt="click on build APK" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/and-vsc-build-run.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/and-vsc-build-run.png" alt="click on running device" width="400"></a></span></p>
</div>
<div class="paragraph">
<p>If there are no devices available, a new one can be created:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on "Create new device"</p>
</li>
<li>
<p>Select hardware and click "Next". For example: Phone &#8594; Nexus 5X.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/create-new-device.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/create-new-device.png" alt="Create new device" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/new-phone-nexus.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/new-phone-nexus.png" alt="Select hardware" width="400"></a></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Download a system image.</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>Click on download.</p>
</li>
<li>
<p>Wait until the installation finished and then click "Finish".</p>
</li>
<li>
<p>Click "Next".</p>
</li>
</ol>
</div>
</li>
<li>
<p>Verify configuration (default configuration should be enough) and click "Next".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/download-so.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/download-so.png" alt="Download system image" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/config-device.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/config-device.png" alt="Check configuration" width="400"></a></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Check that the new device is created correctly.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/new-phone-created.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/new-phone-created.png" alt="New created device" width="400"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-ionic-from-code-to-android.asciidoc_from-android-project-to-real-device">2.3.4. From Android project to real device</h4>
<div class="paragraph">
<p>To test on a real android device, an easy aproach to comunicate a smartphone (front-end) and computer (back-end) is to configure a Wi-fi hotspot and connect the computer to it. A guide about this process can be found at <a href="https://support.google.com/nexus/answer/9059108?hl=en" class="bare">https://support.google.com/nexus/answer/9059108?hl=en</a></p>
</div>
<div class="paragraph">
<p>Once connected, run <code>ipconfig</code> on a console if you are using windows or <code>ifconfig</code> on a linux machine to get the IP address of your machine&#8217;s Wireless LAN adapter Wi-fi.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/ipconfig-short.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/ipconfig-short.png" alt="Result of ipconfig command on Windows 10" width="700"></a>
</div>
</div>
<div class="paragraph">
<p>This obtained IP must be used instead of "localhost" or "10.0.2.2" at environment.android.ts.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/new-backend-url.PNG"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/new-backend-url.PNG" alt="Android environment file server URL" width="700"></a>
</div>
</div>
<div class="paragraph">
<p>After this configuration, follow the build steps in "From ionic 4 to Android project" and the first three steps in "From Android project to emulated device".</p>
</div>
<div class="sect4">
<h5 id="guide-ionic-from-code-to-android.asciidoc_send-apk-to-android-through-usb">Send APK to Android through USB</h5>
<div class="paragraph">
<p>To send the built application to a device, you can connect computer and mobile through USB, but first, it is necessary to unlock developer options.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open "Settings" and go to "System".</p>
</li>
<li>
<p>Click on "About".</p>
</li>
<li>
<p>Click "Build number" seven times to unlock developer options.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/enable-developer-options1_2_3.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/enable-developer-options1_2_3.png" alt="Steps to enable developer options: 1, 2, 3" width="700"></a>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Go to "System" again an then to "Developer options"</p>
</li>
<li>
<p>Check that the options are "On".</p>
</li>
<li>
<p>Check that "USB debugging" is activated.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/enable-developer-options4_5_6.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/enable-developer-options4_5_6.png" alt="Steps to enable developer options: 4, 5, 6" width="700"></a>
</div>
</div>
<div class="paragraph">
<p>After this, do the step four in "From Android project to emulated device" and choose the connected smartphone.</p>
</div>
</div>
<div class="sect4">
<h5 id="guide-ionic-from-code-to-android.asciidoc_send-apk-to-android-throught-email">Send APK to Android throught email</h5>
<div class="paragraph">
<p>When you build an APK, a dialog gives two options: locate or analyze. If the first one is chosen, Windows file explorer will be opened showing an APK that can be send using email. Download the APK on your phone and click it to install.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/locate-apk.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/locate-apk.png" alt="Steps to enable developer options: 4, 5, 6" width="300"></a>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-ionic-from-code-to-android.asciidoc_result">2.3.5. Result</h4>
<div class="paragraph">
<p>If everything goes correctly, the Ionic 4 application will be ready to be tested.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/real-device.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ionic-to-android/real-device.png" alt="Application running on a real device" width="300"></a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_layouts">3. Layouts</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="guide-layout-with-angular-material.asciidoc">3.1. Angular Material Layout</h3>
<div class="paragraph">
<p>The purpose of this guide is to get a basic understanding of creating layouts using <a href="https://material.angular.io">Angular Material</a> in a devon4ng application. We will create an application with a header containing some menu links and a sidenav with some navigation links.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/1-finished-application.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/1-finished-application.png" alt="Finished application" width="700"></a>
</div>
<div class="title">Figure 39. This is what the finished application will look like</div>
</div>
<div class="sect3">
<h4 id="guide-layout-with-angular-material.asciidoc_lets-begin">3.1.1. Let&#8217;s begin</h4>
<div class="paragraph">
<p>We start with opening the console(running console.bat in the Devon distribution folder) and running the following command to start a project named devon4ng-mat-layout</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ng new devon4ng-mat-layout</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Select <code>y</code> when it asks whether it would like to add Angular routing and select <code>SCSS</code> when it asks for the stylesheet format.
You can also use the Devcon to create a new devon4ng application.</p>
</div>
<div class="paragraph">
<p>Once the creation process is complete, open your newly created application in Visual Studio Code. Try running the empty application by running the following command in the integrated terminal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ng serve</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Angular will spin up a server and you can check your application by visiting <a href="http://localhost:4200/" class="bare">http://localhost:4200/</a> in your browser.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/2-blank-application.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/2-blank-application.png" alt="Blank application" width="700"></a>
</div>
<div class="title">Figure 40. Blank application</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-layout-with-angular-material.asciidoc_adding-angular-material-library-to-the-project">3.1.2. Adding Angular Material library to the project</h4>
<div class="paragraph">
<p>Next we will add Angular Material to our application. In the integrated terminal, press <code>Ctrl + C</code> to terminate the running application and run the following command:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npm install --save @angular/material @angular/cdk @angular/animations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also use Yarn to install the dependencies if you prefer that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>yarn add @angular/material @angular/cdk @angular/animations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the dependencies are installed, we need to import the <code>BrowserAnimationsModule</code> in our AppModule for animations support.</p>
</div>
<div class="listingblock">
<div class="title">Listing 36. Importing BrowserAnimationsModule in AppModule</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import {BrowserAnimationsModule} from '@angular/platform-browser/animations';

@NgModule({
  ...
  imports: [BrowserAnimationsModule],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Angular Material provides a host of components for designing our application. All the components are well structured into NgModules. For each component from the Angular Material library that we want to use, we have to import the respective NgModule.</p>
</div>
<div class="listingblock">
<div class="title">Listing 37. We will be using the following components in our application:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { MatIconModule, MatButtonModule, MatMenuModule, MatListModule, MatToolbarModule, MatSidenavModule } from '@angular/material';

@NgModule({
  ...
  imports: [
	...
    MatIconModule,
    MatButtonModule,
    MatMenuModule,
    MatListModule,
    MatToolbarModule,
    MatSidenavModule,
	...
	],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>A better approach is to import and then export all the required components in a shared  module. But for the sake of simplicity, we are importing all the required components in the AppModule itself.</p>
</div>
<div class="paragraph">
<p>Next, we include a theme in our application. Angular Material comes with four inbuilt themes: indigo-pink, deeppurple-amber, pink-bluegrey and purple-green. It is also possible to create our own custom theme, but that is beyond the scope of this guide. Including a theme is required to apply all of the core and theme styles to your application.
We will include the indigo-pink theme in our application by importing the <code>indigo-pink.css</code> file in our <code>src/styles.scss</code>:</p>
</div>
<div class="listingblock">
<div class="title">Listing 38. In src/styles.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">@import "~@angular/material/prebuilt-themes/indigo-pink.css";</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some Angular Material components depend on HammerJs for gestures. So it is a good idea to install HammerJs as a dependency in our application. To do so, run the following command in the terminal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npm install --save hammerjs</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then import it in the <code>src/main.ts</code> file</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>import 'hammerjs';</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use <a href="https://material.io/icons/">Material Design Icons</a> along with the <code>mat-icon</code> component, we will load the Material Icons library in our <code>src/index.html</code> file</p>
</div>
<div class="listingblock">
<div class="title">Listing 39. In src/index.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-layout-with-angular-material.asciidoc_development">3.1.3. Development</h4>
<div class="paragraph">
<p>Now that we have all the Angular Material related dependencies set up in our project, we can start coding. Let&#8217;s begin by adding a suitable <code>margin</code> and <code>font</code> to the <code>body</code> element of our single page application. We will add it in the <code>src/styles.scss</code> file to apply it globally:</p>
</div>
<div class="listingblock">
<div class="title">Listing 40. In src/styles.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">body {
  margin: 0;
  font-family: "Segoe UI", Roboto, sans-serif;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, if we run our application with <code>ng serve</code>, this is how it will look like:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/3-material-added.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/3-material-added.png" alt="Angular Material added to the application" width="700"></a>
</div>
<div class="title">Figure 41. Application with Angular Material set up</div>
</div>
<div class="paragraph">
<p>We will clear the <code>app.component.html</code> file and setup a header with a menu button and some navigational links. We will use <code>mat-toolbar</code>, <code>mat-button</code>, <code>mat-menu</code>, <code>mat-icon</code> and <code>mat-icon-button</code> for this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 41. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;mat-toolbar color="primary"&gt;
  &lt;button mat-icon-button aria-label="menu"&gt;
    &lt;mat-icon&gt;menu&lt;/mat-icon&gt;
  &lt;/button&gt;
  &lt;button mat-button [matMenuTriggerFor]="submenu"&gt;Menu 1&lt;/button&gt;
  &lt;button mat-button&gt;Menu 2&lt;/button&gt;
  &lt;button mat-button&gt;Menu 3&lt;/button&gt;

  &lt;mat-menu #submenu="matMenu"&gt;
    &lt;button mat-menu-item&gt;Sub-menu 1&lt;/button&gt;
    &lt;button mat-menu-item [matMenuTriggerFor]="submenu2"&gt;Sub-menu 2&lt;/button&gt;
  &lt;/mat-menu&gt;

  &lt;mat-menu #submenu2="matMenu"&gt;
    &lt;button mat-menu-item&gt;Menu Item 1&lt;/button&gt;
    &lt;button mat-menu-item&gt;Menu Item 2&lt;/button&gt;
    &lt;button mat-menu-item&gt;Menu Item 3&lt;/button&gt;
  &lt;/mat-menu&gt;

&lt;/mat-toolbar&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The color attribute on the <code>mat-toolbar</code> element will give it the primary (indigo) color as defined by our theme. The color attribute works with most Angular Material components; the possible values are 'primary', 'accent' and 'warn'.
The mat-toolbar is a suitable component to represent a header. It serves as a placeholder for elements we want in our header.
Inside the mat-toolbar, we start with a button having mat-icon-button attribute, which itself contains a mat-icon element having the value <code>menu</code>. This will serve as a menu button which we can use to toggle the sidenav.
We follow it with some sample buttons having the mat-button attribute. Notice the first button has a property <code>matMenuTriggerFor</code> binded to a local reference <code>submenu</code>. As the property name suggests, the click of this button will display the <code>mat-menu</code> element with the specified local reference as a drop-down menu. The rest of the code is self explanatory.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/4-header.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/4-header.png" alt="Header added to the application" width="700"></a>
</div>
<div class="title">Figure 42. This is how our application looks with the first menu button (Menu 1) clicked.</div>
</div>
<div class="paragraph">
<p>We want to keep the sidenav toggling menu button on the left and move the rest to the right to make it look better. To do this we add a class to the menu icon button:</p>
</div>
<div class="listingblock">
<div class="title">Listing 42. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
  &lt;button mat-icon-button aria-label="menu" class="menu"&gt;
    &lt;mat-icon&gt;menu&lt;/mat-icon&gt;
  &lt;/button&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in the <code>app.component.scss</code> file, we add the following style:</p>
</div>
<div class="listingblock">
<div class="title">Listing 43. app.component.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">.menu {
    margin-right: auto;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mat-toolbar element already has it&#8217;s display property set to <code>flex</code>. Setting the menu icon button&#8217;s <code>margin-right</code> property to <code>auto</code> keeps itself on the left and pushes the other elements to the right.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/5-header-layout-final.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/5-header-layout-final.png" alt="Final look of the header" width="700"></a>
</div>
<div class="title">Figure 43. Final look of the header.</div>
</div>
<div class="paragraph">
<p>Next, we will create a sidenav. But before that lets create a couple of components to navgate between, the links of which we will add to the sidenav.
We will use the <code>ng generate component</code> (or <code>ng g c</code> command for short) to create <em>Home</em> and <em>Data</em> components. We nest them in the <code>pages</code> sub-directory since they represent our pages.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ng g c pages/home</code></p>
</li>
<li>
<p><code>ng g c pages/data';</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let us set up the routing such that when we visit <code><a href="http://localhost:4200/" class="bare">http://localhost:4200/</a></code> root url we see the <code>HomeComponent</code> and when we visit <code><a href="http://localhost:4200/data" class="bare">http://localhost:4200/data</a></code> url we see the <code>DataComponent</code>.
We had opted for routing while creating the application, so we have the routing module <code>app-routing.module.ts</code> setup for us. In this file, we have the empty <code>routes</code> array where we set up our routes.</p>
</div>
<div class="listingblock">
<div class="title">Listing 44. app-routing.module.ts:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { HomeComponent } from './pages/home/home.component';
import { DataComponent } from './pages/data/data.component';

	const routes: Routes = [
	  { path: '', component: HomeComponent },
	  { path: 'data', component: DataComponent }
	];
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to provide a hook where the components will be loaded when their respective URLs are loaded. We do that by using the <code>router-outlet</code> directive in the <code>app.component.html</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 45. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
	&lt;/mat-toolbar&gt;
	&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now when we visit the defined URLs we see the appropriate components rendered on screen.</p>
</div>
<div class="paragraph">
<p>Lets change the contents of the components to have something better.</p>
</div>
<div class="listingblock">
<div class="title">Listing 46. home.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;h2&gt;Home Page&lt;/h2&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 47. home.component.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">h2 {
    text-align: center;
    margin-top: 50px;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 48. data.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;h2&gt;Data Page&lt;/h2&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 49. data.component.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">h2 {
    text-align: center;
    margin-top: 50px;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pages look somewhat better now:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/6-home-page.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/6-home-page.png" alt="Home page" width="700"></a>
</div>
<div class="title">Figure 44. Home page</div>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/7-data-page.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/7-data-page.png" alt="Data page" width="700"></a>
</div>
<div class="title">Figure 45. Data page</div>
</div>
<div class="paragraph">
<p>Let us finally create the sidenav. To implement the sidenav we need to use 3 Angular Material components: <code>mat-sidenav-container</code>, <code>mat-sidenav</code> and <code>mat-sidenav-content</code>.
The <code>mat-sidenav-container</code>, as the name suggests, acts as a container for the sidenav and the associated content. So it is the parent element, and <code>mat-sidenav</code> and <code>mat-sidenav-content</code> are the children sibling elements. <code>mat-sidenav</code> represents the sidenav. We can put any content we want, though it is usually used to conatain a list of navigational links. The <code>mat-sidenav-content</code> element is for conataining our main page content. Since we need the sidenav application-wide, we will put it in the <code>app.component.html</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 50. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
&lt;/mat-toolbar&gt;

&lt;mat-sidenav-container&gt;
  &lt;mat-sidenav mode="over" [disableClose]="false" #sidenav&gt;
    Sidenav
  &lt;/mat-sidenav&gt;
  &lt;mat-sidenav-content&gt;
    &lt;router-outlet&gt;&lt;/router-outlet&gt;
  &lt;/mat-sidenav-content&gt;
&lt;/mat-sidenav-container&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>mat-sidenav</code> has a <code>mode</code> property, which accepts one of the 3 values: <code>over</code>, <code>push</code> and <code>side</code>. It decides the behavior of the sidenav. <code>mat-sidenav</code> also has a <code>disableClose</code> property which accents a boolean value. It toggles the behavior where we click on the backdrop or press the <code>Esc</code> key to close the sidenav. There are other properties which we can use to customize the appearance, behavior and position of the sidenav. You can find the properties documented online at <a href="https://material.angular.io/components/sidenav/api" class="bare">https://material.angular.io/components/sidenav/api</a>
We moved the <code>router-outlet</code> directive inside the <code>mat-sidenav-content</code> where it will render the routed component.
But if you check the running application in the browser, we don&#8217;t see the sidenav yet. That is because it is closed. We want to have the sidenav opened/closed at the click of the menu icon button on the left side of the header we implemented earlier. Notice we have set a local reference <code>#sidenav</code> on the <code>mat-sidenav</code> element. We can access this element and call its <code>toggle()</code> function to toggle open or close the sidenav.</p>
</div>
<div class="listingblock">
<div class="title">Listing 51. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
  &lt;button mat-icon-button aria-label="menu" class="menu" (click)="sidenav.toggle()"&gt;
    &lt;mat-icon&gt;menu&lt;/mat-icon&gt;
  &lt;/button&gt;
...</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/8-sidenav-started.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/8-sidenav-started.png" alt="Sidenav works" width="700"></a>
</div>
<div class="title">Figure 46. Sidenav is implemented</div>
</div>
<div class="paragraph">
<p>We can now open the sidenav by clicking the menu icon button. But it does not look right. The sidenav is only as wide as its content. Also the page does not stretch the entire viewport due to lack of content.
Let&#8217;s add the following styles to make the page fill the viewport:</p>
</div>
<div class="listingblock">
<div class="title">Listing 52. app.component.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">...
mat-sidenav-container {
    position: absolute;
    top: 64px;
    left: 0;
    right: 0;
    bottom: 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The sidenav&#8217;s width will be corrected when we add the navigational links to it. That is the only thing remaining to be done. Lets implement it now:</p>
</div>
<div class="listingblock">
<div class="title">Listing 53. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
  &lt;mat-sidenav [disableClose]="false" mode="over" #sidenav&gt;
	&lt;mat-nav-list&gt;
      &lt;a
        id="home"
        mat-list-item
        [routerLink]="['./']"
        (click)="sidenav.close()"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{exact: true}"
      &gt;
        &lt;mat-icon matListAvatar&gt;home&lt;/mat-icon&gt;
        &lt;h3 matLine&gt;Home&lt;/h3&gt;
        &lt;p matLine&gt;sample home page&lt;/p&gt;
      &lt;/a&gt;
      &lt;a
        id="sampleData"
        mat-list-item
        [routerLink]="['./data']"
        (click)="sidenav.close()"
        routerLinkActive="active"
      &gt;
        &lt;mat-icon matListAvatar&gt;grid_on&lt;/mat-icon&gt;
        &lt;h3 matLine&gt;Data&lt;/h3&gt;
        &lt;p matLine&gt;sample data page&lt;/p&gt;
      &lt;/a&gt;
    &lt;/mat-nav-list&gt;
  &lt;/mat-sidenav&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We use the <code>mat-nav-list</code> element to set a list of navigational links. We use the <code>a</code> tags with <code>mat-list-item</code> directive. We implement a <code>click</code> listener on each link to close the sidenav when it is clicked. The <code>routerLink</code> directive is used to provide the URLs to navigate to. The <code>routerLinkActive</code> directive is used to provide the class name which will be added to the link when it&#8217;s URL is visited. Here we name the class`active`. To stye it, let' modify the <code>app.component.scss</code> file:</p>
</div>
<div class="listingblock">
<div class="title">Listing 54. app.component.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">...
mat-sidenav-container {
...
	a.active {
        background: #8e8d8d;
        color: #fff;

        p {
            color: #4a4a4a;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we have a working application with a basic layout: a header with some menu and a sidenav with some navigational links.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/9-finished.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/layout-angular-material/9-finished.png" alt="Finished application" width="700"></a>
</div>
<div class="title">Figure 47. Finished application</div>
</div>
</div>
<div class="sect3">
<h4 id="guide-layout-with-angular-material.asciidoc_conclusion">3.1.4. Conclusion</h4>
<div class="paragraph">
<p>The purpose of this guide was to provide a basic understanding of creating layouts with Angular Material. The Angular Material library has a huge collection of ready to use components which can be found at <a href="https://material.angular.io/components/categories" class="bare">https://material.angular.io/components/categories</a>
It has provided documentation and example usage for each of its components.  Going through the documentation will give a better understanding of using Angular Material components in our devon4ng applications.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_ngrx">4. NgRx</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="guide-ngrx-getting-started.asciidoc">4.1. Introduction to NgRx</h3>
<div class="paragraph">
<p><a href="https://github.com/ngrx">NgRx</a> is a state management framework for Angular based on the <a href="https://redux.js.org/">Redux</a> pattern.</p>
</div>
<div class="sect3">
<h4 id="guide-ngrx-getting-started.asciidoc_the-need-for-client-side-state-management">4.1.1. The need for client side state management</h4>
<div class="paragraph">
<p>You may wonder why you should bother with state management. Usually data resides in a backend storage system, e.g. a database, and is retrieved by the client on a per-need basis. To add, update, or delete entities from this store, clients have to invoke API endpoints at the backend. Mimicking database-like transactions on the client side may seem redundant. However, there are many use cases for which a global client-side state is appropriate:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the client has some kind of global state which should survive the destruction of a component, but does not warrant server side persistence, for example: volume level of media, expansion status of menus</p>
</li>
<li>
<p>sever side data should not be retrieved every time it is needed, either because multiple components consume it, or because it should be cached, e.g. the personal watchlist in an online streaming app</p>
</li>
<li>
<p>the app provides a rich experience with offline functionality, e.g. a native app built with <a href="#guilde-ionic-getting-started.asciidoc">Ionic</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Saving global states inside the services they originates from results in a data flow that is hard to follow and state becoming inconsistent due to unordered state mutations. Following the <em>single source of truth</em> principle, there should be a central location holding all your application&#8217;s state, just like a server side database does. State managament libraries for Angular provide tools for storing, retrieving, and updating client-side state.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-ngrx-getting-started.asciidoc_why-ngrx">4.1.2. Why NgRx?</h4>
<div class="paragraph">
<p>As stated in the <a href="#home.asciidoc">introduction</a>, devon4ng does not stipulate a particular state library, or require using one at all. However, NgRx has proven to be a robust, mature solution for this task, with good tooling and 3rd-party library support. Albeit introducing a level of indirection that requires additional effort even for simple features, the redux concept enforces a clear separation of concerns leading to a cleaner architecture.</p>
</div>
<div class="paragraph">
<p>Nonetheless, you should always compare different approaches to state management and pick the best one suiting your use case. Here&#8217;s a (non-exhaustive) list of competing state management libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plain Rxjs using the simple store described in <a href="#cookbook-abstract-class-store.asciidoc">Abstract Class Store</a></p>
</li>
<li>
<p><a href="https://github.com/ngxs">NgXS</a> reduces some boilerplate of NgRx by leveraging the power of decorators and moving side effects to the store</p>
</li>
<li>
<p><a href="https://github.com/mobxjs/mobx">MobX</a> follows a more imperative approach in contrast to the functional Redux pattern</p>
</li>
<li>
<p><a href="https://github.com/datorama/akita">Akita</a> also uses an imperative approach with direct setters in the store, but keeps the concept of immutable state transitions</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="guide-ngrx-getting-started.asciidoc_setup">4.1.3. Setup</h4>
<div class="paragraph">
<p>To get a quick start, use the provided <a href="https://github.com/devonfw-forge/devon4ng-ngrx-template">template for devon4ng + NgRx</a>.</p>
</div>
<div class="paragraph">
<p>To manually install the core store package together with a set of useful extensions:</p>
</div>
<div class="paragraph">
<p>NPM:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm install @ngrx/store @ngrx/effects @ngrx/entity @ngrx/store-devtools --save</pre>
</div>
</div>
<div class="paragraph">
<p>Yarn:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>yarn add @ngrx/store @ngrx/effects @ngrx/entity @ngrx/store-devtools</pre>
</div>
</div>
<div class="paragraph">
<p>We recommend to add the NgRx schematics to your project so you can create code artifacts from the command line:</p>
</div>
<div class="paragraph">
<p>NPM:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm install @ngrx/schematics --save-dev</pre>
</div>
</div>
<div class="paragraph">
<p>Yarn:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>yarn add @ngrx/schematics --dev</pre>
</div>
</div>
<div class="paragraph">
<p>Afterwards, make NgRx your default schematics provider, so you don&#8217;t have to type the qualified package name every time:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng config cli.defaultCollection @ngrx/schematics</pre>
</div>
</div>
<div class="paragraph">
<p>If you have custom settings for Angular schematics, you have to <a href="https://ngrx.io/guide/schematics">configure them as described here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="guide-ngrx-getting-started.asciidoc_concept">4.1.4. Concept</h4>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/ngrx-concept.svg"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ngrx-concept.svg" alt="NgRx Architecture"></a>
</div>
<div class="title">Figure 48. NgRx architecture overview</div>
</div>
<div class="paragraph">
<p>Figure 1 gives an overview of the NgRx data flow. The single source of truth is managed as an immutable state object by the store. Components dispatch actions to trigger state changes. Actions are handed over to reducers, which take the current state and action data to compute the next state. Actions are also consumed byeffects, which perform side-effects such as retrieving data from the backend, and may dispatch new actions as a result. Components subscribe to state changes using selectors.</p>
</div>
<div class="paragraph">
<p>Continue with <a href="#guide-ngrx-simple-store.asciidoc">Creating a Simple Store</a>.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect2">
<h3 id="guide-ngrx-simple-store.asciidoc">4.2. State, Selection and Reducers</h3>
<div class="sect3">
<h4 id="guide-ngrx-simple-store.asciidoc_creating-a-simple-store">4.2.1. Creating a Simple Store</h4>
<div class="paragraph">
<p>In the following pages we use the example of an online streaming service. We will model a particular feature, a watchlist that can be populated by the user with movies she or he wants to see in the future.</p>
</div>
<div class="sect4">
<h5 id="guide-ngrx-simple-store.asciidoc_initializing-ngrx">Initializing NgRx</h5>
<div class="paragraph">
<p>If you&#8217;re starting fresh, you first have to initialize NgRx and create a root state. The fastest way to do this is using the schematic:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng generate @ngrx/schematics:store State --root --module app.module.ts</pre>
</div>
</div>
<div class="paragraph">
<p>This will automatically generate a root store and register it in the app module. Next we generate a feature module for the watchlist:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng generate module watchlist</pre>
</div>
</div>
<div class="paragraph">
<p>and create a corresponding feature store:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng generate store watchlist/Watchlist -m watchlist.module.ts</pre>
</div>
</div>
<div class="paragraph">
<p>This generates a file <code>watchlist/reducers/index.ts</code> with the reducer function, and registers the store in the watchlist module declaration.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you&#8217;re getting an error <em>Schematic "store" not found in collection "@schematics/angular"</em>, this means you forgot to register the NgRx schematics as default.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Next, add the WatchlistModule to the AppModule imports so the feature store is registered when the application starts. We also added the <strong>store devtools</strong> which we will use later, resulting in the following file:</p>
</div>
<div class="paragraph">
<p><strong>app.module.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppComponent } from './app.component';
import { EffectsModule } from '@ngrx/effects';
import { AppEffects } from './app.effects';
import { StoreModule } from '@ngrx/store';
import { reducers, metaReducers } from './reducers';
import { StoreDevtoolsModule } from '@ngrx/store-devtools';
import { environment } from '../environments/environment';
import { WatchlistModule } from './watchlist/watchlist.module';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    WatchlistModule,
    StoreModule.forRoot(reducers, { metaReducers }),
    // Instrumentation must be imported after importing StoreModule (config is optional)
    StoreDevtoolsModule.instrument({
      maxAge: 25, // Retains last 25 states
      logOnly: environment.production, // Restrict extension to log-only mode
    }),
    !environment.production ? StoreDevtoolsModule.instrument() : []
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-ngrx-simple-store.asciidoc_create-an-entity-model-and-initial-state">Create an entity model and initial state</h5>
<div class="paragraph">
<p>We need a simple model for our list of movies. Create a file <code>watchlist/models/movies.ts</code> and insert the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface Movie {
    id: number;
    title: string;
    releaseYear: number;
    runtimeMinutes: number;
    genre: Genre;
}

export type Genre = 'action' | 'fantasy' | 'sci-fi' | 'romantic' | 'comedy' | 'mystery';

export interface WatchlistItem {
    id: number;
    movie: Movie;
    added: Date;
    playbackMinutes: number;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We discourage putting several types into the same file and do this only for the sake of keeping this tutorial brief.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Later we will learn how to retrieve data from the backend using effects. For now we will create an initial state for the user with a default movie.</p>
</div>
<div class="paragraph">
<p>State is defined and transforms by a reducer function. Let&#8217;s create a watchlist reducer:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd watchlist/reducers
ng g reducer WatchlistData --reducers index.ts</pre>
</div>
</div>
<div class="paragraph">
<p>Open the generated file <code>watchlist-data.reducer.ts</code>. You see three exports: The <strong>State</strong> interface defines the shape of the state. There is only one instance of a feature state in the store at all times. The <strong>initialState</strong> constant is the state at application creation time. The <strong>reducer</strong> function will later be called by the store to produce the next state instance based on the current state and an action object.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s put a movie into the user&#8217;s watchlist:</p>
</div>
<div class="paragraph">
<p><strong>watchlist-data.reducer.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface State {
  items: WatchlistItem[];
}

export const initialState: State = {
  items: [
    {
      id: 42,
      movie: {
        id: 1,
        title: 'Die Hard',
        genre: 'action',
        releaseYear: 1988,
        runtimeMinutes: 132
      },
      playbackMinutes: 0,
      added: new Date(),
    }
  ]
};</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-ngrx-simple-store.asciidoc_select-the-current-watchlist">Select the current watchlist</h5>
<div class="paragraph">
<p>State slices can be retrieved from the store using selectors.</p>
</div>
<div class="paragraph">
<p>Create a watchlist component:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng g c watchlist/Watchlist</pre>
</div>
</div>
<div class="paragraph">
<p>and add it to the exports of WatchlistModule. Also, replace <code>app.component.html</code> with</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;app-watchlist&gt;&lt;/app-watchlist&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>State observables are obtained using selectors. They are memoized by default, meaning that you don&#8217;t have to worry about performance if you use complicated calculations when deriving state&#8201;&#8212;&#8201;these are only performed once per state emission.</p>
</div>
<div class="paragraph">
<p>Add a selector to <code>watchlist-data.reducer.ts</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>export const getAllItems = (state: State) =&gt; state.items;</pre>
</div>
</div>
<div class="paragraph">
<p>Next, we have to re-export the selector for this substate in the feature reducer. Modify the <code>watchlist/reducers/index.ts</code> like this:</p>
</div>
<div class="paragraph">
<p><strong>watchlist/reducers/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
  ActionReducer,
  ActionReducerMap,
  createFeatureSelector,
  createSelector,
  MetaReducer
} from '@ngrx/store';
import { environment } from 'src/environments/environment';
import * as fromWatchlistData from './watchlist-data.reducer';
import * as fromRoot from 'src/app/reducers/index';

export interface WatchlistState { <i class="conum" data-value="1"></i><b>(1)</b>
  watchlistData: fromWatchlistData.State;
}

export interface State extends fromRoot.State { <i class="conum" data-value="2"></i><b>(2)</b>
  watchlist: WatchlistState;
}

export const reducers: ActionReducerMap&lt;WatchlistState&gt; = { <i class="conum" data-value="3"></i><b>(3)</b>
  watchlistData: fromWatchlistData.reducer,
};

export const metaReducers: MetaReducer&lt;WatchlistState&gt;[] = !environment.production ? [] : [];

export const getFeature = createFeatureSelector&lt;State, WatchlistState&gt;('watchlist'); <i class="conum" data-value="4"></i><b>(4)</b>

export const getWatchlistData = createSelector( <i class="conum" data-value="5"></i><b>(5)</b>
  getFeature,
  state =&gt; state.watchlistData
);

export const getAllItems = createSelector( <i class="conum" data-value="6"></i><b>(6)</b>
  getWatchlistData,
  fromWatchlistData.getAllItems
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The feature state, each member is managed by a different reducer</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Feature states are registered by the <code>forFeature</code> method. This interface provides a typesafe path from root to feature state.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Tie substates of a feature state to the corresponding reducers</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Create a selector to access the 'watchlist' feature state</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>select the watchlistData sub state</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>re-export the selector</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note how <code>createSelector</code> allows to chain selectors. This is a powerful tool that also allows for selecting from multiple states.</p>
</div>
<div class="paragraph">
<p>You can use selectors as pipeable operators:</p>
</div>
<div class="paragraph">
<p><strong>watchlist.component.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class WatchlistComponent {
  watchlistItems$: Observable&lt;WatchlistItem[]&gt;;

  constructor(
    private store: Store&lt;fromWatchlist.State&gt;
  ) {
    this.watchlistItems$ = this.store.pipe(select(fromWatchlist.getAllItems));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>watchlist.component.html</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;h1&gt;Watchlist&lt;/h1&gt;
&lt;ul&gt;
    &lt;li *ngFor="let item of watchlistItems$ | async"&gt;{{item.movie.title}} ({{item.movie.releaseYear}}): {{item.playbackMinutes}}/{{item.movie.runtimeMinutes}} min watched&lt;/li&gt;
&lt;/ul&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-ngrx-simple-store.asciidoc_dispatching-an-action-to-update-watched-minutes">Dispatching an action to update watched minutes</h5>
<div class="paragraph">
<p>We track the user&#8217;s current progress at watching a movie as the <code>playbackMinutes</code> property. After closing a video, the watched minutes have to be updated. In NgRx, state is being updated by dispatching actions. An action is an option with a (globally unique) type discriminator and an optional payload.</p>
</div>
<div class="sect5">
<h6 id="guide-ngrx-simple-store.asciidoc_creating-the-action">Creating the action</h6>
<div class="paragraph">
<p>Create a file <code>playback/actions/index.ts</code>. In this example, we do not further separate the actions per sub state. Actions can be defined by using action creators:</p>
</div>
<div class="paragraph">
<p><strong>playback/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { createAction, props, union } from '@ngrx/store';

export const playbackFinished = createAction('[Playback] Playback finished', props&lt;{ movieId: number, stoppedAtMinute: number }&gt;());

const actions = union({
    playbackFinished
});

export type ActionsUnion = typeof actions;</code></pre>
</div>
</div>
<div class="paragraph">
<p>First we specify the type, followed by a call to the payload definition function. Next, we create a union of all possible actions for this file using <code>union</code>, which allows us a to access action payloads in the reducer in a typesafe way.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Action types should follow the naming convention <code>[Source] Event</code>, e.g. <code>[Recommended List] Hide Recommendation</code> or <code>[Auth API] Login Success</code>. Think of actions rather as events than commands. You should never use the same action at two different places (you can still handle multiple actions the same way). This faciliates tracing the source of an action. For details see <a href="https://www.youtube.com/watch?v=JmnsEvoy-gY">Good Action Hygiene with NgRx</a> by Mike Ryan (video).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="guide-ngrx-simple-store.asciidoc_dispatch">Dispatch</h6>
<div class="paragraph">
<p>We skip the implementation of an actual video playback page and simulate wathcing a movie in 10 minute segments by adding a link in the template:</p>
</div>
<div class="paragraph">
<p><strong>watchlist-component.html</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;li *ngFor="let item of watchlistItems$ | async"&gt;... &lt;button (click)="stoppedPlayback(item.movie.id, item.playbackMinutes + 10)"&gt;Add 10 Minutes&lt;/button&gt;&lt;/li&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>watchlist-component.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import * as playbackActions from 'src/app/playback/actions';
...
  stoppedPlayback(movieId: number, stoppedAtMinute: number) {
    this.store.dispatch(playbackActions.playbackFinished({ movieId, stoppedAtMinute }));
  }</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="guide-ngrx-simple-store.asciidoc_state-reduction">State reduction</h6>
<div class="paragraph">
<p>Next, we handle the action inside the watchlistData reducer. Note that actions can be handled by multiple reducers and effects at the same time to update different states, for example if we&#8217;d like to show a rating modal after playback has finished.</p>
</div>
<div class="paragraph">
<p><strong>watchlist-data.reducer.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export function reducer(state = initialState, action: playbackActions.ActionsUnion): State {
  switch (action.type) {
    case playbackActions.playbackFinished.type:
      return {
        ...state,
        items: state.items.map(updatePlaybackMinutesMapper(action.movieId, action.stoppedAtMinute))
      };

    default:
      return state;
  }
}

export function updatePlaybackMinutesMapper(movieId: number, stoppedAtMinute: number) {
  return (item: WatchlistItem) =&gt; {
    if (item.movie.id === movieId) {
      return {
        ...item,
        playbackMinutes: stoppedAtMinute
      };
    } else {
      return item;
    }
  };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note how we changed the reducer&#8217;s function signature to reference the actions union. The switch-case handles all incoming actions to produce the next state. The default case handles all actions a reducer is not interested in by returning the state unchanged. Then we find the watchlist item corresponding to the movie with the given id and update the playback minutes. Since state is immutable, we have to clone all objects down to the one we would like to change using the object spread operator (<code>&#8230;&#8203;</code>).</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Selectors rely on object identity to decide whether the value has to be recalculated. Do not clone objects that are not on the path to the change you want to make. This is why <code>updatePlaybackMinutesMapper</code> returns the same item if the movie id does not match.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="guide-ngrx-simple-store.asciidoc_alternative-state-mapping-with-immer">Alternative state mapping with immer</h6>
<div class="paragraph">
<p>It can be hard to think in immutable changes, especially if your team has a strong background in imperative programming. In this case, you may find the <a href="https://github.com/immerjs/immer">immer</a> library convenient, which allows to produce immutable objects by manipulating a proxied draft. The same reducer can then be written as:</p>
</div>
<div class="paragraph">
<p><strong>watchlist-data.reducer.ts</strong> with immer</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { produce } from 'immer';
...
case playbackActions.playbackFinished.type:
      return produce(state, draft =&gt; {
        const itemToUpdate = draft.items.find(item =&gt; item.movie.id === action.movieId);
        if (itemToUpdate) {
          itemToUpdate.playbackMinutes = action.stoppedAtMinute;
        }
      });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Immer works out of the box with plain objects and arrays.</p>
</div>
</div>
<div class="sect5">
<h6 id="guide-ngrx-simple-store.asciidoc_redux-devtools">Redux devtools</h6>
<div class="paragraph">
<p>If the <code>StoreDevToolsModule</code> is instrumented as described above, you can use the browser extension <a href="https://github.com/reduxjs/redux-devtools">Redux devtools</a> to see all dispatched actions and the resulting state diff, as well as the current state, and even travel back in time by undoing actions.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/ngrx-devtools.png"><img src="C:/Proyectos/devonfw-official-website-projects/devonfw-official-website/devonfw-guide/target/generated-docs/images/ngrx-devtools.png" alt="Redux Devtools"></a>
</div>
<div class="title">Figure 49. Redux devtools</div>
</div>
<div class="paragraph">
<p>Continue with <a href="#guide-ngrx-effects.asciidoc">learning about effects</a></p>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-ngrx-effects.asciidoc">4.3. Side effects with NgRx/Effects</h3>
<div class="paragraph">
<p>Reducers are pure functions, meaning they are side-effect free and deterministic. Many actions however have side effects like sending messages or displaying a toast notification. NgRx encapsulates these actions in effects.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s build a recommended movies list so the user can add movies to their watchlist.</p>
</div>
<div class="sect3">
<h4 id="guide-ngrx-effects.asciidoc_obtaining-the-recommendation-list-from-the-server">4.3.1. Obtaining the recommendation list from the server</h4>
<div class="paragraph">
<p>Create a module for recommendations and add stores and states as in the previous chapter. Add <code>EffectsModule.forRoot([])</code> to the imports in <code>AppModule</code> below <code>StoreModule.forRoot()</code>. Add effects to the feature module:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng generate effect recommendation/Recommendation -m recommendation/recommendation.module.ts</pre>
</div>
</div>
<div class="paragraph">
<p>We need actions for loading the movie list, success and failure cases:</p>
</div>
<div class="paragraph">
<p><strong>recommendation/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { createAction, props, union } from '@ngrx/store';
import { Movie } from 'src/app/watchlist/models/movies';

export const loadRecommendedMovies = createAction('[Recommendation List] Load movies');
export const loadRecommendedMoviesSuccess = createAction('[Recommendation API] Load movies success', props&lt;{movies: Movie[]}&gt;());
export const loadRecommendedMoviesFailure = createAction('[Recommendation API] Load movies failure', props&lt;{error: any}&gt;());

const actions = union({
    loadRecommendedMovies,
    loadRecommendedMoviesSuccess,
    loadRecommendedMoviesFailure
});

export type ActionsUnion = typeof actions;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the reducer, we use a loading flag so the UI can show a loading spinner. The store is updated with arriving data.</p>
</div>
<div class="paragraph">
<p><strong>recommendation/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface State {
  items: Movie[];
  loading: boolean;
}

export const initialState: State = {
  items: [],
  loading: false
};

export function reducer(state = initialState, action: recommendationActions.ActionsUnion): State {
  switch (action.type) {
    case '[Recommendation List] Load movies':
      return {
        ...state,
        items: [],
        loading: true
      };

    case '[Recommendation API] Load movies failure':
      return {
        ...state,
          loading: false
      };

    case '[Recommendation API] Load movies success':
      return {
        ...state,
        items: action.movies,
        loading: false
      };

    default:
      return state;
  }
}

export const getAll = (state: State) =&gt; state.items;
export const isLoading = (state: State) =&gt; state.loading;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need an API service to talk to the server. For demonstration purposes, we simulate an answer delayed by one second:</p>
</div>
<div class="paragraph">
<p><strong>recommendation/services/recommendation-api.service.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable({
  providedIn: 'root'
})
export class RecommendationApiService {

  private readonly recommendedMovies: Movie[] = [
    {
      id: 2,
      title: 'The Hunger Games',
      genre: 'sci-fi',
      releaseYear: 2012,
      runtimeMinutes: 144
    },
    {
      id: 4,
      title: 'Avengers: Endgame',
      genre: 'fantasy',
      releaseYear: 2019,
      runtimeMinutes: 181
    }
  ];

  loadRecommendedMovies(): Observable&lt;Movie[]&gt; {
    return of(this.recommendedMovies).pipe(delay(1000));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here are the effects:</p>
</div>
<div class="paragraph">
<p><strong>recommendation/services/recommendation-api.service.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable()
export class RecommendationEffects {

  constructor(
    private actions$: Actions,
    private recommendationApi: RecommendationApiService,
  ) { }

  @Effect()
  loadBooks$ = this.actions$.pipe(
    ofType(recommendationActions.loadRecommendedMovies.type),
    switchMap(() =&gt; this.recommendationApi.loadRecommendedMovies().pipe(
      map(movies =&gt; recommendationActions.loadRecommendedMoviesSuccess({ movies })),
      catchError(error =&gt; of(recommendationActions.loadRecommendedMoviesFailure({ error })))
    ))
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Effects are always observables and return actions. In this example, we consume the actions observable provided by NgRx and listen only for the <code>loadRecommendedMovies</code> actions by using the <code>ofType</code> operator. Using <code>switchMap</code>, we map to a new observable, one that loads movies and maps the successful result to a new <code>loadRecommendedMoviesSuccess</code> action or a failure to <code>loadRecommendedMoviesFailure</code>. In a real application we would show a notification in the error case.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If an effect should not dispatch another action, return an empty observable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#guide-ngrx-entity.asciidoc">Continue reading how to simplify CRUD (Create Read Update Delete) operations using @ngrx/entity</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="master-devon4ng.asciidoc_cookbook">5. Cookbook</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="cookbook-abstract-class-store.asciidoc">5.1. Abstract Class Store</h3>
<div class="paragraph">
<p>The following solution presents a base class for implementing stores which handle state and its transitions.
Working with the base class achieves:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>common API across all stores</p>
</li>
<li>
<p>logging (when activated in the constructor)</p>
</li>
<li>
<p>state transitions are asynchronous by design - sequential order problems are avoided</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 55. Usage Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@Injectable()
export class ModalStore extends Store&lt;ModalState&gt; {

  constructor() {
    super({ isOpen: false }, !environment.production);
  }

  closeDialog() {
    this.dispatchAction('Close Dialog', (currentState) =&gt; ({...currentState, isOpen: false}));
  }

  openDialog() {
    this.dispatchAction('Open Dialog', (currentState) =&gt; ({...currentState, isOpen: true}));
  }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 56. Abstract Base Class Store</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { OnDestroy } from '@angular/core';
import { BehaviorSubject } from 'rxjs/BehaviorSubject';
import { Observable } from 'rxjs/Observable';
import { intersection, difference } from 'lodash';
import { map, distinctUntilChanged, observeOn } from 'rxjs/operators';
import { Subject } from 'rxjs/Subject';
import { queue } from 'rxjs/scheduler/queue';
import { Subscription } from 'rxjs/Subscription';

interface Action&lt;T&gt; {
  name: string;
  actionFn: (state: T) =&gt; T;
}

/** Base class for implementing stores. */
export abstract class Store&lt;T&gt; implements OnDestroy {

  private actionSubscription: Subscription;
  private actionSource: Subject&lt;Action&lt;T&gt;&gt;;
  private stateSource: BehaviorSubject&lt;T&gt;;
  state$: Observable&lt;T&gt;;

  /**
   * Initializes a store with initial state and logging.
   * @param initialState Initial state
   * @param logChanges When true state transitions are logged to the console.
   */
  constructor(initialState: T, public logChanges = false) {
    this.stateSource = new BehaviorSubject&lt;T&gt;(initialState);
    this.state$ = this.stateSource.asObservable();
    this.actionSource = new Subject&lt;Action&lt;T&gt;&gt;();

    this.actionSubscription = this.actionSource.pipe(observeOn(queue)).subscribe(action =&gt; {
      const currentState = this.stateSource.getValue();
      const nextState = action.actionFn(currentState);

      if (this.logChanges) {
        this.log(action.name, currentState, nextState);
      }

      this.stateSource.next(nextState);
    });
  }

  /**
   * Selects a property from the stores state.
   * Will do distinctUntilChanged() and map() with the given selector.
   * @param selector Selector function which selects the needed property from the state.
   * @returns Observable of return type from selector function.
   */
  select&lt;TX&gt;(selector: (state: T) =&gt; TX): Observable&lt;TX&gt; {
    return this.state$.pipe(
      map(selector),
      distinctUntilChanged()
    );
  }

  protected dispatchAction(name: string, action: (state: T) =&gt; T) {
    this.actionSource.next({ name, actionFn: action });
  }

  private log(actionName: string, before: T, after: T) {
    const result: { [key: string]: { from: any, to: any} } = {};
    const sameProbs = intersection(Object.keys(after), Object.keys(before));
    const newProbs = difference(Object.keys(after), Object.keys(before));
    for (const prop of newProbs) {
      result[prop] = { from: undefined, to: (&lt;any&gt;after)[prop] };
    }

    for (const prop of sameProbs) {
      if ((&lt;any&gt;before)[prop] !== (&lt;any&gt;after)[prop]) {
        result[prop] = { from: (&lt;any&gt;before)[prop], to: (&lt;any&gt;after)[prop] };
      }
    }

    console.log(this.constructor.name, actionName, result);
  }

  ngOnDestroy() {
    this.actionSubscription.unsubscribe();
  }

}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="guide-add-electron.asciidoc">5.2. Angular Electron</h3>
<div class="sect3">
<h4 id="guide-add-electron.asciidoc_add-electron-to-an-angular-application">5.2.1. Add Electron to an Angular application</h4>
<div class="paragraph">
<p>This cookbook recipe explains how to integrate Electron in an Angular 6+ application. <a href="https://electronjs.org/">Electron</a> is a framework for creating native applications with web technologies like JavaScript, HTML, and CSS. As an example, very well known applications as Visual Studio Code, Atom, Slack or Skype (and many more) are using Electron too.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the moment of this writing Angular 7.2.3 and Electron 4.0.2 were the versions available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here are the steps to achieve this goal. Follow them in order.</p>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_add-electron-and-other-relevant-dependencies">Add Electron and other relevant dependencies</h5>
<div class="paragraph">
<p>There are two different approaches to add the dependencies in the <code>package.json</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Writing the dependencies directly in that file.</p>
</li>
<li>
<p>Installing using <code>npm install</code> or <code>yarn add</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please remember if the project has a <code>package-lock.json</code> or <code>yarn.lock</code> file use <code>npm</code> or <code>yarn</code> respectively.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to add the dependencies directly in the <code>package.json</code> file, include the following lines in the <code>devDependencies</code> section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"devDependencies": {
...
    "electron": "^4.0.2",
    "electron-builder": "^20.38.5",
    "electron-reload": "^1.4.0",
    "npm-run-all": "^4.1.5",
    "npx": "^10.2.0",
    "wait-on": "^3.2.0",
    "webdriver-manager": "^12.1.1"
...
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>As indicated above, instead of this <code>npm install</code> can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install -D electron electron-builder electron-reload npm-run-all npx wait-on webdriver-manager</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or with <code>yarn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add -D electron electron-builder electron-reload npm-run-all npx wait-on webdriver-manager</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_add-electron-build-configuration">Add Electron build configuration</h5>
<div class="paragraph">
<p>In order to configure electron builds properly a <code>electron-builder.json</code> must be included in the root folder of the application. For more information and fine tuning please refer to the <a href="https://www.electron.build/configuration/configuration">Electron Builder official documentation</a>.</p>
</div>
<div class="paragraph">
<p>The contents of the file will be something similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "productName": "app-name",
  "directories": {
    "output": "release/"
  },
  "files": [
    "**/*",
    "!**/*.ts",
    "!*.code-workspace",
    "!LICENSE.md",
    "!package.json",
    "!package-lock.json",
    "!src/",
    "!e2e/",
    "!hooks/",
    "!angular.json",
    "!_config.yml",
    "!karma.conf.js",
    "!tsconfig.json",
    "!tslint.json"
  ],
  "win": {
    "icon": "dist/assets/icons",
    "target": ["portable"]
  },
  "mac": {
    "icon": "dist/assets/icons",
    "target": ["dmg"]
  },
  "linux": {
    "icon": "dist/assets/icons",
    "target": ["AppImage"]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Theres two important things in this file:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>"output": this is where electron builder is going to build our application</p>
</li>
<li>
<p>"icon": in every OS possible theres an icon parameter, the route to the icon folder that will be created after building with angular needs to be used here. This will make it so the electron builder can find the icons and build.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_create-the-necessary-typescript-configurations">Create the necessary typescript configurations</h5>
<div class="paragraph">
<p>In order to initiate electron in an angular app we need to modify the <code>tsconfig.json</code> file and create a new one named <code>tsconfig-serve.json</code> in the root folder.</p>
</div>
<div class="sect5">
<h6 id="guide-add-electron.asciidoc_tsconfig.json">tsconfig.json</h6>
<div class="paragraph">
<p>This file needs to be modified to add the <code>main.ts</code> and <code>src/**/*</code> folders excluding the <code>node_modules</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
....
  },
  "include": [
    "main.ts",
    "src/**/*"
  ],
  "exclude": [
    "node_modules"
  ]
....
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="guide-add-electron.asciidoc_tsconfig-serve.json">tsconfig-serve.json</h6>
<div class="paragraph">
<p>In the root, <code>tsconfig-serve.json</code> needs to be created. This typescript config file is going to be used when we serve electron:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "compilerOptions": {
    "sourceMap": true,
    "declaration": false,
    "moduleResolution": "node",
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "target": "es5",
    "typeRoots": [
      "node_modules/@types"
    ],
    "lib": [
      "es2017",
      "es2016",
      "es2015",
      "dom"
    ]
  },
  "include": [
    "main.ts"
  ],
  "exclude": [
    "node_modules",
    "**/*.spec.ts"
  ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_modify-angular.json">Modify angular.json</h5>
<div class="paragraph">
<p><code>angular.json</code> has to to be modified so the project is build inside <em>/dist</em> without an intermediate folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">{
....
  "architect": {
    ....
    "build": {
      outputPath": "dist",
      ....
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_add-angular-electron-directives">Add Angular Electron directives</h5>
<div class="paragraph">
<p>In order to use Electron&#8217;s webview tag and its methods inside an Angular application our project needs the directive <code>webview.directive.ts</code> file. We recommend to create this file inside a <strong>shared</strong> module folder, although it has to be declared inside the main module <code>app.module.ts</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 57. File webview.directive.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Directive } from '@angular/core';

@Directive({
  selector: '[webview]',
})
export class WebviewDirective {}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_add-access-electron-apis">Add access Electron APIs</h5>
<div class="paragraph">
<p>To call Electron APIs from the Renderer process, install ngx-electron module.</p>
</div>
<div class="paragraph">
<p>With <code>npm</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install ngx-electron --save</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or with <code>yarn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add ngx-electron --save</code></pre>
</div>
</div>
<div class="paragraph">
<p>This package contains a module named <strong>NgxElectronModule</strong> which exposes Electron APIs through a service called <strong>ElectronService</strong></p>
</div>
<div class="sect5">
<h6 id="guide-add-electron.asciidoc_update-app.module.ts-and-app-routing.module.ts">Update <code>app.module.ts</code> and <code>app-routing.module.ts</code></h6>
<div class="paragraph">
<p>As an example, the <code>webview.directive.ts</code> file is located inside a <code>shared</code> module:</p>
</div>
<div class="listingblock">
<div class="title">Listing 58. File app.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">// imports
import { NgxElectronModule } from 'ngx-electron';
import { WebviewDirective } from './shared/directives/webview.directive';

@NgModule({
  declarations: [AppComponent, WebviewDirective],
  imports: [
    ...
    NgxElectronModule
    ...
    ],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here NgxElectronModule is also added so ElectronService can be injected wherever is needed.</p>
</div>
<div class="paragraph">
<p>After that is done, the use of hash has to be allowed so electron can reload content properly. On the <code>app-routing.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">....
  imports: [RouterModule.forRoot(routes,
    {
      ....
      useHash: true,
    },
  )],</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="guide-add-electron.asciidoc_usage">Usage</h6>
<div class="paragraph">
<p>In order to use Electron in any component class the ElectronService must be injected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { ElectronService } from 'ngx-electron';

...

constructor(
  // other injected services
  public electronService: ElectronService,
) {
  // previous code...

  if (electronService.isElectronApp) {
    // Do electron stuff
  } else {
    // Do other web stuff
  }

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of all accesible APIs can be found at <a href="https://github.com/ThorstenHans/ngx-electron">Thorsten Hans' ngx-electron repository</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_create-the-electron-window-in-main.ts">Create the electron window in <code>main.ts</code></h5>
<div class="paragraph">
<p>In order to use electron, a file needs to be created at the root of the application (<code>main.ts</code>). This file will create a window with different settings checking if we are using <code>--serve</code> as an argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { app, BrowserWindow, screen } from 'electron';
import * as path from 'path';
import * as url from 'url';

let win: any;
let serve: any;
const args: any = process.argv.slice(1);
serve = args.some((val) =&gt; val === '--serve');

 function createWindow(): void {
  const electronScreen: any = screen;
  const size: any = electronScreen.getPrimaryDisplay().workAreaSize;

   // Create the browser window.
  win = new BrowserWindow({
    x: 0,
    y: 0,
    width: size.width,
    height: size.height,

    // Needed if you are using service workers
    webPreferences: {
      nodeIntegration: true,
      nodeIntegrationInWorker: true,
    }
  });

   if (serve) {
    // tslint:disable-next-line:no-require-imports
    require('electron-reload')(__dirname, {
      electron: require(`${__dirname}/node_modules/electron`),
    });
    win.loadURL('http://localhost:4200');
  } else {
    win.loadURL(
      url.format({
        pathname: path.join(__dirname, 'dist/index.html'),
        protocol: 'file',
        slashes: true,
      }),
    );
  }

   // Uncoment the following line if you want to open the DevTools by default
  // win.webContents.openDevTools();

   // Emitted when the window is closed.
  win.on('closed', () =&gt; {
    // Dereference the window object, usually you would store window
    // in an array if your app supports multi windows, this is the time
    // when you should delete the corresponding element.
    // tslint:disable-next-line:no-null-keyword
    win = null;
  });
}

 try {
  // This method will be called when Electron has finished
  // initialization and is ready to create browser windows.
  // Some APIs can only be used after this event occurs.
  app.on('ready', createWindow);

   // Quit when all windows are closed.
  app.on('window-all-closed', () =&gt; {
    // On OS X it is common for applications and their menu bar
    // to stay active until the user quits explicitly with Cmd + Q
    if (process.platform !== 'darwin') {
      app.quit();
    }
  });

   app.on('activate', () =&gt; {
    // On OS X it's common to re-create a window in the app when the
    // dock icon is clicked and there are no other windows open.
    if (win === null) {
      createWindow();
    }
  });
} catch (e) {
  // Catch Error
  // throw e;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guide-add-electron.asciidoc_add-the-electron-window-and-improve-the-package.json-scripts">Add the electron window and improve the <code>package.json</code> scripts</h5>
<div class="paragraph">
<p>Inside <code>package.json</code> the electron window that will be transformed to <code>main.js</code> when building needs to be added.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  ....
  "main": "main.js",
  "scripts": {
  ....
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>scripts</code> section in the <code>package.json</code> can be improved to avoid running too verbose commands. As a very complete example we can take a look to the My Thai Star&#8217;s <code>scripts</code> section and copy the lines useful in your project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "scripts": {
    "postinstall": "npx electron-builder install-app-deps",
    ".": "sh .angular-gui/.runner.sh",
    "ng": "ng",
    "start": "ng serve --proxy-config proxy.conf.json -o",
    "start:electron": "npm-run-all -p serve electron:serve",
    "compodoc": "compodoc -p src/tsconfig.app.json -s",
    "test": "ng test --browsers Chrome",
    "test:ci": "ng test --browsers ChromeHeadless --watch=false",
    "test:firefox": "ng test --browsers Firefox",
    "test:ci:firefox": "ng test --browsers FirefoxHeadless --watch=false",
    "test:firefox-dev": "ng test --browsers FirefoxDeveloper",
    "test:ci:firefox-dev": "ng test --browsers FirefoxDeveloperHeadless --watch=false",
    "test:electron": "ng test",
    "lint": "ng lint",
    "e2e": "ng e2e",
    "ngsw-config": "npx ngsw-config dist ngsw-config.json",
    "ngsw-copy": "cp node_modules/@angular/service-worker/ngsw-worker.js dist/",
    "serve": "ng serve",
    "serve:open": "npm run start",
    "serve:pwa": "npm run build:pwa &amp;&amp; http-server dist -p 8080",
    "serve:prod": "ng serve --open --prod",
    "serve:prodcompose": "ng serve --open --configuration=prodcompose",
    "serve:node": "ng serve --open --configuration=node",
    "build": "ng build",
    "build:pwa": "ng build --configuration=pwa --prod --build-optimizer &amp;&amp; npm run ngsw-config &amp;&amp; npm run ngsw-copy",
    "build:prod": "ng build --prod --build-optimizer",
    "build:prodcompose": "ng build --configuration=prodcompose ",
    "build:electron": "npm run electron:serve-tsc &amp;&amp; ng build --base-href ./",
    "build:electron:dev": "npm run build:electron -- -c dev",
    "build:electron:prod": "npm run build:electron -- -c production",
    "electron:start": "npm-run-all -p serve electron:serve",
    "electron:serve-tsc": "tsc -p tsconfig-serve.json",
    "electron:serve": "wait-on http-get://localhost:4200/ &amp;&amp; npm run electron:serve-tsc &amp;&amp; electron . --serve",
    "electron:local": "npm run build:electron:prod &amp;&amp; electron .",
    "electron:linux": "npm run build:electron:prod &amp;&amp; npx electron-builder build --linux",
    "electron:windows": "npm run build:electron:prod &amp;&amp; npx electron-builder build --windows",
    "electron:mac": "npm run build:electron:prod &amp;&amp; npx electron-builder build --mac"
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the important thing to look out for is that the base href when building electron can be changed as needed. In our case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">    "build:electron": "npm run postinstall:electron &amp;&amp; npm run electron:serve-tsc &amp;&amp; ng build --base-href \"\" ",</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some of these lines are intended to be shortcuts used in other scripts. Do not hesitate to modify them depending on your needs.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some usage examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm run electron:start                # Serve Angular app and run it inside electron
$ npm run electron:local                # Serve Angular app for production and run it inside electron
$ npm run electron:windows              # Build Angular app for production and package it for Windows OS</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn run electron:start                # Serve Angular app and run it inside electron
$ yarn run electron:local                # Serve Angular app for production and run it inside electron
$ yarn run electron:windows              # Build Angular app for production and package it for Windows OS</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. A package is a file or directory that is described by a package.json. .
</div>
</div>
<div id="footer">
<div id="footer-text">
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>